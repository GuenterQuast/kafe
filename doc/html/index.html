
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta content="kafe - a general, Python-based approach to fit a model function to two-dimensional data points with correlated uncertainties in both dimensions" lang="en" name="description" />
<meta content="index, follow" name="robots" />

    <title>Welcome to KaFE (Karlsruhe Fit Environment) &mdash; kafe 0.5.3 documentation</title>
    
    <link rel="stylesheet" href="_static/nature.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '',
        VERSION:     '0.5.3',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="top" title="kafe 0.5.3 documentation" href="#" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li><a href="#">kafe 0.5.3 documentation</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="welcome-to-kafe-karlsruhe-fit-environment">
<h1>Welcome to KaFE (Karlsruhe Fit Environment)<a class="headerlink" href="#welcome-to-kafe-karlsruhe-fit-environment" title="Permalink to this headline">¶</a></h1>
<blockquote>
<div><strong>kafe</strong> is a data fitting framework designed for use in undergraduate
physics lab courses. It provides a basic <cite>Python</cite> toolkit for fitting
models to data as well as visualisation of the data and the model function.
It relies on <cite>Python</cite> packages such as <tt class="xref py py-mod docutils literal"><span class="pre">numpy</span></tt> and <tt class="xref py py-mod docutils literal"><span class="pre">matplotlib</span></tt>,
and uses the <cite>Python</cite> interface to the minimizer <cite>Minuit</cite> contained in the data
analysis framework <cite>ROOT</cite>.</div></blockquote>
<div class="section" id="kafe-overview">
<h2><tt class="xref py py-mod docutils literal"><span class="pre">kafe</span></tt> Overview<a class="headerlink" href="#kafe-overview" title="Permalink to this headline">¶</a></h2>
<div class="figure align-right">
<a class="reference internal image-reference" href="_images/kafe_graphics.png"><img alt="image not found" src="_images/kafe_graphics.png" style="width: 450.0px; height: 300.0px;" /></a>
<p class="caption"><cite>Graphical output generated with kafe</cite>.</p>
</div>
<p>The <tt class="xref py py-mod docutils literal"><span class="pre">kafe</span></tt> package provides a rather general approach to fitting of
a model function to two-dimensional data points with correlated uncertainties
in both dimensions. The <cite>Python</cite> API guarantees full flexibility
for data input. Helper functions for file-based input and some
examples are available for own applications.</p>
<p>Applications range from performing a simple average of measurements
to complex situations with both correlated (systematic) and
uncorrelated (statistical) uncertainties on the measurements
of the x and y values described by a non-linear model function
depending on a large number of parameters.</p>
<p>The model function describes the y values as a function of the
x-values and a set of model parameters {p}, <cite>y=f(x; {p})</cite>. Full
flexibility exists as model functions are implemented as
<cite>Python</cite> code. Again, examples are provided, but user
implementations are supported as well.</p>
<p>Fitting is based on the χ²-method, assuming Gaussian errors and
correlations described by covariance matrices. The level of agreement
between data points and the fit model is expressed in terms of the
<cite>χ² probability</cite>, i. e. the probability to find less agreement between
data and model than actually observed. Full access to the covariance
matrix of the - typically correlated - model parameters is provided.</p>
<p>The graphical output visualises the data and the fit model at the
best-fit-point of the parameters and also shows the uncertainty
of the fit model as a light band surrounding the line representing
the model function. Plotting of confidence level contours for pairs
of parameters or profiling of the χ² curves for each of the fit
parameters are also provided.</p>
<div class="section" id="code-structure">
<h3>Code Structure<a class="headerlink" href="#code-structure" title="Permalink to this headline">¶</a></h3>
<div class="figure align-right">
<a class="reference internal image-reference" href="_images/kafeDiagram.jpg"><img alt="image not found" src="_images/kafeDiagram.jpg" style="width: 480.0px; height: 240.0px;" /></a>
<p class="caption"><cite>Code structure of the kafe package</cite></p>
</div>
<p>The code of <tt class="xref py py-mod docutils literal"><span class="pre">kafe</span></tt> is centred around very few classes to handle Data input,
fitting and plotting, as illustrated in the figure on the right-hand side.</p>
<p>Data, their uncertainties, and, optionally, the correlations of the
uncertainties - are passed through the interface of the <tt class="xref py py-mod docutils literal"><span class="pre">kafe</span></tt> class
<a class="reference internal" href="#kafe.dataset.Dataset" title="kafe.dataset.Dataset"><tt class="xref py py-class docutils literal"><span class="pre">Dataset</span></tt></a>. Input can be included in the <cite>Python</cite> code
or is read from files in standardised or user-defined formats. The representation
of the data within the <a class="reference internal" href="#kafe.dataset.Dataset" title="kafe.dataset.Dataset"><tt class="xref py py-class docutils literal"><span class="pre">Dataset</span></tt></a> class is minimalistic,
consisting of the x and y values and the full covariance matrices of their
uncertainties. Correlated errors between x and y values are not
supported yet, as such use cases are rare.</p>
<p>A helper function, <a class="reference internal" href="#kafe.dataset.build_dataset" title="kafe.dataset.build_dataset"><tt class="xref py py-func docutils literal"><span class="pre">build_dataset()</span></tt></a>, is available
to transform various error models, like a combination of independent
and correlated errors or common absolute or relative errors, to this
basic format.</p>
<p>Adding a model function, taken either from a prepared set of fit
functions within kafe or from a user&#8217;s own <cite>Python</cite> implementation,
results in a <a class="reference internal" href="#kafe.fit.Fit" title="kafe.fit.Fit"><tt class="xref py py-class docutils literal"><span class="pre">Fit</span></tt></a> object, which controls the
minimizer <a class="reference internal" href="#kafe.minuit.Minuit" title="kafe.minuit.Minuit"><tt class="xref py py-class docutils literal"><span class="pre">Minuit</span></tt></a>. Access to the final
results of the fitting procedure is provided by data members of
the <cite>Fit</cite> class.</p>
<p>One or multiple fit objects, i. e. the input data and model
functions(s) at the best-fit point in parameter-space, are
visualised by the class <a class="reference internal" href="#kafe.plot.Plot" title="kafe.plot.Plot"><tt class="xref py py-class docutils literal"><span class="pre">Plot</span></tt></a> with the help
of <tt class="xref py py-mod docutils literal"><span class="pre">matplotlib</span></tt> functionality. The <a class="reference internal" href="#module-plot" title="plot: A submodule for plotting `Dataset`s with ``matplotlib``. (Unix)"><tt class="xref py py-mod docutils literal"><span class="pre">plot</span></tt></a> module
also contains functionality to display the model uncertainty by
surrounding the model function at the best-fit values of the parameters
by a light band, the one-σ uncertainty band, which is obtained by
propagation of the uncertainties of the fit parameters taking
into account their correlations.</p>
<p>Two-dimensional contour lines of pairs of parameters
are obtained with the method <tt class="xref py py-meth docutils literal"><span class="pre">plot_contour()</span></tt>
of the <tt class="xref py py-class docutils literal"><span class="pre">Fit</span></tt> class, which internally relies on the
<cite>mncont</cite> method of the <cite>Minuit</cite> package. Contour curves are
obtained from a scan of the χ²-function around a fixed value,
where each point on the curve represents the minimum with
respect to all other free parameters in the fit, thus taking
into account the correlation of a pair of parameters with all
other parameters of the model.</p>
<p>In a similar way, the method <tt class="xref py py-meth docutils literal"><span class="pre">plot_profile()</span></tt>
provides profiled χ² curves, i. e. the value of the minimal
χ² as a function of one parameter while all other parameters
are allowed to vary.</p>
</div>
<div class="section" id="example">
<h3>Example<a class="headerlink" href="#example" title="Permalink to this headline">¶</a></h3>
<p>Only very few lines of Python code are needed to perform fits with
kafe. The snippet of code shown below performs a fit of a quadratic
function to some data points with uncertainties:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">kafe</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">kafe.function_library</span> <span class="kn">import</span> <span class="n">quadratic_3par</span>

<span class="c">#### build a Dataset instance:</span>
<span class="n">myDataset</span> <span class="o">=</span> <span class="n">build_dataset</span><span class="p">(</span>
    <span class="p">[</span><span class="mf">0.05</span><span class="p">,</span><span class="mf">0.36</span><span class="p">,</span><span class="mf">0.68</span><span class="p">,</span><span class="mf">0.80</span><span class="p">,</span><span class="mf">1.09</span><span class="p">,</span><span class="mf">1.46</span><span class="p">,</span><span class="mf">1.71</span><span class="p">,</span><span class="mf">1.83</span><span class="p">,</span><span class="mf">2.44</span><span class="p">,</span><span class="mf">2.09</span><span class="p">,</span><span class="mf">3.72</span><span class="p">,</span><span class="mf">4.36</span><span class="p">,</span><span class="mf">4.60</span><span class="p">],</span>
    <span class="p">[</span><span class="mf">0.35</span><span class="p">,</span><span class="mf">0.26</span><span class="p">,</span><span class="mf">0.52</span><span class="p">,</span><span class="mf">0.44</span><span class="p">,</span><span class="mf">0.48</span><span class="p">,</span><span class="mf">0.55</span><span class="p">,</span><span class="mf">0.66</span><span class="p">,</span><span class="mf">0.48</span><span class="p">,</span><span class="mf">0.75</span><span class="p">,</span><span class="mf">0.70</span><span class="p">,</span><span class="mf">0.75</span><span class="p">,</span><span class="mf">0.80</span><span class="p">,</span><span class="mf">0.90</span><span class="p">],</span>
    <span class="n">yabserr</span><span class="o">=</span><span class="p">[</span><span class="mf">0.06</span><span class="p">,</span><span class="mf">0.07</span><span class="p">,</span><span class="mf">0.05</span><span class="p">,</span><span class="mf">0.05</span><span class="p">,</span><span class="mf">0.07</span><span class="p">,</span><span class="mf">0.07</span><span class="p">,</span><span class="mf">0.09</span><span class="p">,</span><span class="mf">0.1</span><span class="p">,</span><span class="mf">0.11</span><span class="p">,</span><span class="mf">0.1</span><span class="p">,</span><span class="mf">0.11</span><span class="p">,</span><span class="mf">0.12</span><span class="p">,</span><span class="mf">0.1</span><span class="p">],</span>
    <span class="n">title</span><span class="o">=</span><span class="s">&#39;some data&#39;</span><span class="p">,</span>
    <span class="n">axis_labels</span><span class="o">=</span><span class="p">[</span><span class="s">&#39;$x$&#39;</span><span class="p">,</span> <span class="s">&#39;$y=f(x)$&#39;</span><span class="p">])</span>

<span class="c">#### Create the Fit object</span>
<span class="n">myFit</span> <span class="o">=</span> <span class="n">Fit</span><span class="p">(</span><span class="n">myDataset</span><span class="p">,</span> <span class="n">quadratic_3par</span><span class="p">)</span>
<span class="c"># Set initial values and error estimates</span>
<span class="n">myFit</span><span class="o">.</span><span class="n">set_parameters</span><span class="p">((</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">),</span> <span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">))</span>
<span class="c"># Do the Fit</span>
<span class="n">myFit</span><span class="o">.</span><span class="n">do_fit</span><span class="p">()</span>

<span class="c">#### Create result plots and output them</span>
<span class="n">myPlot</span> <span class="o">=</span> <span class="n">Plot</span><span class="p">(</span><span class="n">myFit</span><span class="p">)</span>
<span class="n">myPlot</span><span class="o">.</span><span class="n">plot_all</span><span class="p">()</span>
<span class="n">myPlot</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s">&#39;kafe_example0.pdf&#39;</span><span class="p">)</span> <span class="c"># to file</span>

<span class="n">myPlot</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>                    <span class="c"># to screen</span>
</pre></div>
</div>
<p>The output in text form (also available via various <tt class="xref py py-meth docutils literal"><span class="pre">get_...()</span></tt> methods
of the <a class="reference internal" href="#kafe.fit.Fit" title="kafe.fit.Fit"><tt class="xref py py-class docutils literal"><span class="pre">Fit</span></tt></a> class) contains the values of the parameters
at the best-fit point, their correlation matrix and the fit probability.
The example produces the following graphical output:</p>
<div class="figure align-center">
<a class="reference internal image-reference" href="_images/kafe_example0.png"><img alt="image not found" src="_images/kafe_example0.png" style="width: 600.0px; height: 300.0px;" /></a>
<p class="caption">Example: <cite>Data points with one-dimensional error bars compared
to a quadratic model function with</cite> <strong>kafe</strong>.</p>
</div>
<p>The parametrisation chosen in this example leads to a
strong correlation of the fit parameters. This can
be graphically visualised by adding the following
lines at the end of the example:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="c">### Create and save contour plots</span>
<span class="n">contour1</span> <span class="o">=</span> <span class="n">myFit</span><span class="o">.</span><span class="n">plot_contour</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">dchi2</span><span class="o">=</span><span class="p">[</span><span class="mf">1.</span><span class="p">,</span><span class="mf">2.3</span><span class="p">])</span>
<span class="n">contour2</span> <span class="o">=</span> <span class="n">myFit</span><span class="o">.</span><span class="n">plot_contour</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">dchi2</span><span class="o">=</span><span class="p">[</span><span class="mf">1.</span><span class="p">,</span><span class="mf">2.3</span><span class="p">])</span>
<span class="n">contour3</span> <span class="o">=</span> <span class="n">myFit</span><span class="o">.</span><span class="n">plot_contour</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">dchi2</span><span class="o">=</span><span class="p">[</span><span class="mf">1.</span><span class="p">,</span><span class="mf">2.3</span><span class="p">])</span>
<span class="n">contour1</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s">&#39;kafe_example0_contour1.pdf&#39;</span><span class="p">)</span>
<span class="n">contour2</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s">&#39;kafe_example0_contour2.pdf&#39;</span><span class="p">)</span>
<span class="n">contour3</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s">&#39;kafe_example0_contour3.pdf&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>The example code produces two confidence-level contours
for each pair of parameters (with <cite>id=0</cite>, <cite>id=1</cite> and <cite>id=2</cite>),
corresponding to an increase of the χ²-function
with respect to the minimum by the values given
in the list passed as the third parameter to the
method <tt class="xref py py-meth docutils literal"><span class="pre">myFit.plot_contour()</span></tt>. The resulting
graphical representation, as shown below, displays the
39% contours, corresponding to the one-sigma errors, and
the 68% contours. The uncertainties on each parameter,
indicated by the error bars, are also shown. They
correspond to the projections of the one-sigma contours
on the axes.</p>
<div class="figure align-center">
<img alt="image not found" src="_images/kafe_example0_contours.png" style="width: 900px; height: 300px;" />
<p class="caption"><cite>Contour curves of a pairs of paramters a, b and c
of the example above, calculated with</cite> <strong>kafe</strong>.</p>
</div>
<p>More and advanced examples - like fitting different models
to one data set, comparison of different data sets with model
functions, averaging of correlated measurements or fits with
a large number of parameters -
are provided as part of the <cite>kafe</cite> distribution and are
described in the section <cite>Examples</cite> below. They may serve as
a starting point for own applications.</p>
</div>
<div class="section" id="installation">
<h3>Installation<a class="headerlink" href="#installation" title="Permalink to this headline">¶</a></h3>
<p>To install <cite>kafe</cite>, unpack the archive <cite>kafe-&lt;version&gt;.tgz</cite> , change to
the sub-directory  <cite>kafe-&lt;version&gt;/src/</cite>  and follow the installation
instructions below.</p>
<p>1.) Install using <cite>pip</cite>:</p>
<blockquote>
<div><p>To install kafe using the <cite>Pip</cite> installer
(<a class="reference external" href="http://www.pip-installer.org/">http://www.pip-installer.org/</a>), simply
run the helper script as root:</p>
<blockquote>
<div><tt class="docutils literal"><span class="pre">./install.sh</span></tt></div></blockquote>
<p>If you don&#8217;t have Pip installed, use:</p>
<blockquote>
<div><tt class="docutils literal"><span class="pre">easy_install</span> <span class="pre">pip</span></tt></div></blockquote>
<p>To remove kafe using pip, just run the helper script:</p>
<blockquote>
<div><tt class="docutils literal"><span class="pre">./uninstall.sh</span></tt></div></blockquote>
</div></blockquote>
<ol class="arabic" start="2">
<li><p class="first">Install using <cite>setuptools</cite>:</p>
<p>Installing using Python&#8217;s <cite>setup</cite> tools works, but does not
provide a clean uninstall. Use this method if installing
with <cite>Pip</cite> is not possible:</p>
<blockquote>
<div><p><tt class="docutils literal"><span class="pre">python</span> <span class="pre">setup.py</span> <span class="pre">install</span></tt></p>
</div></blockquote>
</li>
</ol>
<p><tt class="xref py py-mod docutils literal"><span class="pre">kafe</span></tt> needs a working version of the CERN data analysis framework <tt class="docutils literal"><span class="pre">root</span></tt>,
freely available at  <a class="reference external" href="http://root.cern.ch">http://root.cern.ch</a></p>
<div class="section" id="dependencies">
<h4>Dependencies<a class="headerlink" href="#dependencies" title="Permalink to this headline">¶</a></h4>
<p>The recommended versions of external packages for <tt class="xref py py-mod docutils literal"><span class="pre">kafe</span></tt> are as follows,
the version numbers in parentheses refer to the minimum requirements:</p>
<div class="highlight-python"><pre>Python packages:
  * SciPy &gt;= 0.12.0 (0.9.0), which includes
      - NumPy &gt;= 1.7.1 (1.6.1) and
      - matplotlib &gt;= 1.2.0 (1.1.1)

Other dependencies:
  * ROOT &gt;= 5.34 (http://root.cern.ch)
  * Qt4 &gt;= 4.8.5 `(could work with other versions)`
  * PyQt &gt;= 3.18.1 `(could work with other versions)`
  * A LaTeX distribution `(tested with texlive)`</pre>
</div>
<p>Be sure that the version of <cite>ROOT</cite> you use is compiled with <cite>PyROOT</cite> support.
For <cite>Python</cite> to see the <cite>PyROOT</cite> bindings, the following environment variables
must be set correctly:</p>
<div class="highlight-python"><pre>export ROOTSYS=&lt;directory where ROOT is installed&gt;
export LD_LIBRARY_PATH=${LD_LIBRARY_PATH}:$ROOTSYS/lib
export PYTHONPATH=$ROOTSYS/lib:$PYTHONPATH</pre>
</div>
<p>For more info, refer to [<a class="reference external" href="http://root.cern.ch/drupal/content/pyroot">http://root.cern.ch/drupal/content/pyroot</a>].</p>
<p><cite>Qt</cite> is needed because it is the supported interactive front-end for
<tt class="xref py py-mod docutils literal"><span class="pre">matplotlib</span></tt>. Other front-ends are not supported and can cause weird behaviour.</p>
<p><cite>LaTeX</cite> is used by <tt class="xref py py-mod docutils literal"><span class="pre">matplotlib</span></tt> for displaying labels and mathematical
expressions on graphs.</p>
</div>
</div>
</div>
<div class="section" id="fit-examples-utilities-tips-and-tricks">
<h2>Fit examples, utilities, tips and tricks<a class="headerlink" href="#fit-examples-utilities-tips-and-tricks" title="Permalink to this headline">¶</a></h2>
<p>A wide range of applications of the <tt class="xref py py-mod docutils literal"><span class="pre">kafe</span></tt> core and the usage of
the helper functions is exemplified here. All of them
are contained in the sub-directory <tt class="docutils literal"><span class="pre">examples/</span></tt> of the
<tt class="xref py py-mod docutils literal"><span class="pre">kafe</span></tt> distribution and are intended to serve as a basis for
user projects.</p>
<div class="section" id="example-1-model-comparison">
<h3>Example 1 - model comparison<a class="headerlink" href="#example-1-model-comparison" title="Permalink to this headline">¶</a></h3>
<p>To decide whether a model is adequate to describe a given
set of data, typically several models have to be fit to the
same data. Here is the code for a comparison of a data set
to two models, namely a linear and an exponential function:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="c"># import everything we need from kafe</span>
<span class="kn">from</span> <span class="nn">kafe</span> <span class="kn">import</span> <span class="o">*</span>
<span class="c"># additionally, import the two model functions we want to fit:</span>
<span class="kn">from</span> <span class="nn">kafe.function_library</span> <span class="kn">import</span> <span class="n">linear_2par</span><span class="p">,</span> <span class="n">exp_2par</span>

<span class="c">############</span>
<span class="c"># Load the Dataset from the file</span>
<span class="n">my_dataset</span> <span class="o">=</span> <span class="n">Dataset</span><span class="p">(</span><span class="n">input_file</span><span class="o">=</span><span class="s">&#39;dataset.dat&#39;</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s">&quot;Example Dataset&quot;</span><span class="p">)</span>
<span class="c">### Create the Fits</span>
<span class="n">my_fits</span> <span class="o">=</span> <span class="p">[</span><span class="n">Fit</span><span class="p">(</span><span class="n">my_dataset</span><span class="p">,</span> <span class="n">exp_2par</span><span class="p">),</span>
           <span class="n">Fit</span><span class="p">(</span><span class="n">my_dataset</span><span class="p">,</span> <span class="n">linear_2par</span><span class="p">)]</span>
<span class="c">### Do the Fits</span>
<span class="k">for</span> <span class="n">fit</span> <span class="ow">in</span> <span class="n">my_fits</span><span class="p">:</span>
<span class="n">fit</span><span class="o">.</span><span class="n">do_fit</span><span class="p">()</span>
<span class="c">### Create the plots, save and show output</span>
<span class="n">my_plot</span> <span class="o">=</span> <span class="n">Plot</span><span class="p">(</span><span class="n">my_fits</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">my_fits</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="n">my_plot</span><span class="o">.</span><span class="n">plot_all</span><span class="p">(</span><span class="n">show_data_for</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span> <span class="c"># show data only once (it&#39;s the same data)</span>
<span class="n">my_plot</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s">&#39;plot.pdf&#39;</span><span class="p">)</span>
<span class="n">my_plot</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<p>The file <cite>dataset.dat</cite> contains x and y data in the standard <tt class="xref py py-mod docutils literal"><span class="pre">kafe</span></tt> data
format, where values and errors (and optionally also correlation coefficients)
are given for each axis separately. <cite>#</cite> indicates a comment line, which
is ignored when reading the data:</p>
<div class="highlight-python"><pre># axis 0: x
# datapoints  uncor. err.
0.957426  3.0e-01
2.262212  3.0e-01
3.061167  3.0e-01
3.607280  3.0e-01
4.933100  3.0e-01
5.992332  3.0e-01
7.021234  3.0e-01
8.272489  3.0e-01
9.250817  3.0e-01
9.757758  3.0e-01

# axis 1: y
# datapoints  uncor. err.
1.672481  2.0e-01
1.743410  2.0e-01
1.805217  2.0e-01
2.147802  2.0e-01
2.679615  2.0e-01
3.110055  2.0e-01
3.723173  2.0e-01
4.430122  2.0e-01
4.944116  2.0e-01
5.698063  2.0e-01</pre>
</div>
<p>The resulting output is shown below. As can be seen already
from the graph, the exponential model better describes the
data. The χ² probability in the printed output shows, however,
that the linear model would be marginally acceptable as well:</p>
<div class="highlight-python"><pre>linear_2par
chi2prob 0.052
HYPTEST  accepted (CL 5%)

exp_2par
chi2prob 0.96
HYPTEST  accepted (CL 5%)</pre>
</div>
<div class="figure align-center">
<a class="reference internal image-reference" href="_images/kafe_example1.png"><img alt="image not found" src="_images/kafe_example1.png" style="width: 600.0px; height: 300.0px;" /></a>
<p class="caption"><cite>Output of example1 - compare two models</cite></p>
</div>
<p>The contour curves of the two fits are shown below
and reflect the large correlations between the fit parameters.
The right plot of the profile χ² curve shows that there
is a slight deviation from the parabolic curve in the
fist fit of a non-linear (exponential) function. For more
details on the profiled χ² curve see the discussion of
example 3, where the difference is more prominent.</p>
<div class="figure align-center">
<img alt="image not found" src="_images/kafe_example1_contours.png" style="width: 900px; height: 300px;" />
<p class="caption"><cite>Contour curves and a profile χ² curve for the fits in example 1</cite></p>
</div>
</div>
<div class="section" id="example-2-two-fits-and-models">
<h3>Example 2 - two fits and models<a class="headerlink" href="#example-2-two-fits-and-models" title="Permalink to this headline">¶</a></h3>
<p>Another typical use case consists of comparing two sets
of measurements and the models derived from them. This is
very similar to the previous example with minor
modifications:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="o">...</span>

<span class="c">############</span>
<span class="c"># Workflow #</span>
<span class="c">############</span>
<span class="c"># Load two Datasets from files</span>
<span class="n">my_datasets</span> <span class="o">=</span> <span class="p">[</span><span class="n">Dataset</span><span class="p">(</span><span class="n">input_file</span><span class="o">=</span><span class="s">&#39;dataset1.dat&#39;</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s">&quot;Example Dataset 1&quot;</span><span class="p">),</span>
               <span class="n">Dataset</span><span class="p">(</span><span class="n">input_file</span><span class="o">=</span><span class="s">&#39;dataset2.dat&#39;</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s">&quot;Example Dataset 2&quot;</span><span class="p">)]</span>
<span class="c"># Create the Fits</span>
<span class="o">...</span>
<span class="c"># Do the Fits</span>
<span class="o">...</span>
<span class="c"># Create the plots</span>
<span class="n">my_plot</span><span class="o">.</span><span class="n">plot_all</span><span class="p">()</span>  <span class="c"># this time without any arguments, i.e. show everything</span>
<span class="o">...</span>
</pre></div>
</div>
<p>This results in the following output:</p>
<div class="figure align-center">
<a class="reference internal image-reference" href="_images/kafe_example2.png"><img alt="image not found" src="_images/kafe_example2.png" style="width: 600.0px; height: 300.0px;" /></a>
<p class="caption"><cite>Output of example2 - comparison of two linear fits.</cite></p>
</div>
<p>Although the parameters extracted from the two data sets agree within
errors, the uncertainty bands of the two functions do not overlap
in the region where the data of Dataset 2 are located, so the data
are most probably incompatible with the assumption of an underlying
single linear model.</p>
</div>
<div class="section" id="example-3-non-linear-fit-with-non-parabolic-errors">
<h3>Example 3 - non-linear fit with non-parabolic errors<a class="headerlink" href="#example-3-non-linear-fit-with-non-parabolic-errors" title="Permalink to this headline">¶</a></h3>
<p>Very often, when the fit model is a non-linear function
of the parameters, the χ² function is not parabolic around
the minimum. A very common example of such a case is an
exponential function prarametrised as shown in the code
fragment below. <cite>Minuit</cite> contains a spacial algorithm, <cite>Minos</cite>,
which returns correct errors also in this case. Instead of
using the curvature the minimum, <cite>Minos</cite> follows the
χ² function from the minimum to the point where it
crosses the the value <cite>minimum+up</cite>, where <cite>up=1</cite> corresponds
to one standard deviation in χ² fits. During the scan of the
χ² function at different values of each parameter the minimum
with respect to all other parameters in the fit is determined,
thus making sure that all correlations among the parameters
are taken into account. In case of a parabolic χ² function,
the <cite>Minos</cite> errors are identical to those obtained by
the <cite>Hesse</cite> algorithm, but are typically larger or
asymmetric in other cases.</p>
<p>The method <tt class="xref py py-meth docutils literal"><span class="pre">kafe.do_fit()</span></tt> executes the <cite>Minos</cite> algorithm
after completion of a fit and prints the <cite>Minos</cite> errors if
the deviation from the parabolic result are larger than 5% .</p>
<p>A graphical visualisation is provided
by the method <tt class="xref py py-meth docutils literal"><span class="pre">plot_profile()</span></tt> , which
displays the profile χ² curve for the parameter
with name or index passed as an argument to the method.</p>
<p>The relevant code fragments and the usage of
the method <tt class="xref py py-meth docutils literal"><span class="pre">kafe.fit.plot_profile()</span></tt> are
illustrated here:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="o">...</span>
<span class="c"># definition of the fit function</span>
<span class="nd">@ASCII</span><span class="p">(</span><span class="n">x_name</span><span class="o">=</span><span class="s">&quot;t&quot;</span><span class="p">,</span> <span class="n">expression</span><span class="o">=</span><span class="s">&quot;A0*exp(-t/tau)&quot;</span><span class="p">)</span>
<span class="c"># Set some LaTeX-related parameters for this function</span>
<span class="nd">@LaTeX</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s">&#39;A&#39;</span><span class="p">,</span> <span class="n">x_name</span><span class="o">=</span><span class="s">&quot;t&quot;</span><span class="p">,</span>
   <span class="n">parameter_names</span><span class="o">=</span><span class="p">(</span><span class="s">&#39;A_0&#39;</span><span class="p">,</span> <span class="s">&#39;</span><span class="se">\\</span><span class="s">tau{}&#39;</span><span class="p">),</span>
   <span class="n">expression</span><span class="o">=</span><span class="s">&quot;A_0</span><span class="se">\\</span><span class="s">,</span><span class="se">\\</span><span class="s">exp(</span><span class="se">\\</span><span class="s">frac{-t}{</span><span class="se">\\</span><span class="s">tau})&quot;</span><span class="p">)</span>
<span class="nd">@FitFunction</span>
<span class="k">def</span> <span class="nf">exponential</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">A0</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">tau</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
   <span class="k">return</span> <span class="n">A0</span> <span class="o">*</span> <span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">t</span><span class="o">/</span><span class="n">tau</span><span class="p">)</span>
<span class="o">...</span>
<span class="c"># Load the data, perform fit and plot</span>
<span class="n">my_dataset</span> <span class="o">=</span> <span class="n">Dataset</span><span class="p">(</span><span class="n">input_file</span><span class="o">=</span><span class="s">&#39;dataset.dat&#39;</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s">&quot;Example Dataset&quot;</span><span class="p">)</span>
<span class="n">my_fit</span> <span class="o">=</span> <span class="n">Fit</span><span class="p">(</span><span class="n">my_dataset</span><span class="p">,</span> <span class="n">exponential</span><span class="p">)</span>
<span class="n">my_fit</span><span class="o">.</span><span class="n">do_fit</span><span class="p">()</span>
<span class="n">my_plot</span> <span class="o">=</span> <span class="n">Plot</span><span class="p">(</span><span class="n">my_fit</span><span class="p">)</span>
<span class="n">my_plot</span><span class="o">.</span><span class="n">plot_all</span><span class="p">()</span>
<span class="c"># --&gt; display contours and profile</span>
<span class="n">contour</span> <span class="o">=</span> <span class="n">my_fit</span><span class="o">.</span><span class="n">plot_contour</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">dchi2</span><span class="o">=</span><span class="p">[</span><span class="mf">1.</span><span class="p">,</span><span class="mf">2.3</span><span class="p">])</span>
<span class="n">profile1</span><span class="o">=</span><span class="n">my_fit</span><span class="o">.</span><span class="n">plot_profile</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="n">profile2</span><span class="o">=</span><span class="n">my_fit</span><span class="o">.</span><span class="n">plot_profile</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="c"># Show the plots</span>
<span class="n">my_plot</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<p>The data points were generated using a normalisation factor
of <cite>A0=1.</cite> and a lifetime <cite>τ=1.</cite>. The resulting fit output
below demonstrates that this is well reproduced within
uncertainties:</p>
<div class="figure align-center">
<a class="reference internal image-reference" href="_images/kafe_example3.png"><img alt="image not found" src="_images/kafe_example3.png" style="width: 600.0px; height: 300.0px;" /></a>
<p class="caption"><cite>Output of example 3 - Fit of an exponential</cite></p>
</div>
<p>The contour <cite>A</cite><sub>0</sub> <cite>vs τ</cite>, however, is not an ellipse,
as shown in the figure below. The profiled χ² curves are
also shown; they deviate significantly from parabolas.
The proper one-sigma uncertainty in the sense of a 68%
confidence interval is read from these curves by determining
the parameter values where the χ² curves cross the horizontal
lines at a value of Δχ²=1 above the minimum. The two-sigma
uncertainties correspond to the intersections with the
horizontal line at Δχ²=4.</p>
<div class="figure align-center">
<a class="reference internal image-reference" href="_images/kafe_example3_contours.png"><img alt="image not found" src="_images/kafe_example3_contours.png" style="width: 900.0px; height: 300.0px;" /></a>
<p class="caption"><cite>Contour and profile χ² curves of example 3</cite></p>
</div>
<p>Note: a more parabolic behaviour is achieved
by using the width parameter λ=1/τ in the
parametrisation of the exponential function.</p>
</div>
<div class="section" id="example-4-average-of-correlated-measurements">
<h3>Example 4 - average of correlated measurements<a class="headerlink" href="#example-4-average-of-correlated-measurements" title="Permalink to this headline">¶</a></h3>
<p>The average of a set of measurements can be considered as a fit
of a constant to a set of input data. This example illustrates
how correlated errors are handled in <tt class="xref py py-mod docutils literal"><span class="pre">kafe</span></tt>.
Measurements can have a common error, which may be absolute
or relative, i. e. depend on the input value.  In more complicated
cases the full covariance matrix must be constructed.</p>
<p><tt class="xref py py-mod docutils literal"><span class="pre">kafe</span></tt> has a helper function, <a class="reference internal" href="#kafe.dataset.build_dataset" title="kafe.dataset.build_dataset"><tt class="xref py py-func docutils literal"><span class="pre">build_dataset()</span></tt></a> in module <a class="reference internal" href="#module-fit" title="fit: This submodule defines a `Fit` object which performs the actual fitting given a `Dataset` and a fit function. (Unix)"><tt class="xref py py-mod docutils literal"><span class="pre">fit</span></tt></a>,
which aids in setting up the covariance matrix and transforming
the input to the default format used by the <a class="reference internal" href="#kafe.dataset.Dataset" title="kafe.dataset.Dataset"><tt class="xref py py-class docutils literal"><span class="pre">Dataset</span></tt></a> and <a class="reference internal" href="#kafe.fit.Fit" title="kafe.fit.Fit"><tt class="xref py py-class docutils literal"><span class="pre">Fit</span></tt></a>
classes. Two further helper functions in module <a class="reference internal" href="#module-file_tools" title="file_tools: This submodule provides a set of helper functions for parsing files (Unix)"><tt class="xref py py-mod docutils literal"><span class="pre">file_tools</span></tt></a>
aid in reading the appropriate information from data files.</p>
<blockquote>
<div><ol class="arabic simple">
<li>The function  <a class="reference internal" href="#kafe.file_tools.parse_column_data" title="kafe.file_tools.parse_column_data"><tt class="xref py py-func docutils literal"><span class="pre">parse_column_data()</span></tt></a> reads the input values and their
independent errors from one file, and optionally covariance
matrices for the x and y axes from additional files. The field ordering
is defined by a control string.</li>
<li>Another helper function, <a class="reference internal" href="#kafe.file_tools.buildDataset_fromFile" title="kafe.file_tools.buildDataset_fromFile"><tt class="xref py py-func docutils literal"><span class="pre">buildDataset_fromFile()</span></tt></a>, specifies
input values or blocks of input data from a single file with
keywords.</li>
</ol>
</div></blockquote>
<p>The second version needs only very minimal additional user
code, as illustrated here:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">kafe</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">kafe.function_library</span> <span class="kn">import</span> <span class="n">constant_1par</span>
<span class="kn">from</span> <span class="nn">kafe.file_tools</span> <span class="kn">import</span> <span class="n">buildDataset_fromFile</span>
<span class="c">#</span>
<span class="c"># ---------------------------------------------------------</span>
<span class="n">fname</span> <span class="o">=</span> <span class="s">&#39;WData.dat&#39;</span>
<span class="n">curDataset</span> <span class="o">=</span> <span class="n">buildDataset_fromFile</span><span class="p">(</span><span class="n">fname</span><span class="p">)</span> <span class="c"># Dataset from input file</span>
<span class="n">curFit</span> <span class="o">=</span> <span class="n">Fit</span><span class="p">(</span><span class="n">curDataset</span><span class="p">,</span> <span class="n">constant_1par</span><span class="p">)</span>   <span class="c"># set up the fit object</span>
<span class="n">curFit</span><span class="o">.</span><span class="n">do_fit</span><span class="p">()</span>

<span class="n">myPlot</span> <span class="o">=</span> <span class="n">Plot</span><span class="p">(</span><span class="n">curFit</span><span class="p">)</span>
<span class="n">myPlot</span><span class="o">.</span><span class="n">plot_all</span><span class="p">()</span>
<span class="n">myPlot</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s">&quot;plot.pdf&quot;</span><span class="p">)</span>
<span class="n">myPlot</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<p>The input file is necessarily more complicated, but holds
the full information on the data set in one place. Refer to
the documentation of the function <a class="reference internal" href="#kafe.file_tools.parse_general_inputfile" title="kafe.file_tools.parse_general_inputfile"><tt class="xref py py-func docutils literal"><span class="pre">parse_general_inputfile()</span></tt></a>
in module <a class="reference internal" href="#module-file_tools" title="file_tools: This submodule provides a set of helper functions for parsing files (Unix)"><tt class="xref py py-mod docutils literal"><span class="pre">file_tools</span></tt></a> for a full description of the
currently implemented keywords. The input file for the
averaging example is here:</p>
<div class="highlight-python"><pre># Measurements of W boson mass (combined LEP2, 2013)
# --------------------------------------------------
# example to use parse_general_inputfile from kafe;
#  covariance matrix build from common errors
# --
#  Meta data for plotting
*TITLE measurements of the W boson mass
*xLabel number of measurement
*yLabel $m_\matrhm{W}$
*yUnit GeV/$c^2$

# x data need not be given for averaging

# ------------------------------------------------------------
#  Measurements of W mass by ALEPH, DELPI, L3 and OPAL
#                              from from LEP2 Report Feb. 2013
#  common errors within channels
#                     2q2l: 0.021 GeV,
#                       4q: 0.044 GeV,
#     and between channels: 0.025 GeV
# ------------------------------------------------------------

*yData_SCOV
# W_mass  err     syst    sqrt of the off-diagonal
# 2q2l channel                           elements of the
80.429  0.055   0.021          #         covariance matrix
80.339  0.073   0.021   0.021
80.217  0.068   0.021   0.021 0.021
80.449  0.058   0.021   0.021 0.021 0.021
# 4q  channel
80.477  0.069   0.044   0.025 0.025 0.025 0.025 0.044
80.310  0.091   0.044   0.025 0.025 0.025 0.025 0.044 0.044
80.324  0.078   0.044   0.025 0.025 0.025 0.025 0.044 0.044 0.044
80.353  0.068   0.044   0.025 0.025 0.025 0.025 0.044 0.044 0.044 0.044</pre>
</div>
</div>
<div class="section" id="example-5-non-linear-multi-parameter-fit-damped-oscillation">
<h3>Example 5 - non-linear multi-parameter fit (damped oscillation)<a class="headerlink" href="#example-5-non-linear-multi-parameter-fit-damped-oscillation" title="Permalink to this headline">¶</a></h3>
<p>This example shows the fitting of a more complicated model function
to data collected from a damped harmonic oscillator. In such
non-linear fits, stetting the initial values is sometimes crucial
to let the fit converge at the global minimum. The <a class="reference internal" href="#kafe.fit.Fit" title="kafe.fit.Fit"><tt class="xref py py-class docutils literal"><span class="pre">Fit</span></tt></a>
object provides the method <a class="reference internal" href="#kafe.fit.Fit.set_parameters" title="kafe.fit.Fit.set_parameters"><tt class="xref py py-meth docutils literal"><span class="pre">set_parameters()</span></tt></a> for this
purpose. As the fit function for this problem is not a standard one, it is
defined explicitly making use of the decorator functions available in
<tt class="xref py py-mod docutils literal"><span class="pre">kafe</span></tt> to provide nice type setting of the parameters. This time,
the function <a class="reference internal" href="#kafe.file_tools.parse_column_data" title="kafe.file_tools.parse_column_data"><tt class="xref py py-func docutils literal"><span class="pre">parse_column_data()</span></tt></a> is used to read
the input, which is given as separate columns with the fields</p>
<blockquote>
<div><tt class="docutils literal"><span class="pre">&lt;time&gt;</span>&nbsp; <span class="pre">&lt;Amplitude&gt;</span>&nbsp;&nbsp;&nbsp; <span class="pre">&lt;error</span> <span class="pre">on</span> <span class="pre">time&gt;</span>&nbsp;&nbsp; <span class="pre">&lt;error</span> <span class="pre">on</span> <span class="pre">Amplitude&gt;</span></tt></div></blockquote>
<p>Here is the example code:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="o">...</span>
<span class="kn">from</span> <span class="nn">kafe</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">numpy</span> <span class="kn">import</span> <span class="n">exp</span><span class="p">,</span> <span class="n">cos</span>
<span class="c"># Model function definition #</span>
<span class="c"># ---------------------------</span>
<span class="c"># Set an ASCII expression for this function</span>
<span class="nd">@ASCII</span><span class="p">(</span><span class="n">x_name</span><span class="o">=</span><span class="s">&quot;t&quot;</span><span class="p">,</span> <span class="n">expression</span><span class="o">=</span><span class="s">&quot;A0*exp(-t/tau)*cos(omega*t+phi)&quot;</span><span class="p">)</span>
<span class="c"># Set some LaTeX-related parameters for this function</span>
<span class="nd">@LaTeX</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s">&#39;A&#39;</span><span class="p">,</span> <span class="n">x_name</span><span class="o">=</span><span class="s">&quot;t&quot;</span><span class="p">,</span>
       <span class="n">parameter_names</span><span class="o">=</span><span class="p">(</span><span class="s">&#39;a_0&#39;</span><span class="p">,</span> <span class="s">&#39;</span><span class="se">\\</span><span class="s">tau{}&#39;</span><span class="p">,</span> <span class="s">&#39;</span><span class="se">\\</span><span class="s">omega{}&#39;</span><span class="p">,</span> <span class="s">&#39;</span><span class="se">\\</span><span class="s">varphi{}&#39;</span><span class="p">),</span>
       <span class="n">expression</span><span class="o">=</span><span class="s">&quot;a_0</span><span class="se">\\</span><span class="s">,</span><span class="se">\\</span><span class="s">exp(-</span><span class="se">\\</span><span class="s">frac{t}{</span><span class="se">\\</span><span class="s">tau})\,&quot;</span>
                  <span class="s">&quot;\cos(</span><span class="se">\\</span><span class="s">omega{}</span><span class="se">\\</span><span class="s">,t+</span><span class="se">\\</span><span class="s">varphi{})&quot;</span><span class="p">)</span>
<span class="nd">@FitFunction</span>
<span class="k">def</span> <span class="nf">damped_oscillator</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">a0</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">tau</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">omega</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">phi</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">a0</span> <span class="o">*</span> <span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">t</span><span class="o">/</span><span class="n">tau</span><span class="p">)</span> <span class="o">*</span> <span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span> <span class="o">+</span> <span class="n">phi</span><span class="p">)</span>

<span class="c"># ---- Workflow #</span>
<span class="c"># load the experimental data from a file</span>
<span class="n">my_dataset</span> <span class="o">=</span> <span class="n">parse_column_data</span><span class="p">(</span><span class="s">&#39;damped_oscillation.dat&#39;</span><span class="p">,</span>
    <span class="n">field_order</span><span class="o">=</span><span class="s">&quot;x,y,xabserr,yabserr&quot;</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s">&quot;Damped Oscillator&quot;</span><span class="p">,</span>
    <span class="n">axis_labels</span><span class="o">=</span><span class="p">[</span><span class="s">&#39;Time t&#39;</span><span class="p">,</span> <span class="s">&#39;Amplitude&#39;</span><span class="p">])</span>
<span class="c"># --- Create the Fit</span>
<span class="n">my_fit</span> <span class="o">=</span> <span class="n">Fit</span><span class="p">(</span><span class="n">my_dataset</span><span class="p">,</span> <span class="n">damped_oscillator</span><span class="p">)</span>
<span class="c"># Set the initial values for the fit:</span>
<span class="c">#                      a_0 tau omega phi</span>
<span class="n">my_fit</span><span class="o">.</span><span class="n">set_parameters</span><span class="p">((</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">2.</span><span class="p">,</span> <span class="mf">6.28</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">))</span>
<span class="n">my_fit</span><span class="o">.</span><span class="n">do_fit</span><span class="p">()</span>
<span class="c"># --- Create and output the plots</span>
<span class="n">my_plot</span> <span class="o">=</span> <span class="n">Plot</span><span class="p">(</span><span class="n">my_fit</span><span class="p">)</span>
<span class="n">my_plot</span><span class="o">.</span><span class="n">plot_all</span><span class="p">()</span>
<span class="c">#my_plot.save(&#39;plot.pdf&#39;)</span>
<span class="n">my_fit</span><span class="o">.</span><span class="n">plot_correlations</span><span class="p">()</span> <span class="c"># all contours and profiles</span>
<span class="n">my_plot</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<p>This is the resulting output:</p>
<div class="figure align-center">
<a class="reference internal image-reference" href="_images/kafe_example5.png"><img alt="image not found" src="_images/kafe_example5.png" style="width: 600.0px; height: 300.0px;" /></a>
<p class="caption"><cite>Example 5 - fit of the time dependence of the amplitude of a damped harmonic oscillator.</cite></p>
</div>
<p>The fit function is non-linear, and, furthermore, there ist not a single
local minimum - e.g. a shift in phase of 180° corresonds to a change in
sign of the amplitude, and valid solutions are also obtained for multiples
of the base frequency. Checking of the validity of the fit result is
threfore important. The method
<tt class="xref py py-meth docutils literal"><span class="pre">plot_correlations()</span></tt> provides the
contours of all pairs of parameters and the profiles for each of
the parameters and displays them in a matrix-like arrangement.
Distorted contour-ellipses show wether the result is affected
by near-by minima, and the profiles allow to correctly assign
the parameter uncertainties in cases where the parabolic
approximation is not precise enough.</p>
<div class="figure align-center">
<a class="reference internal image-reference" href="_images/kafe_example5_correlations.png"><img alt="image not found" src="_images/kafe_example5_correlations.png" style="width: 675.0px; height: 675.0px;" /></a>
<p class="caption"><cite>Confidence contours and profiles for example 5.</cite></p>
</div>
</div>
<div class="section" id="example-6-linear-multi-parameter-fit">
<h3>Example 6 - linear multi-parameter fit<a class="headerlink" href="#example-6-linear-multi-parameter-fit" title="Permalink to this headline">¶</a></h3>
<p>This example is not much different from the previous one, except that
the fit function, a standard fourth-degree polynomial from the module
<a class="reference internal" href="#module-function_library" title="function_library: A submodule containing a collection of model functions. (Unix)"><tt class="xref py py-mod docutils literal"><span class="pre">function_library</span></tt></a>, is modified to reflect the names of the problem
given, and <tt class="xref py py-mod docutils literal"><span class="pre">matplotlib</span></tt> functionality is used to influence the
output of the plot, e.g. axis names and linear or logarithmic scale.</p>
<p>It is also shown how to circumvent a problem that
often arises when errors depend on the measured values.
For a counting rate, the (statistical) error is typically estimated
as the square root of the (observed) number of entries in each bin.
For large numbers of entries, this is not a problem,
but for small numbers, the correlation between the observed
number of entries and the error derived from it leads to a
bias when fitting functions to the data. This problem can be
avoided by iterating the fit procedure:</p>
<p>In a pre-fit, a first approximation of the model function is
determined, which is then used to calculate
the expected errors, and the original errors are
replaced before performing the final fit. Note that the numbers
of entries in the bins must be sufficiently large to justify
a replacement of the (asymmetric) Poisson uncertainties by
the symmetric uncertainties implied by the χ²-method.</p>
<p>The implementation of this  procedure needs accesses some
more fundamental methods of the <cite>Dataset</cite>, <cite>Fit</cite> and
<cite>FitFunction</cite> classes. The code shown below demonstrates
how this can be done with <tt class="xref py py-mod docutils literal"><span class="pre">kafe</span></tt>, using some of its lower-level,
internal interfaces:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">kafe.function_library</span> <span class="kn">import</span> <span class="n">poly4</span>
<span class="c"># modify function&#39;s independent variable name to reflect its nature:</span>
<span class="n">poly4</span><span class="o">.</span><span class="n">x_name</span> <span class="o">=</span> <span class="s">&#39;x=cos(t)&#39;</span>
<span class="n">poly4</span><span class="o">.</span><span class="n">latex_x_name</span> <span class="o">=</span> <span class="s">&#39;x=</span><span class="se">\\</span><span class="s">cos(</span><span class="se">\\</span><span class="s">theta)&#39;</span>
<span class="o">...</span>

<span class="c"># Set the axis labels appropriately</span>
<span class="n">my_plot</span><span class="o">.</span><span class="n">axis_labels</span> <span class="o">=</span> <span class="p">[</span><span class="s">&#39;$</span><span class="se">\\</span><span class="s">cos(</span><span class="se">\\</span><span class="s">theta)$&#39;</span><span class="p">,</span> <span class="s">&#39;counting rate&#39;</span><span class="p">]</span>
<span class="o">...</span>
<span class="c"># load the experimental data from a file</span>
<span class="n">my_dataset</span> <span class="o">=</span> <span class="n">parse_column_data</span><span class="p">(</span>
  <span class="s">&#39;counting_rate.dat&#39;</span><span class="p">,</span>
  <span class="n">field_order</span><span class="o">=</span><span class="s">&quot;x,y,yabserr&quot;</span><span class="p">,</span>
  <span class="n">title</span><span class="o">=</span><span class="s">&quot;Counting Rate per Angle&quot;</span><span class="p">)</span>

<span class="c">### pre-fit</span>
<span class="c"># error for bins with zero contents is set to 1.</span>
<span class="n">covmat</span> <span class="o">=</span> <span class="n">my_dataset</span><span class="o">.</span><span class="n">get_cov_mat</span><span class="p">(</span><span class="s">&#39;y&#39;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">covmat</span><span class="p">)):</span>
    <span class="k">if</span> <span class="n">covmat</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="mf">0.</span><span class="p">:</span>
        <span class="n">covmat</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1.</span>
<span class="n">my_dataset</span><span class="o">.</span><span class="n">set_cov_mat</span><span class="p">(</span><span class="s">&#39;y&#39;</span><span class="p">,</span> <span class="n">covmat</span><span class="p">)</span> <span class="c"># write it back</span>

<span class="c"># Create the Fit</span>
<span class="n">my_fit</span> <span class="o">=</span> <span class="n">Fit</span><span class="p">(</span><span class="n">my_dataset</span><span class="p">,</span> <span class="n">poly4</span><span class="p">)</span>
<span class="c">#            fit_label=&quot;Linear Regression &quot; + dataset.data_label[-1])</span>

<span class="c"># perform an initial fit with temporary errors (minimal output)</span>
<span class="n">my_fit</span><span class="o">.</span><span class="n">call_minimizer</span><span class="p">(</span><span class="n">final_fit</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>

<span class="c"># set errors using model at pre-fit parameter values:</span>
<span class="c">#       sigma_i^2=cov[i, i]=n(x_i)</span>
<span class="n">fdata</span> <span class="o">=</span> <span class="n">my_fit</span><span class="o">.</span><span class="n">fit_function</span><span class="o">.</span><span class="n">evaluate</span><span class="p">(</span><span class="n">my_fit</span><span class="o">.</span><span class="n">xdata</span><span class="p">,</span>
                                   <span class="n">my_fit</span><span class="o">.</span><span class="n">current_parameter_values</span><span class="p">)</span>
<span class="n">np</span><span class="o">.</span><span class="n">fill_diagonal</span><span class="p">(</span><span class="n">covmat</span><span class="p">,</span> <span class="n">fdata</span><span class="p">)</span>
<span class="n">my_fit</span><span class="o">.</span><span class="n">current_cov_mat</span> <span class="o">=</span> <span class="n">covmat</span>  <span class="c"># write new covariance matrix</span>
<span class="c">### end pre-fit - rest is as usual</span>
<span class="n">my_fit</span><span class="o">.</span><span class="n">do_fit</span><span class="p">()</span>
<span class="c"># Create the plots and --</span>
<span class="n">my_plot</span> <span class="o">=</span> <span class="n">Plot</span><span class="p">(</span><span class="n">my_fit</span><span class="p">)</span>
<span class="c"># -- set the axis labels</span>
<span class="n">my_plot</span><span class="o">.</span><span class="n">axis_labels</span> <span class="o">=</span> <span class="p">[</span><span class="s">&#39;$</span><span class="se">\\</span><span class="s">cos(</span><span class="se">\\</span><span class="s">theta)$&#39;</span><span class="p">,</span> <span class="s">&#39;counting rate&#39;</span><span class="p">]</span>
<span class="c"># -- set scale linear / log</span>
<span class="n">my_plot</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">set_yscale</span><span class="p">(</span><span class="s">&#39;linear&#39;</span><span class="p">)</span>
<span class="o">...</span>
</pre></div>
</div>
<p>This is the resulting output:</p>
<div class="figure align-center">
<a class="reference internal image-reference" href="_images/kafe_example6.png"><img alt="image not found" src="_images/kafe_example6.png" style="width: 600.0px; height: 300.0px;" /></a>
<p class="caption"><cite>Output of example 6 - counting rate.</cite></p>
</div>
</div>
<div class="section" id="example-7-another-non-linear-multi-parameter-fit-double-slit-spectrum">
<h3>Example 7 - another non-linear multi-parameter fit (double-slit spectrum)<a class="headerlink" href="#example-7-another-non-linear-multi-parameter-fit-double-slit-spectrum" title="Permalink to this headline">¶</a></h3>
<p>Again, not much new in this example, except that the
model is now very non-linear, the intensity distribution
of light after passing through a double-slit. The
non-standard model definition again makes use of the
decorator mechanism to provide nice output - the decorators
(expressions beginning with &#8216;&#64;&#8217;) can safely be omitted if <cite>LaTeX</cite>
output is not needed. Setting of appropriate initial
conditions is absolutely mandatory for this example,
because there  exist many local minima of the χ² function.</p>
<p>Another problem becomes obvious when carefully inspecting
the fit function definition: only two of the three parameters g,
b or k can be determined, and therefore one must be kept fixed,
or an external constraint must be applied.
Failing to do so will result in large, correlated errors
on the parameters g, b and k as an indication of the problem.</p>
<p>Fixing parameters of a model function is achieved by the method
<a class="reference internal" href="#kafe.fit.Fit.fix_parameters" title="kafe.fit.Fit.fix_parameters"><tt class="xref py py-meth docutils literal"><span class="pre">fix_parameters()</span></tt></a>, and a constraint within a given uncertainty
is achieved by the method <a class="reference internal" href="#kafe.fit.Fit.constrain_parameters" title="kafe.fit.Fit.constrain_parameters"><tt class="xref py py-meth docutils literal"><span class="pre">constrain_parameters()</span></tt></a>
of the <a class="reference internal" href="#kafe.fit.Fit" title="kafe.fit.Fit"><tt class="xref py py-class docutils literal"><span class="pre">Fit</span></tt></a> class.</p>
<p>Here are the interesting pieces of code:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="o">...</span>
<span class="c"># Model function definition #</span>
<span class="c"># Set an ASCII expression for this function</span>
<span class="nd">@ASCII</span><span class="p">(</span><span class="n">x_name</span><span class="o">=</span><span class="s">&quot;x&quot;</span><span class="p">,</span> <span class="n">expression</span><span class="o">=</span><span class="s">&quot;I0*(sin(k/2*b*sin(x))/(k/2*b*sin(x))&quot;</span>
                              <span class="s">&quot;*cos(k/2*g*sin(x)))^2&quot;</span><span class="p">)</span>
<span class="c"># Set some LaTeX-related parameters for this function</span>
<span class="nd">@LaTeX</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s">&#39;I&#39;</span><span class="p">,</span> <span class="n">x_name</span><span class="o">=</span><span class="s">&quot;</span><span class="se">\\</span><span class="s">alpha{}&quot;</span><span class="p">,</span>
       <span class="n">parameter_names</span><span class="o">=</span><span class="p">(</span><span class="s">&#39;I_0&#39;</span><span class="p">,</span> <span class="s">&#39;b&#39;</span><span class="p">,</span> <span class="s">&#39;g&#39;</span><span class="p">,</span> <span class="s">&#39;k&#39;</span><span class="p">),</span>
       <span class="n">expression</span><span class="o">=</span><span class="s">&quot;I_0</span><span class="se">\\</span><span class="s">,</span><span class="se">\\</span><span class="s">left(</span><span class="se">\\</span><span class="s">frac{</span><span class="se">\\</span><span class="s">sin(</span><span class="se">\\</span><span class="s">frac{k}{2}</span><span class="se">\\</span><span class="s">,b</span><span class="se">\\</span><span class="s">,</span><span class="se">\\</span><span class="s">sin{</span><span class="se">\\</span><span class="s">alpha})}&quot;</span>
                  <span class="s">&quot;{</span><span class="se">\\</span><span class="s">frac{k}{2}</span><span class="se">\\</span><span class="s">,b</span><span class="se">\\</span><span class="s">,</span><span class="se">\\</span><span class="s">sin{</span><span class="se">\\</span><span class="s">alpha}}&quot;</span>
                  <span class="s">&quot;</span><span class="se">\\</span><span class="s">cos(</span><span class="se">\\</span><span class="s">frac{k}{2}</span><span class="se">\\</span><span class="s">,g</span><span class="se">\\</span><span class="s">,</span><span class="se">\\</span><span class="s">sin{</span><span class="se">\\</span><span class="s">alpha})</span><span class="se">\\</span><span class="s">right)^2&quot;</span><span class="p">)</span>
<span class="nd">@FitFunction</span>
<span class="k">def</span> <span class="nf">double_slit</span><span class="p">(</span><span class="n">alpha</span><span class="p">,</span> <span class="n">I0</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">b</span><span class="o">=</span><span class="mf">10e-6</span><span class="p">,</span> <span class="n">g</span><span class="o">=</span><span class="mf">20e-6</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="mf">1.e7</span><span class="p">):</span>
    <span class="n">k_half_sine_alpha</span> <span class="o">=</span> <span class="n">k</span><span class="o">/</span><span class="mi">2</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">alpha</span><span class="p">)</span>  <span class="c"># helper variable</span>
    <span class="n">k_b</span> <span class="o">=</span> <span class="n">k_half_sine_alpha</span> <span class="o">*</span> <span class="n">b</span>
    <span class="n">k_g</span> <span class="o">=</span> <span class="n">k_half_sine_alpha</span> <span class="o">*</span> <span class="n">g</span>
    <span class="k">return</span> <span class="n">I0</span> <span class="o">*</span> <span class="p">(</span><span class="n">sin</span><span class="p">(</span><span class="n">k_b</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">k_b</span><span class="p">)</span> <span class="o">*</span> <span class="n">cos</span><span class="p">(</span><span class="n">k_g</span><span class="p">))</span><span class="o">**</span><span class="mi">2</span>

<span class="o">...</span>

<span class="c"># Set the initial values for the fit</span>
<span class="c">#                      I   b      g        k</span>
<span class="n">my_fit</span><span class="o">.</span><span class="n">set_parameters</span><span class="p">((</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">20e-6</span><span class="p">,</span> <span class="mf">50e-6</span><span class="p">,</span> <span class="mf">9.67e6</span><span class="p">))</span>
<span class="c"># fix one of the (redundant) parameters, here &#39;k&#39;</span>
<span class="n">my_fit</span><span class="o">.</span><span class="n">fix_parameters</span><span class="p">(</span><span class="s">&#39;k&#39;</span><span class="p">)</span>

<span class="o">...</span>
</pre></div>
</div>
<p>If the parameter <cite>k</cite> in the example above has a (known) uncertainty,
is is more appropriate to constrain it within its uncertainty (which
may be known from an independent measurement or from the specifications
of the laser used in the experiment). To take into account a
wave number <cite>k</cite> known with a precision of 10&#8216;000 the
last line in the example above should be replaced by:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="o">...</span>
<span class="n">my_fit</span><span class="o">.</span><span class="n">constrain_parameters</span><span class="p">([</span><span class="s">&#39;k&#39;</span><span class="p">],</span> <span class="p">[</span><span class="mf">9.67e6</span><span class="p">],</span> <span class="p">[</span><span class="mf">1.e4</span><span class="p">])</span>
<span class="o">...</span>
</pre></div>
</div>
<p>This is the resulting output:</p>
<div class="figure align-center">
<a class="reference internal image-reference" href="_images/kafe_example7.png"><img alt="image not found" src="_images/kafe_example7.png" style="width: 600.0px; height: 300.0px;" /></a>
<p class="caption"><cite>Example 7 - fit of the intensity distribution of light behind a double slit with fixed or constrained wave length.</cite></p>
</div>
</div>
<div class="section" id="example-8-fit-of-a-breit-wigner-resonance-to-data-with-correlated-errors">
<h3>Example 8 - fit of a Breit-Wigner Resonance to data with correlated errors<a class="headerlink" href="#example-8-fit-of-a-breit-wigner-resonance-to-data-with-correlated-errors" title="Permalink to this headline">¶</a></h3>
<p>This example illustrates how to define the data and the fit function
in a single file - provided by the helper function <a class="reference internal" href="#kafe.file_tools.buildFit_fromFile" title="kafe.file_tools.buildFit_fromFile"><tt class="xref py py-func docutils literal"><span class="pre">buildFit_fromFile()</span></tt></a>
in module <a class="reference internal" href="#module-file_tools" title="file_tools: This submodule provides a set of helper functions for parsing files (Unix)"><tt class="xref py py-mod docutils literal"><span class="pre">file_tools</span></tt></a>. Parsing of the input file is done by the
function <a class="reference internal" href="#kafe.file_tools.parse_general_inputfile" title="kafe.file_tools.parse_general_inputfile"><tt class="xref py py-func docutils literal"><span class="pre">parse_general_inputfile()</span></tt></a>, which had already been introduced
in Example 4. The definition of the fit function as <cite>Python</cite> code
including the <tt class="xref py py-mod docutils literal"><span class="pre">kafe</span></tt> decorators in the input file, however, is new.
Note: because spaces are used to to separate data  fields in the
input file, spaces needed for proper <cite>Python</cite> indentation have to be
replaced by &#8216;~&#8217;. The last key in the file defines the start values
of the parameters and their initial ranges.</p>
<p>The advantage of this approach is the location of all data
and the fit model in one place, which is strictly separated
from the <cite>Python</cite> code. The <cite>Python</cite> code below is thus very general
and can handle a large large variety of problems without
modification (except for the file name, which could easily be
passed on the command line):</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">kafe</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">kafe.file_tools</span> <span class="kn">import</span> <span class="n">buildFit_fromFile</span>
<span class="c"># ---------------------------------------------------------</span>
<span class="n">fname</span> <span class="o">=</span> <span class="s">&#39;LEP-Data.dat&#39;</span>
<span class="c"># initialize fit object from file</span>
<span class="n">BWfit</span> <span class="o">=</span> <span class="n">buildFit_fromFile</span><span class="p">(</span><span class="n">fname</span><span class="p">)</span>
<span class="n">BWfit</span><span class="o">.</span><span class="n">do_fit</span><span class="p">()</span>
<span class="c">#</span>
<span class="n">BWplot</span> <span class="o">=</span> <span class="n">Plot</span><span class="p">(</span><span class="n">BWfit</span><span class="p">)</span>
<span class="n">BWplot</span><span class="o">.</span><span class="n">plot_all</span><span class="p">()</span>
<span class="n">BWplot</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s">&quot;plot.pdf&quot;</span><span class="p">)</span>
<span class="n">BWplot</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<p>The magic happens in the input file, which now has to provide
all the information needed to perform the fit:</p>
<div class="highlight-python"><pre># Fit of a Breit-Wigner function to
#      measurements of hadronic Z cross sections at LEP
# - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
#  Meta-data for plotting
*TITLE  LEP Hadronic Cross Section ($\sigma^0_\mathrm{had}$)
*xLabel $E_CM$
*xUnit  $\mathrm{GeV}$
*yLabel $\sigma^0_{\mathrm{had}}$
*yUnit  $\mathrm{nb}$

#----------------------------------------------------------------------
# DATA: average of hadronic cross sections measured by
#  ALEPH, DELPHI, L3 and OPAL around 7 energy points at the Z resonance
#----------------------------------------------------------------------

# CMenergy E err
*xData
 88.387  0.005
 89.437  0.0015
 90.223  0.005
 91.238  0.003
 92.059  0.005
 93.004  0.0015
 93.916  0.005
# Centre-of-mass energy has a common uncertainty
*xAbsCor 0.0017

# sig^0_h  sig err     #  rad.cor  sig_h measured
*yData
 6.803   0.036      #  1.7915    5.0114
 13.965  0.013      #  4.0213    9.9442
 26.113  0.075      #  7.867    18.2460
 41.364  0.010      #  10.8617  30.5022
 27.535  0.088      #  3.9164   23.6187
 13.362  0.015      # -0.6933   14.0552
  7.302  0.045      # -1.8181    9.1196
# cross-sections have a common relative error
*yRelCor 0.0007

*FITLABEL Breit-Wigner-Fit {\large{( with s-dependent width )}}
*FitFunction
# Breit-Wigner with s-dependent width
@ASCII(expression='s0*E^2*G^2/[(E^2-M^2)^2+(E^4*G^2/M^2)]')
@LaTeX(name='f', parameter_names=('\\sigma^0', 'M_Z', '\\Gamma_Z'),
expression='\\frac{\\sigma^0\\, M_Z^2\\Gamma^2}'
               '{((E^2-M_Z^2)^2+(E^4\\Gamma^2 / M_Z^2))}')
@FitFunction
def fitf(E, M=91.2, G=2.5, s0=41.0):
~~~~return s0*E*E*G*G/((E*E-M*M)**2+(E**4*G*G/(M*M)))

*InitialParameters    # set initial values and ranges
91.2 0.1
2.5  0.1
41.  0.5</pre>
</div>
<p>Here is the output:</p>
<div class="figure align-center">
<a class="reference internal image-reference" href="_images/kafe_BreitWignerFit.png"><img alt="image not found" src="_images/kafe_BreitWignerFit.png" style="width: 600.0px; height: 300.0px;" /></a>
<p class="caption"><cite>Output of example 8 - Fit of a Breit-Wigner function.</cite></p>
</div>
<p>This example also contains a code snippet demonstrating how to plot
contours by calling the <a class="reference internal" href="#kafe.fit.Fit" title="kafe.fit.Fit"><tt class="xref py py-class docutils literal"><span class="pre">Fit</span></tt></a> object&#8217;s
<tt class="xref py py-meth docutils literal"><span class="pre">plot_contour()</span></tt> method. This is the code:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="c"># plot pairs of contours at 1 sigma, 68%, 2 sigma and 95%</span>
<span class="n">cont_fig1</span> <span class="o">=</span> <span class="n">BWfit</span><span class="o">.</span><span class="n">plot_contour</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">dchi2</span><span class="o">=</span><span class="p">[</span><span class="mf">1.</span><span class="p">,</span><span class="mf">2.3</span><span class="p">,</span><span class="mf">4.</span><span class="p">,</span><span class="mf">5.99</span><span class="p">])</span>
<span class="n">cont_fig2</span> <span class="o">=</span> <span class="n">BWfit</span><span class="o">.</span><span class="n">plot_contour</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">dchi2</span><span class="o">=</span><span class="p">[</span><span class="mf">1.</span><span class="p">,</span><span class="mf">2.3</span><span class="p">,</span><span class="mf">4.</span><span class="p">,</span><span class="mf">5.99</span><span class="p">])</span>
<span class="n">cont_fig3</span> <span class="o">=</span> <span class="n">BWfit</span><span class="o">.</span><span class="n">plot_contour</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">dchi2</span><span class="o">=</span><span class="p">[</span><span class="mf">1.</span><span class="p">,</span><span class="mf">2.3</span><span class="p">,</span><span class="mf">4.</span><span class="p">,</span><span class="mf">5.99</span><span class="p">])</span>
<span class="c"># save to files</span>
<span class="n">cont_fig1</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s">&quot;kafe_BreitWignerFit_contour12.pdf&quot;</span><span class="p">)</span>
<span class="n">cont_fig2</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s">&quot;kafe_BreitWignerFit_contour13.pdf&quot;</span><span class="p">)</span>
<span class="n">cont_fig3</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s">&quot;kafe_BreitWignerFit_contour23.pdf&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>The resulting pictures show that parameter correlations are
relatively small:</p>
<div class="figure align-center">
<img alt="image not found" src="_images/kafe_BreitWignerFit_contours.png" style="width: 900px; height: 300px;" />
<p class="caption"><cite>Contours generated in example 8 - Fit of a Breit-Wigner function.</cite></p>
</div>
</div>
<div class="section" id="example-9-fit-of-a-function-to-histogram-data">
<h3>Example 9 - fit of a function to histogram data<a class="headerlink" href="#example-9-fit-of-a-function-to-histogram-data" title="Permalink to this headline">¶</a></h3>
<p>This example brings us to the limit of what is currently
possible with <tt class="xref py py-mod docutils literal"><span class="pre">kafe</span></tt>. Here, the data represent the
center of a histogram bins ad the number of entries, <img class="math" src="_images/math/7eb75ccf06e046206cb4c636a54d7be11d049fbf.png" alt="n_i"/>,
in each bin. The (statistical) error is typically estimated
as the square root of the (observed) number of entries in each bin.
For large numbers of entries, this is not a problem,
but for small numbers, especially for bins with 0 entries,
the correlation between the observed number of entries and
the error derived from it leads to a bias when fitting
functions to the histogram data. In particular, bins with
zero entries cannot be handled in the χ²-function, and are
typically omitted to cure the problem.  However, a bias
remains, as bins with downward fluctuations of the
observed numbers of events get assigned smaller errors
and hence larger weights in the fitting procedure - leading
to the aforementioned bias.</p>
<p>These problems are avoided by using a likelihood method for
such use cases, where the Poisson distribution of the uncertainties
and their dependence on the values of the fit model is properly
taken into account. However, the χ²-method can be saved to some
extend if the fitting procedure is iterated. In a pre-fit, a
first approximation of the model function is determined, where
the error in bins with zero entries is set to one. The model
function determined from the pre-fit is then used to calculate
the expected errors for each bin, and the original errors are
replaced before performing the final fit. Note that the numbers
of entries in the bins must be sufficiently large to justify
a replacement of the (asymmetric) Poisson uncertainties by
the symmetric uncertainties implied by the χ²-method.</p>
<p>The code shown below demonstrates
how to get a grip on such more complex procedures with
more fundamental methods of the <cite>Dataset</cite>, <cite>Fit</cite> and
<cite>FitFunction</cite> classes:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="o">...</span>
<span class="c"># Load Dataset from file</span>
<span class="n">hdataset</span> <span class="o">=</span> <span class="n">Dataset</span><span class="p">(</span><span class="n">input_file</span><span class="o">=</span><span class="s">&#39;hdataset.dat&#39;</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s">&quot;Data for example 9&quot;</span><span class="p">)</span>

<span class="c"># error for bins with zero contents is set to 1.</span>
<span class="n">covmat</span> <span class="o">=</span> <span class="n">hdataset</span><span class="o">.</span><span class="n">get_cov_mat</span><span class="p">(</span><span class="s">&#39;y&#39;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">covmat</span><span class="p">)):</span>
    <span class="k">if</span> <span class="n">covmat</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="mf">0.</span><span class="p">:</span>
        <span class="n">covmat</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1.</span>
<span class="n">hdataset</span><span class="o">.</span><span class="n">set_cov_mat</span><span class="p">(</span><span class="s">&#39;y&#39;</span><span class="p">,</span> <span class="n">covmat</span><span class="p">)</span> <span class="c"># write it back</span>

<span class="c"># Create the Fit instance</span>
<span class="n">hfit</span> <span class="o">=</span> <span class="n">Fit</span><span class="p">(</span><span class="n">hdataset</span><span class="p">,</span> <span class="n">gauss</span><span class="p">,</span> <span class="n">fit_label</span><span class="o">=</span><span class="s">&quot;Fit of a Gaussian to histogram data&quot;</span><span class="p">)</span>
<span class="c">#</span>
<span class="c"># perform an initial fit with temporary errors (minimal output)</span>
<span class="n">hfit</span><span class="o">.</span><span class="n">call_minimizer</span><span class="p">(</span><span class="n">final_fit</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="c">#</span>
<span class="c">#re-set errors using model at pre-fit parameter values:</span>
<span class="c">#        sigma_i^2=cov[i, i]=n(x_i)</span>
<span class="n">fdata</span><span class="o">=</span><span class="n">hfit</span><span class="o">.</span><span class="n">fit_function</span><span class="o">.</span><span class="n">evaluate</span><span class="p">(</span><span class="n">hfit</span><span class="o">.</span><span class="n">xdata</span><span class="p">,</span> <span class="n">hfit</span><span class="o">.</span><span class="n">current_parameter_values</span><span class="p">)</span>
<span class="n">np</span><span class="o">.</span><span class="n">fill_diagonal</span><span class="p">(</span><span class="n">covmat</span><span class="p">,</span> <span class="n">fdata</span><span class="p">)</span>
<span class="n">hfit</span><span class="o">.</span><span class="n">current_cov_mat</span> <span class="o">=</span> <span class="n">covmat</span> <span class="c"># write back new covariance matrix</span>
<span class="c">#</span>
<span class="c"># now do final fit with full output</span>
<span class="n">hfit</span><span class="o">.</span><span class="n">do_fit</span><span class="p">()</span>
<span class="c"># and create, draw, save and show plot</span>
<span class="o">...</span>
</pre></div>
</div>
<p>Here is the output, which shows that the parameters of the
standard normal distribution, from which the data were generated,
are reproduced well by the fit result:</p>
<div class="figure align-center">
<a class="reference internal image-reference" href="_images/kafe_example9.png"><img alt="image not found" src="_images/kafe_example9.png" style="width: 600.0px; height: 300.0px;" /></a>
<p class="caption"><cite>Output of example 9 - Fit of a Gaussian distribution to histogram data</cite></p>
</div>
</div>
<div class="section" id="example-10-plotting-with-kafe-properties-of-a-gauss-curve">
<h3>Example 10 - Plotting with <tt class="xref py py-mod docutils literal"><span class="pre">kafe</span></tt>: properties of a Gauss curve<a class="headerlink" href="#example-10-plotting-with-kafe-properties-of-a-gauss-curve" title="Permalink to this headline">¶</a></h3>
<p>This example shows how to access the <tt class="xref py py-mod docutils literal"><span class="pre">kafe</span></tt> plot objects
to annotate plots with <tt class="xref py py-mod docutils literal"><span class="pre">matplotlib</span></tt> functionality.</p>
<p>A dummy object <a class="reference internal" href="#kafe.dataset.Dataset" title="kafe.dataset.Dataset"><tt class="xref py py-class docutils literal"><span class="pre">Dataset</span></tt></a> is
created with points lying exactly on a Gaussian curve.
The <a class="reference internal" href="#kafe.fit.Fit" title="kafe.fit.Fit"><tt class="xref py py-class docutils literal"><span class="pre">Fit</span></tt></a> will then converge toward
that very same Gaussian. When plotting, the data points
used to &#8220;support&#8221; the curve can be omitted.</p>
<div class="figure align-center">
<a class="reference internal image-reference" href="_images/kafe_example10.png"><img alt="image not found" src="_images/kafe_example10.png" style="width: 600.0px; height: 300.0px;" /></a>
<p class="caption"><cite>Output of example 10 - properties of a Gauss curve.</cite></p>
</div>
</div>
</div>
<div class="section" id="kafe-documentation-module-descriptions">
<h2><tt class="xref py py-mod docutils literal"><span class="pre">kafe</span></tt> Documentation &#8211; module descriptions<a class="headerlink" href="#kafe-documentation-module-descriptions" title="Permalink to this headline">¶</a></h2>
<p>The following documentation of functions and methods
of relevance to the user interface was generated from
the <cite>DocStrings</cite> contained in the <cite>Python</cite> code of the
<tt class="xref py py-mod docutils literal"><span class="pre">kafe</span></tt> package.
For further information or if in doubt about the exact
functionality, users are invited to consult the source
code.</p>
<div class="section" id="module-kafe.__init__">
<span id="init-module"></span><h3><tt class="xref py py-mod docutils literal"><span class="pre">__init__</span></tt> Module<a class="headerlink" href="#module-kafe.__init__" title="Permalink to this headline">¶</a></h3>
<p><strong>kafe</strong> <em>&#8211; a Python package for fitting and plotting for use in physics lab courses.</em></p>
<p>This Python package allows fitting of user-defined functions to data. A dataset
is represented by a <cite>Dataset</cite> object which stores measurement data as <cite>NumPy</cite>
arrays. The uncertainties of the data are also stored in the <cite>Dataset</cite> as an
<cite>error matrix</cite>, allowing for both correlated and uncorrelated errors to be
accurately represented.</p>
<p>The constructor of a <cite>Dataset</cite> object accepts several keyword arguments and can
be used to construct a <cite>Dataset</cite> from input data which has been loaded into
<cite>Python</cite> as <cite>NumPy</cite> arrays. Alternatively, a plain-text representations of a
<cite>Dataset</cite> can be read from a file.</p>
<p>Also provided are helper functions which construct a <cite>Dataset</cite> object from a
file containing column data (one measurement per row, column order can be
specified), or from a keyword-driven input format.</p>
</div>
<div class="section" id="module-kafe._version_info">
<span id="version-info-module"></span><h3><tt class="xref py py-mod docutils literal"><span class="pre">_version_info</span></tt> Module<a class="headerlink" href="#module-kafe._version_info" title="Permalink to this headline">¶</a></h3>
<span class="target" id="module-__version_info"></span><dl class="function">
<dt id="kafe._version_info.get_version">
<tt class="descclassname">kafe._version_info.</tt><tt class="descname">get_version</tt><big>(</big><big>)</big><a class="headerlink" href="#kafe._version_info.get_version" title="Permalink to this definition">¶</a></dt>
<dd><p>kafe version 0.5.2</p>
</dd></dl>

</div>
<div class="section" id="module-kafe.dataset">
<span id="dataset-module"></span><h3><a class="reference internal" href="#module-dataset" title="dataset: This sub-module defines a `Dataset` object, a container class for storing measurement data and error data. It also provides functions to build a Dataset object from pyhton arrays or read from or export data to a file (Unix)"><tt class="xref py py-mod docutils literal"><span class="pre">dataset</span></tt></a> Module<a class="headerlink" href="#module-kafe.dataset" title="Permalink to this headline">¶</a></h3>
<span class="target" id="module-dataset"></span><dl class="class">
<dt id="kafe.dataset.Dataset">
<em class="property">class </em><tt class="descclassname">kafe.dataset.</tt><tt class="descname">Dataset</tt><big>(</big><em>input_file=None, data=None, cov_mats=None, title='Untitled Dataset', basename=None, axis_labels=['x', 'y'], axis_units=['', '']</em><big>)</big><a class="headerlink" href="#kafe.dataset.Dataset" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <tt class="xref py py-class docutils literal"><span class="pre">object</span></tt></p>
<p>The <cite>Dataset</cite> object is a data structure for storing measurement and error
data. In this implementation, the <cite>Dataset</cite> has the compulsory field
<cite>data</cite>, which is used for storing the measurement data, and another field
<cite>cov_mats</cite>, used for storing the covariance matrix for each axis.</p>
<p>There are two ways a <cite>Dataset</cite> can be constructed. The most
straightforward way is to specify an input file containing a plain-text
representation of the dataset:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">my_dataset</span> <span class="o">=</span> <span class="n">Dataset</span><span class="p">(</span><span class="n">input_file</span><span class="o">=</span><span class="s">&#39;/path/to/file&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>or</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">my_dataset</span> <span class="o">=</span> <span class="n">Dataset</span><span class="p">(</span><span class="n">input_file</span><span class="o">=</span><span class="n">my_file_object</span><span class="p">)</span>
</pre></div>
</div>
<p>If an <cite>input_file</cite> argument is provided, the <cite>data</cite> and <cite>cov_mats</cite>
arguments are ignored. The <cite>Dataset</cite> plain-text representation format
is as follows:</p>
<div class="highlight-python"><pre># x data
x_1  sigma_x_1
x_2  sigma_x_2  cor_x_12
...  ...        ...       ...
x_N  sigma_x_N  cor_x_1N  ...  cor_x_NN

# y data
y_1  sigma_y_1
y_2  sigma_y_2  cor_y_12
...  ...        ...       ...
y_N  sigma_y_N  cor_y_1N  ...  cor_y_NN</pre>
</div>
<p>Here, the <cite>sigma_...</cite> represents the fully uncorrelated error of the data
point and <cite>cor_..._ij</cite> is the correlation coefficient between the <em>i</em>-th
and <em>j</em>-th data point.</p>
<p>Alternatively, field data can be set by passing iterables as arguments.
Available arguments for this purpose are:</p>
<p><strong>data</strong> : tuple/list of tuples/lists/arrays of floats</p>
<blockquote>
<div><p>a tuple/list of measurement data. Each element of the tuple/list must
be iterable and be of the same length. The first element of the
<strong>data</strong> tuple/list is assumed to be the <cite>x</cite> data, and the second to be
the <cite>y</cite> data:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">my_dataset</span> <span class="o">=</span> <span class="n">Dataset</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="p">([</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mf">2.</span><span class="p">],</span> <span class="p">[</span><span class="mf">1.23</span><span class="p">,</span> <span class="mf">3.45</span><span class="p">,</span> <span class="mf">5.62</span><span class="p">]))</span>
</pre></div>
</div>
<p>Alternatively, x-y value pairs can also be passed as <strong>data</strong>. The
following is equivalent to the above:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">my_dataset</span> <span class="o">=</span> <span class="n">Dataset</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="p">([</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.23</span><span class="p">],</span> <span class="p">[</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">3.45</span><span class="p">],</span> <span class="p">[</span><span class="mf">2.0</span><span class="p">,</span> <span class="mf">5.62</span><span class="p">]))</span>
</pre></div>
</div>
<p>In case the <cite>Dataset</cite> contains two data points, the ordering is
ambiguous. In this case, the first ordering (<cite>x</cite> data first, then <cite>y</cite>
data) is assumed.</p>
</div></blockquote>
<p><em>cov_mats</em> : tuple/list of <cite>numpy.matrix</cite> (optional)</p>
<blockquote>
<div><p>a tuple/list of two-dimensional iterables containing the covariance
matrices for <cite>x</cite> and <cite>y</cite>, in that order. Covariance matrices can be any
sort of two-dimensional NxN iterables, assuming N is the number of data
points.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">my_dataset</span> <span class="o">=</span> <span class="n">Dataset</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="p">([</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mf">2.</span><span class="p">],</span> <span class="p">[</span><span class="mf">1.23</span><span class="p">,</span> <span class="mf">3.45</span><span class="p">,</span> <span class="mf">5.62</span><span class="p">]),</span> <span class="n">cov_mats</span><span class="o">=</span><span class="p">(</span><span class="n">my_cov_mat_x</span><span class="p">,</span> <span class="n">my_cov_mat_y</span><span class="p">))</span>
</pre></div>
</div>
<p>This keyword argument can be omitted, in which case covariance matrices
of zero are assumed. To specify a covariance matrix for a single axis,
replace the other with <tt class="docutils literal"><span class="pre">None</span></tt>.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">my_dataset</span> <span class="o">=</span> <span class="n">Dataset</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="p">([</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mf">2.</span><span class="p">],</span> <span class="p">[</span><span class="mf">1.23</span><span class="p">,</span> <span class="mf">3.45</span><span class="p">,</span> <span class="mf">5.62</span><span class="p">]),</span> <span class="n">cov_mats</span><span class="o">=</span><span class="p">(</span><span class="bp">None</span><span class="p">,</span> <span class="n">my_cov_mat_y</span><span class="p">))</span>
</pre></div>
</div>
</div></blockquote>
<p><em>title</em> : string (optional)</p>
<blockquote>
<div>the name of the <cite>Dataset</cite>. If omitted, the <cite>Dataset</cite> will be given the
generic name &#8216;Untitled Dataset&#8217;.</div></blockquote>
<p><em>axis_labels</em> : list of strings (optional)</p>
<blockquote>
<div>labels for the <cite>x</cite> and <cite>y</cite> axes. If omitted, these will be set to
<tt class="docutils literal"><span class="pre">'x'</span></tt> and <tt class="docutils literal"><span class="pre">'y'</span></tt>, respectively.</div></blockquote>
<p><em>axis_units</em> : list of strings (optional)</p>
<blockquote>
<div>units for the <cite>x</cite> and <cite>y</cite> axes. If omitted, these will be assumed to be
dimensionless, i.e. the unit will be an empty string.</div></blockquote>
<dl class="method">
<dt id="kafe.dataset.Dataset.cov_mat_is_regular">
<tt class="descname">cov_mat_is_regular</tt><big>(</big><em>axis</em><big>)</big><a class="headerlink" href="#kafe.dataset.Dataset.cov_mat_is_regular" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns <cite>True</cite> if the covariance matrix for an axis is regular and
<tt class="docutils literal"><span class="pre">False</span></tt> if it is singular.</p>
<dl class="docutils">
<dt><strong>axis</strong> <span class="classifier-delimiter">:</span> <span class="classifier"><tt class="docutils literal"><span class="pre">'x'</span></tt> or <tt class="docutils literal"><span class="pre">'y'</span></tt></span></dt>
<dd>Axis for which to check for regularity of the covariance matrix.</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="kafe.dataset.Dataset.cov_mats">
<tt class="descname">cov_mats</tt><em class="property"> = None</em><a class="headerlink" href="#kafe.dataset.Dataset.cov_mats" title="Permalink to this definition">¶</a></dt>
<dd><p>list of covariance matrices</p>
</dd></dl>

<dl class="method">
<dt id="kafe.dataset.Dataset.get_axis">
<tt class="descname">get_axis</tt><big>(</big><em>axis_alias</em><big>)</big><a class="headerlink" href="#kafe.dataset.Dataset.get_axis" title="Permalink to this definition">¶</a></dt>
<dd><p>Get axis id from an alias.</p>
<dl class="docutils">
<dt><strong>axis_alias</strong> <span class="classifier-delimiter">:</span> <span class="classifier">string or int</span></dt>
<dd>Alias of the axis whose id should be returned. This is for example
either <tt class="docutils literal"><span class="pre">'0'</span></tt> or <tt class="docutils literal"><span class="pre">'x'</span></tt> for the <cite>x</cite>-axis (id 0).</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="kafe.dataset.Dataset.get_cov_mat">
<tt class="descname">get_cov_mat</tt><big>(</big><em>axis</em>, <em>fallback_on_singular=None</em><big>)</big><a class="headerlink" href="#kafe.dataset.Dataset.get_cov_mat" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the error matrix for an axis.</p>
<dl class="docutils">
<dt><strong>axis</strong> <span class="classifier-delimiter">:</span> <span class="classifier"><tt class="docutils literal"><span class="pre">'x'</span></tt> or <tt class="docutils literal"><span class="pre">'y'</span></tt></span></dt>
<dd>Axis for which to load the error matrix.</dd>
<dt><em>fallback_on_singular</em> <span class="classifier-delimiter">:</span> <span class="classifier"><cite>numpy.matrix</cite> or string (optional)</span></dt>
<dd>What to return if the matrix is singular. If this is <tt class="docutils literal"><span class="pre">None</span></tt>
(default), the matrix is returned anyway. If this is a
<cite>numpy.matrix</cite> object or similar, that is returned istead.
Alternatively, the shortcuts <tt class="docutils literal"><span class="pre">'identity'</span></tt> or <tt class="docutils literal"><span class="pre">1</span></tt> and <tt class="docutils literal"><span class="pre">'zero'</span></tt>
or <tt class="docutils literal"><span class="pre">0</span></tt> can be used to return the identity and zero matrix
respectively.</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="kafe.dataset.Dataset.get_data">
<tt class="descname">get_data</tt><big>(</big><em>axis</em><big>)</big><a class="headerlink" href="#kafe.dataset.Dataset.get_data" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the measurement data for an axis.</p>
<dl class="docutils">
<dt><strong>axis</strong> <span class="classifier-delimiter">:</span> <span class="classifier">string</span></dt>
<dd>Axis for which to get the measurement data. Can be <tt class="docutils literal"><span class="pre">'x'</span></tt> or
<tt class="docutils literal"><span class="pre">'y'</span></tt>.</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="kafe.dataset.Dataset.get_data_span">
<tt class="descname">get_data_span</tt><big>(</big><em>axis</em>, <em>include_error_bars=False</em><big>)</big><a class="headerlink" href="#kafe.dataset.Dataset.get_data_span" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the data span for an axis. The data span is a tuple (<cite>min</cite>, <cite>max</cite>)
containing the smallest and highest coordinates for an axis.</p>
<dl class="docutils">
<dt><strong>axis</strong> <span class="classifier-delimiter">:</span> <span class="classifier"><tt class="docutils literal"><span class="pre">'x'</span></tt> or <tt class="docutils literal"><span class="pre">'y'</span></tt></span></dt>
<dd>Axis for which to get the data span.</dd>
<dt><em>include_error_bars</em> <span class="classifier-delimiter">:</span> <span class="classifier">boolean (optional)</span></dt>
<dd><tt class="docutils literal"><span class="pre">True</span></tt> if the returned span should be enlarged to
contain the error bars of the smallest and largest datapoints
(default: <tt class="docutils literal"><span class="pre">False</span></tt>)</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="kafe.dataset.Dataset.get_formatted">
<tt class="descname">get_formatted</tt><big>(</big><em>format_string='.06e'</em>, <em>delimiter='t'</em><big>)</big><a class="headerlink" href="#kafe.dataset.Dataset.get_formatted" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the dataset in a plain-text format which is human-readable and
can later be used as an input file for the creation of a new <cite>Dataset</cite>.</p>
<p id="get-formatted">The format is as follows:</p>
<div class="highlight-python"><pre># x data
x_1  sigma_x_1
x_2  sigma_x_2  cor_x_12
...  ...        ...       ...
x_N  sigma_x_N  cor_x_1N  ...  cor_x_NN

# y data
y_1  sigma_y_1
y_2  sigma_y_2  cor_y_12
...  ...        ...       ...
y_N  sigma_y_N  cor_y_1N  ...  cor_y_NN</pre>
</div>
<p>Here, the <tt class="docutils literal"><span class="pre">x_i</span></tt> and <tt class="docutils literal"><span class="pre">y_i</span></tt> represent the measurement data, the
<tt class="docutils literal"><span class="pre">sigma_?_i</span></tt> are the statistical uncertainties of each data point, and
the <tt class="docutils literal"><span class="pre">cor_?_ij</span></tt> are the correlation coefficients between the <em>i</em>-th
and <em>j</em>-th data point.</p>
<p>If the <tt class="docutils literal"><span class="pre">x</span></tt> or <tt class="docutils literal"><span class="pre">y</span></tt> errors are not correlated, then the entire
correlation coefficient matrix can be omitted. If there are no
statistical uncertainties for an axis, the second column can also be
omitted. A blank line is required at the end of each data block!</p>
<dl class="docutils">
<dt><em>format_string</em> <span class="classifier-delimiter">:</span> <span class="classifier">string (optional)</span></dt>
<dd>A format string with which each entry will be rendered. Default is
<tt class="docutils literal"><span class="pre">'.06e'</span></tt>, which means the numbers are represented in scientific
notation with six significant digits.</dd>
<dt><em>delimiter</em> <span class="classifier-delimiter">:</span> <span class="classifier">string (optional)</span></dt>
<dd>A delimiter used to separate columns in the output.</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="kafe.dataset.Dataset.get_size">
<tt class="descname">get_size</tt><big>(</big><big>)</big><a class="headerlink" href="#kafe.dataset.Dataset.get_size" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the size of the <cite>Dataset</cite>. This is equivalent to the length of the
<cite>x</cite>-axis data.</p>
</dd></dl>

<dl class="method">
<dt id="kafe.dataset.Dataset.has_correlations">
<tt class="descname">has_correlations</tt><big>(</big><em>axis</em><big>)</big><a class="headerlink" href="#kafe.dataset.Dataset.has_correlations" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns <cite>True</cite> if the specified axis has correlation data, <tt class="docutils literal"><span class="pre">False</span></tt> if
not.</p>
<dl class="docutils">
<dt><strong>axis</strong> <span class="classifier-delimiter">:</span> <span class="classifier"><tt class="docutils literal"><span class="pre">'x'</span></tt> or <tt class="docutils literal"><span class="pre">'y'</span></tt></span></dt>
<dd>Axis for which to check for correlations.</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="kafe.dataset.Dataset.has_errors">
<tt class="descname">has_errors</tt><big>(</big><em>axis</em><big>)</big><a class="headerlink" href="#kafe.dataset.Dataset.has_errors" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns <cite>True</cite> if the specified axis has statistical error data.</p>
<dl class="docutils">
<dt><strong>axis</strong> <span class="classifier-delimiter">:</span> <span class="classifier"><tt class="docutils literal"><span class="pre">'x'</span></tt> or <tt class="docutils literal"><span class="pre">'y'</span></tt></span></dt>
<dd>Axis for which to check for error data.</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="kafe.dataset.Dataset.n_axes">
<tt class="descname">n_axes</tt><em class="property"> = None</em><a class="headerlink" href="#kafe.dataset.Dataset.n_axes" title="Permalink to this definition">¶</a></dt>
<dd><p>dimensionality of the <cite>Dataset</cite>. Currently, only 2D <cite>Datasets</cite> are
supported</p>
</dd></dl>

<dl class="attribute">
<dt id="kafe.dataset.Dataset.n_datapoints">
<tt class="descname">n_datapoints</tt><em class="property"> = None</em><a class="headerlink" href="#kafe.dataset.Dataset.n_datapoints" title="Permalink to this definition">¶</a></dt>
<dd><p>number of data points in the <cite>Dataset</cite></p>
</dd></dl>

<dl class="method">
<dt id="kafe.dataset.Dataset.read_from_file">
<tt class="descname">read_from_file</tt><big>(</big><em>input_file</em><big>)</big><a class="headerlink" href="#kafe.dataset.Dataset.read_from_file" title="Permalink to this definition">¶</a></dt>
<dd><p>Reads the <cite>Dataset</cite> object from a file.</p>
<dl class="docutils">
<dt>returns <span class="classifier-delimiter">:</span> <span class="classifier">boolean</span></dt>
<dd><tt class="docutils literal"><span class="pre">True</span></tt> if the read succeeded, <tt class="docutils literal"><span class="pre">False</span></tt> if not.</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="kafe.dataset.Dataset.set_cov_mat">
<tt class="descname">set_cov_mat</tt><big>(</big><em>axis</em>, <em>mat</em><big>)</big><a class="headerlink" href="#kafe.dataset.Dataset.set_cov_mat" title="Permalink to this definition">¶</a></dt>
<dd><p>Set the error matrix for an axis.</p>
<dl class="docutils">
<dt><strong>axis</strong> <span class="classifier-delimiter">:</span> <span class="classifier"><tt class="docutils literal"><span class="pre">'x'</span></tt> or <tt class="docutils literal"><span class="pre">'y'</span></tt></span></dt>
<dd>Axis for which to load the error matrix.</dd>
<dt><strong>mat</strong> <span class="classifier-delimiter">:</span> <span class="classifier"><cite>numpy.matrix</cite> or <tt class="docutils literal"><span class="pre">None</span></tt></span></dt>
<dd>Error matrix for the axis. Passing <tt class="docutils literal"><span class="pre">None</span></tt> unsets the error
matrix.</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="kafe.dataset.Dataset.set_data">
<tt class="descname">set_data</tt><big>(</big><em>axis</em>, <em>data</em><big>)</big><a class="headerlink" href="#kafe.dataset.Dataset.set_data" title="Permalink to this definition">¶</a></dt>
<dd><p>Set the measurement data for an axis.</p>
<dl class="docutils">
<dt><strong>axis</strong> <span class="classifier-delimiter">:</span> <span class="classifier"><tt class="docutils literal"><span class="pre">'x'</span></tt> or <tt class="docutils literal"><span class="pre">'y'</span></tt></span></dt>
<dd>Axis for which to set the measurement data.</dd>
<dt><strong>data</strong> <span class="classifier-delimiter">:</span> <span class="classifier">iterable</span></dt>
<dd>Measurement data for axis.</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="kafe.dataset.Dataset.write_formatted">
<tt class="descname">write_formatted</tt><big>(</big><em>file_path</em>, <em>format_string='.06e'</em>, <em>delimiter='t'</em><big>)</big><a class="headerlink" href="#kafe.dataset.Dataset.write_formatted" title="Permalink to this definition">¶</a></dt>
<dd><p>Writes the dataset to a plain-text file. For details on the format, see
<a class="reference internal" href="#get-formatted">get_formatted</a>.</p>
<dl class="docutils">
<dt><strong>file_path</strong> <span class="classifier-delimiter">:</span> <span class="classifier">string</span></dt>
<dd>Path of the file object to write. <strong>WARNING</strong>: <em>overwrites existing
files</em>!</dd>
<dt><em>format_string</em> <span class="classifier-delimiter">:</span> <span class="classifier">string (optional)</span></dt>
<dd>A format string with which each entry will be rendered. Default is
<tt class="docutils literal"><span class="pre">'.06e'</span></tt>, which means the numbers are represented in scientific
notation with six significant digits.</dd>
<dt><em>delimiter</em> <span class="classifier-delimiter">:</span> <span class="classifier">string (optional)</span></dt>
<dd>A delimiter used to separate columns in the output.</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="kafe.dataset.build_dataset">
<tt class="descclassname">kafe.dataset.</tt><tt class="descname">build_dataset</tt><big>(</big><em>xdata</em>, <em>ydata</em>, <em>cov_mats=None</em>, <em>xabserr=0.0</em>, <em>xrelerr=0.0</em>, <em>xabscor=0.0</em>, <em>xrelcor=0.0</em>, <em>yabserr=0.0</em>, <em>yrelerr=0.0</em>, <em>yabscor=0.0</em>, <em>yrelcor=0.0</em>, <em>title=None</em>, <em>basename=None</em>, <em>axis_labels=None</em>, <em>axis_units=None</em><big>)</big><a class="headerlink" href="#kafe.dataset.build_dataset" title="Permalink to this definition">¶</a></dt>
<dd><p>This helper function creates a <cite>Dataset</cite> from a series of keyword
arguments.</p>
<p>Valid keyword arguments are:</p>
<dl class="docutils">
<dt><strong>xdata</strong> and <strong>ydata</strong> <span class="classifier-delimiter">:</span> <span class="classifier">list/tuple/<cite>np.array</cite> of floats</span></dt>
<dd>These keyword arguments are mandatory and should be iterables
containing the measurement data.</dd>
<dt><em>cov_mats</em> <span class="classifier-delimiter">:</span> <span class="classifier"><tt class="docutils literal"><span class="pre">None</span></tt> or 2-tuple (optional)</span></dt>
<dd><p class="first">This argument defaults to <tt class="docutils literal"><span class="pre">None</span></tt>, which means no covariance matrices
are used. If covariance matrices are needed, a tuple with two entries
(the first for <cite>x</cite> covariance matrices, the second for <cite>y</cite>) must be
passed.</p>
<p class="last">Each element of this tuple may be either <tt class="docutils literal"><span class="pre">None</span></tt> or a NumPy matrix
object containing a covariance matrix for the respective axis.</p>
</dd>
<dt><em>error specification keywords</em> <span class="classifier-delimiter">:</span> <span class="classifier">iterable or numeric (see below)</span></dt>
<dd><p class="first">In addition to covariance matrices, errors can be specified for each
axis (<em>x</em> or <em>y</em>) according to a simplified error model.</p>
<p>In this respect, a valid keyword is composed of an axis, an error
relativity specification (<em>abs</em> or <em>rel</em>) and error correlation type
(<em>err</em> or <em>cor</em>). The errors are then set as follows:</p>
<blockquote>
<div><ol class="arabic">
<li><dl class="first docutils">
<dt>For totally uncorrelated errors (<em>err</em>):</dt>
<dd><ul class="first last simple">
<li>if keyword argument is iterable, the error list is set to that</li>
<li>if keyword argument is a number, an error list with identical entries is generated</li>
</ul>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>For fully correlated errors (<em>cor</em>):</dt>
<dd><ul class="first last simple">
<li>keyword argument <em>must</em> be a single number. The global correlated error for the axis is then set to that.</li>
</ul>
</dd>
</dl>
</li>
</ol>
</div></blockquote>
<p>So, for example:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">myDataset</span> <span class="o">=</span> <span class="n">build_dataset</span><span class="p">(</span><span class="o">...</span><span class="p">,</span> <span class="n">yabserr</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">yrelcor</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>
</pre></div>
</div>
<p class="last">creates a Dataset with an uncorrelated error of 0.3 for each <cite>y</cite>
coordinate and a fully correlated (systematic) error of <cite>y</cite> of 0.1.</p>
</dd>
<dt><em>title</em> <span class="classifier-delimiter">:</span> <span class="classifier">string (optional)</span></dt>
<dd>The title of the <cite>Dataset</cite>.</dd>
<dt><em>basename</em> <span class="classifier-delimiter">:</span> <span class="classifier">string or <tt class="docutils literal"><span class="pre">None</span></tt> (optional)</span></dt>
<dd>A basename for the <cite>Dataset</cite>. All output files related to this dataset
will use this as a basename. If this is <tt class="docutils literal"><span class="pre">None</span></tt> (default), the
basename will be inferred from the filename.</dd>
<dt><em>axis_labels</em> <span class="classifier-delimiter">:</span> <span class="classifier">2-tuple of strings (optional)</span></dt>
<dd>a 2-tuple containing the axis labels for the <cite>Dataset</cite>. This is
relevant when plotting <cite>Fits</cite> of the <cite>Dataset</cite>, but is ignored when
plotting more than one <cite>Fit</cite> in the same <cite>Plot</cite>.</dd>
<dt><em>axis_units</em> <span class="classifier-delimiter">:</span> <span class="classifier">2-tuple of strings (optional)</span></dt>
<dd>a 2-tuple containing the axis units for the <cite>Dataset</cite>. This is
relevant when plotting <cite>Fits</cite> of the <cite>Dataset</cite>, but is ignored when
plotting more than one <cite>Fit</cite> in the same <cite>Plot</cite>.</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-kafe.file_tools">
<span id="file-tools-module"></span><h3><a class="reference internal" href="#module-file_tools" title="file_tools: This submodule provides a set of helper functions for parsing files (Unix)"><tt class="xref py py-mod docutils literal"><span class="pre">file_tools</span></tt></a> Module<a class="headerlink" href="#module-kafe.file_tools" title="Permalink to this headline">¶</a></h3>
<span class="target" id="module-file_tools"></span><dl class="function">
<dt id="kafe.file_tools.buildDataset_fromFile">
<tt class="descclassname">kafe.file_tools.</tt><tt class="descname">buildDataset_fromFile</tt><big>(</big><em>file_to_parse</em><big>)</big><a class="headerlink" href="#kafe.file_tools.buildDataset_fromFile" title="Permalink to this definition">¶</a></dt>
<dd><p>build a kafe <tt class="docutils literal"><span class="pre">Dataset</span></tt> object from input file with key words
and file format defined in <tt class="docutils literal"><span class="pre">parse_general_inputfile</span></tt></p>
<dl class="docutils">
<dt><strong>file_to_parse</strong>:  file-like object or string containing a file path</dt>
<dd>The file to parse.</dd>
<dt><strong>returns</strong> an instance of the <tt class="docutils literal"><span class="pre">Dataset</span></tt> class,</dt>
<dd>constructed with the help of the method <tt class="docutils literal"><span class="pre">Dataset.build_dataset()</span></tt></dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="kafe.file_tools.buildFit_fromFile">
<tt class="descclassname">kafe.file_tools.</tt><tt class="descname">buildFit_fromFile</tt><big>(</big><em>file_to_parse</em><big>)</big><a class="headerlink" href="#kafe.file_tools.buildFit_fromFile" title="Permalink to this definition">¶</a></dt>
<dd><p>build a kafe <tt class="docutils literal"><span class="pre">Fit</span></tt> object from input file with keywords
and file format defined in <tt class="docutils literal"><span class="pre">parse_general_input_file</span></tt></p>
<dl class="docutils">
<dt><strong>file_to_parse</strong>:  file-like object or string containing a file path</dt>
<dd>The file to parse.</dd>
<dt><strong>returns</strong> an instance of the <tt class="docutils literal"><span class="pre">Fit</span></tt> class,</dt>
<dd>constructed with the help of the methods
<tt class="docutils literal"><span class="pre">Dataset.build_dataset()</span></tt> and
<tt class="docutils literal"><span class="pre">Fit.build_fit()</span></tt></dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="kafe.file_tools.parse_column_data">
<tt class="descclassname">kafe.file_tools.</tt><tt class="descname">parse_column_data</tt><big>(</big><em>file_to_parse, field_order='x,y', delimiter=' ', cov_mat_files=None, title='Untitled Dataset', basename=None, axis_labels=['x', 'y'], axis_units=['', '']</em><big>)</big><a class="headerlink" href="#kafe.file_tools.parse_column_data" title="Permalink to this definition">¶</a></dt>
<dd><p>Parses a file which contains measurement data in a one-measurement-per-row
format. The field (column) order can be specified. It defaults to <cite>x,y&#8217;.
Valid field names are `x</cite>, <cite>y</cite>, <cite>xabserr</cite>, <cite>yabserr</cite>, <cite>xrelerr</cite>,
<cite>yrelerr</cite>. Another valid field name is <cite>ignore</cite> which can be used to skip
a field.</p>
<p>A certain type of field can appear several times. If this is the case, all
specified errors are added in quadrature:</p>
<div class="math">
<p><img src="_images/math/c4785fe5bb50d024a9b62202de2f9ab7ca1c2fc2.png" alt="\sigma_{\text{tot}} = \sqrt{{\sigma_1}^2+{\sigma_2}^2+\dots}"/></p>
</div><p>Every valid measurement data file <em>must</em> have an <cite>x</cite> and a <cite>y</cite> field.</p>
<p>For more complex error models, errors and correlations may be specified as
covariance matrices. If this is desired, then any number of covariance
matrices (stored in separate files) may be specified for an axis by
using the <cite>cov_mat_files</cite> argument.</p>
<p>Additionally, a delimiter can be specified. If this is a whitespace
character or omitted, any sequence of whitespace characters is assumed to
separate the data.</p>
<dl class="docutils">
<dt><strong>file_to_parse</strong> <span class="classifier-delimiter">:</span> <span class="classifier">file-like object or string containing a file path</span></dt>
<dd>The file to parse.</dd>
<dt><em>field_order</em> <span class="classifier-delimiter">:</span> <span class="classifier">string (optional)</span></dt>
<dd>A string of comma-separated field names giving the order of the columns
in the file. Defaults to <tt class="docutils literal"><span class="pre">'x,y'</span></tt>.</dd>
<dt><em>delimiter</em> <span class="classifier-delimiter">:</span> <span class="classifier">string (optional)</span></dt>
<dd>The field delimiter used in the file. Defaults to any whitespace.</dd>
<dt><em>cov_mat_files</em> <span class="classifier-delimiter">:</span> <span class="classifier"><em>several</em> (see below, optional)</span></dt>
<dd><p class="first">This argument defaults to <tt class="docutils literal"><span class="pre">None</span></tt>, which means no covariance matrices
are used. If covariance matrices are needed, a tuple with two entries
(the first for <cite>x</cite> covariance matrices, the second for <cite>y</cite>) must be
passed.</p>
<p>Each element of this tuple may be either <tt class="docutils literal"><span class="pre">None</span></tt>, a file or file-like
object, or an iterable containing files and file-like objects. Each
file should contain a covariance matrix for the respective axis.</p>
<p class="last">When creating the <cite>Dataset</cite>, all given matrices are summed over.</p>
</dd>
<dt><em>title</em> <span class="classifier-delimiter">:</span> <span class="classifier">string (optional)</span></dt>
<dd>The title of the <cite>Dataset</cite>.</dd>
<dt><em>basename</em> <span class="classifier-delimiter">:</span> <span class="classifier">string or <tt class="docutils literal"><span class="pre">None</span></tt> (optional)</span></dt>
<dd>A basename for the <cite>Dataset</cite>. All output files related to this dataset
will use this as a basename. If this is <tt class="docutils literal"><span class="pre">None</span></tt> (default), the
basename will be inferred from the filename.</dd>
<dt><em>axis_labels</em> <span class="classifier-delimiter">:</span> <span class="classifier">2-tuple of strings (optional)</span></dt>
<dd>a 2-tuple containing the axis labels for the <cite>Dataset</cite>. This is
relevant when plotting <cite>Fits</cite> of the <cite>Dataset</cite>, but is ignored when
plotting more than one <cite>Fit</cite> in the same <cite>Plot</cite>.</dd>
<dt><em>axis_units</em> <span class="classifier-delimiter">:</span> <span class="classifier">2-tuple of strings (optional)</span></dt>
<dd>a 2-tuple containing the axis units for the <cite>Dataset</cite>. This is
relevant when plotting <cite>Fits</cite> of the <cite>Dataset</cite>, but is ignored when
plotting more than one <cite>Fit</cite> in the same <cite>Plot</cite>.</dd>
<dt><strong>return</strong> <span class="classifier-delimiter">:</span> <span class="classifier"><cite>Dataset</cite></span></dt>
<dd>A Dataset built from the parsed file.</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="kafe.file_tools.parse_general_inputfile">
<tt class="descclassname">kafe.file_tools.</tt><tt class="descname">parse_general_inputfile</tt><big>(</big><em>file_to_parse</em><big>)</big><a class="headerlink" href="#kafe.file_tools.parse_general_inputfile" title="Permalink to this definition">¶</a></dt>
<dd><p>This function can be used to specify <cite>kafe</cite> <tt class="docutils literal"><span class="pre">Dataset</span></tt>
or <tt class="docutils literal"><span class="pre">Fit</span></tt> objects in a single input file, thus requiring
minimal Python code. Keywords as specified in a dictionary
<tt class="docutils literal"><span class="pre">tokens</span></tt> specify all objects and parameters needed by the
functions <tt class="docutils literal"><span class="pre">build_dataset()</span></tt> in  module <tt class="docutils literal"><span class="pre">dataset</span></tt> and
<tt class="docutils literal"><span class="pre">build_fit()</span></tt> in module <tt class="docutils literal"><span class="pre">fit</span></tt>.</p>
<dl class="docutils">
<dt><strong>file_to_parse</strong>:  file-like object or string containing a file path</dt>
<dd>The file to parse.</dd>
<dt><strong>return</strong> <span class="classifier-delimiter">:</span> <span class="classifier">dataset_kwargs, fit_kwargs</span></dt>
<dd>keyword lists to build a kafe <tt class="docutils literal"><span class="pre">Dataset</span></tt> or <tt class="docutils literal"><span class="pre">Fit`</span> <span class="pre">object</span>
<span class="pre">with</span> <span class="pre">the</span> <span class="pre">helper</span> <span class="pre">functions</span> <span class="pre">``build_dataset</span></tt> or <tt class="docutils literal"><span class="pre">build_fit</span></tt></dd>
</dl>
<p><em>Description of the format of the input file</em></p>
<p>The interpretation of the input data is driven by keywords.
All data following a key must be of the same kind, a block of
data ends when a new key is specified.</p>
<p>Some keys only expect a single float or string-tpye value, given
on the same line, separated by a space (<tt class="docutils literal"><span class="pre">'</span> <span class="pre">'</span></tt>):</p>
<blockquote>
<div>&lt;key&gt; &lt;value&gt;</div></blockquote>
<p>For multiple input, i.e. data, uncertainties and covariance or
correlation matrices, the format is:</p>
<blockquote>
<div><p>&lt;key&gt;
&lt;xval&gt;  &lt;xerr&gt;  [&lt;xsyst&gt;  &lt;elements of cov/cor matrix&gt;]</p>
<p>...</p>
<p>&lt;xval&gt;  &lt;xerr&gt;  [&lt;xsyst&gt;  &lt;elements of cov/cor matrix&gt;]</p>
</div></blockquote>
<p>The field separator is space (<tt class="docutils literal"><span class="pre">'</span> <span class="pre">'</span></tt>). Note that the number of input
values in each line must correspond to the specified format of the
(correlated) ucertainties.</p>
<p>The currently implemented keys are:</p>
<ul>
<li><p class="first">for metadata:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">*TITLE</span></tt>     &lt;name of the data set&gt;</li>
<li><tt class="docutils literal"><span class="pre">*BASENAME</span></tt>  &lt;name from which output file names are derived&gt;</li>
<li><tt class="docutils literal"><span class="pre">*xLabel</span></tt>    &lt;x axis label&gt;</li>
<li><tt class="docutils literal"><span class="pre">*yLabel</span></tt>    &lt;y axis label&gt;</li>
<li><tt class="docutils literal"><span class="pre">xUnit</span></tt>      &lt;x axis unit&gt;</li>
<li><tt class="docutils literal"><span class="pre">yUnit</span></tt>      &lt;y axis unit&gt;</li>
</ul>
</li>
<li><p class="first">for input data:</p>
<ul>
<li><dl class="first docutils">
<dt><tt class="docutils literal"><span class="pre">*xData</span></tt>     <cite>x data and, optionally, uncertainties</cite></dt>
<dd><dl class="first last docutils">
<dt>&lt;xval&gt;  [&lt;x-uncert.&gt;]</dt>
<dd><p class="first last">...</p>
</dd>
</dl>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt><tt class="docutils literal"><span class="pre">*yData</span></tt>     <cite>y data and uncertainties</cite></dt>
<dd><dl class="first last docutils">
<dt>&lt;yval&gt;  &lt;y uncert.&gt;</dt>
<dd><p class="first last">...</p>
</dd>
</dl>
</dd>
</dl>
</li>
</ul>
</li>
<li><p class="first"><cite>x</cite> or <cite>y</cite> data, independent and correlated uncertainties and elements of
correlation matrix, given as as a lower triangular matrix with no diagonal:</p>
<ul>
<li><p class="first"><tt class="docutils literal"><span class="pre">*xData_COR</span></tt></p>
</li>
<li><dl class="first docutils">
<dt><tt class="docutils literal"><span class="pre">*yData_COR</span></tt></dt>
<dd><dl class="first last docutils">
<dt>&lt;x/y val&gt;  &lt;indep. x/y uncert.&gt;  &lt;x/y syst&gt;  &lt;elements of cor matrix&gt;</dt>
<dd><p class="first last">...</p>
</dd>
</dl>
</dd>
</dl>
</li>
</ul>
</li>
<li><p class="first"><cite>x</cite> or <cite>y</cite> data, independent and correlated uncertainties and sqrt of
elements of covariance matrix, given as as a lower triangular matrix
with no diagonal:</p>
<ul>
<li><p class="first"><tt class="docutils literal"><span class="pre">*xData_SCOV</span></tt></p>
</li>
<li><dl class="first docutils">
<dt><tt class="docutils literal"><span class="pre">*yData_SCOV</span></tt></dt>
<dd><dl class="first last docutils">
<dt>&lt;x/y val&gt;  &lt;idep. x/y uncert.&gt;  &lt;x/y syst&gt;  &lt;sqrt of elements of cov matrix&gt;</dt>
<dd><p class="first last">...</p>
</dd>
</dl>
</dd>
</dl>
</li>
</ul>
</li>
<li><p class="first"><cite>x</cite> or <cite>y</cite> data, independent uncertainties and full covariance matrix (note
that the correlated uncertainties are contained in the diagonal of the
matrix in this case, i.e. the field &lt;xsyst&gt; is to be omitted):</p>
<ul>
<li><p class="first"><tt class="docutils literal"><span class="pre">*xData_COV</span></tt></p>
</li>
<li><dl class="first docutils">
<dt><tt class="docutils literal"><span class="pre">*yData_COV</span></tt></dt>
<dd><dl class="first last docutils">
<dt>&lt;x/y val&gt;  &lt;indep. x/y ucert.&gt;  &lt;elements of cov matrix&gt;</dt>
<dd><p class="first last">...</p>
</dd>
</dl>
</dd>
</dl>
</li>
</ul>
</li>
<li><p class="first">Additional keys allow to specify correlated absolute or relative
uncertainties:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">*xAbsCOR</span> <span class="pre">&lt;common</span> <span class="pre">abs.</span> <span class="pre">x</span> <span class="pre">uncert.&gt;</span></tt></li>
<li><tt class="docutils literal"><span class="pre">*yAbsCOR</span> <span class="pre">&lt;common</span> <span class="pre">abs.</span> <span class="pre">y</span> <span class="pre">uncert.&gt;</span></tt></li>
<li><tt class="docutils literal"><span class="pre">*xRelCor</span> <span class="pre">&lt;common</span> <span class="pre">rel.</span> <span class="pre">x</span> <span class="pre">uncert.&gt;</span></tt></li>
<li><tt class="docutils literal"><span class="pre">*yRelCor</span> <span class="pre">&lt;common</span> <span class="pre">rel.</span> <span class="pre">y</span> <span class="pre">uncert.&gt;</span></tt></li>
</ul>
</li>
<li><p class="first">To specify the fit function, the defined keywords are:</p>
<ul>
<li><p class="first"><tt class="docutils literal"><span class="pre">*FitFunction</span></tt>  followed by python code (note: blanks for line
indent must be replaced by &#8216;~&#8217;):</p>
<div class="highlight-python"><pre>def fitf(x, ...):
~~~~...
~~~~return ...</pre>
</div>
<p>The name <cite>fitf</cite> is mandatory. The kafe decorator functions
<tt class="docutils literal"><span class="pre">&#64;ASCII</span></tt>, <tt class="docutils literal"><span class="pre">&#64;LATEX</span></tt> and <tt class="docutils literal"><span class="pre">&#64;FitFunction</span></tt>
are suppoted.</p>
</li>
<li><p class="first"><tt class="docutils literal"><span class="pre">*FITLABEL</span></tt> &lt;the name for the fit&gt;</p>
</li>
<li><p class="first"><tt class="docutils literal"><span class="pre">*InitialParameters</span></tt> -  followed by two columns of float values
for the initial values of the parameters and their range, one line
per fit parameter is mandatory</p>
<blockquote>
<div><p>&lt;initial value&gt;  &lt;range&gt;</p>
</div></blockquote>
</li>
</ul>
</li>
<li><p class="first">Model parameters can be constrained within their uncertainties, if prior
knowledge on the value(s) and uncertainty(ies) of parameters are
to be accounted for in the fit. This option is specified via the
keyword:</p>
<ul>
<li><p class="first"><tt class="docutils literal"><span class="pre">*ConstrainedParameters</span></tt> followed by one or more lines with
the fields</p>
<blockquote>
<div><p>&lt;parameter name&gt;  &lt;parameter value&gt;  &lt;parameter uncert.&gt;,</p>
</div></blockquote>
<p>where <cite>parameter name</cite> is the name of the parameter in the fit
function specification.</p>
</li>
</ul>
</li>
</ul>
<p>Here is an example of an input file to calculate the average
of correlated measurements:</p>
<div class="highlight-python"><pre>#  Meta data for plotting
*TITLE Higgs-mass measurements
*xLabel number of measurement
*yLabel $m_\mathrm{H}$
*yUnit GeV/$c^2$

#*xData  # commented out, as not needed for simple average

*yData_SCOV  # assume that minimum of syst. errors is a common error
# mH      err     syst as sqrt(cov)
124.51   0.52    0.06
125.60   0.40    0.20  0.06
125.98   0.42    0.28  0.   0.
124.70   0.31    0.15  0.   0.  0.15

# set Python code of fit function
### there are some restrictions:
##     function name must be 'fitf'
##     blanks must be replaced by '~'
#  kafe fit function decorators are supported
*FitFunction
@ASCII(expression='av')
@LaTeX(name='f', parameter_names=('av'), expression='av')
@FitFunction
def fitf(x,av=1.): # fit an average
~~~~return av
*FITLABEL Average
*InitialParameters
120. 1.</pre>
</div>
</dd></dl>

</div>
<div class="section" id="module-kafe.fit">
<span id="fit-module"></span><h3><a class="reference internal" href="#module-fit" title="fit: This submodule defines a `Fit` object which performs the actual fitting given a `Dataset` and a fit function. (Unix)"><tt class="xref py py-mod docutils literal"><span class="pre">fit</span></tt></a> Module<a class="headerlink" href="#module-kafe.fit" title="Permalink to this headline">¶</a></h3>
<span class="target" id="module-fit"></span><dl class="class">
<dt id="kafe.fit.Fit">
<em class="property">class </em><tt class="descclassname">kafe.fit.</tt><tt class="descname">Fit</tt><big>(</big><em>dataset</em>, <em>fit_function</em>, <em>external_fcn=&lt;function chi2 at 0x4001848&gt;</em>, <em>fit_label=None</em><big>)</big><a class="headerlink" href="#kafe.fit.Fit" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <tt class="xref py py-class docutils literal"><span class="pre">object</span></tt></p>
<p>Object representing a fit. This object references the fitted <cite>Dataset</cite>,
the fit function and the resulting fit parameters.</p>
<p>Necessary arguments are a <cite>Dataset</cite> object and a fit function (which should
be fitted to the <cite>Dataset</cite>). Optionally, an external function <cite>FCN</cite> (the
minimum of which should be located to find the best fit) can be specified.
If not given, the <cite>FCN</cite> function defaults to <img class="math" src="_images/math/a61c1e51680e27d35d05bebed87d474972fc70bd.png" alt="\chi^2"/>.</p>
<dl class="docutils">
<dt><strong>dataset</strong> <span class="classifier-delimiter">:</span> <span class="classifier"><cite>Dataset</cite></span></dt>
<dd>A <cite>Dataset</cite> object containing all information about the data</dd>
<dt><strong>fit_function</strong> <span class="classifier-delimiter">:</span> <span class="classifier">function</span></dt>
<dd><p class="first">A user-defined Python function to be fitted to the data. This
function&#8217;s first argument must be the independent variable <cite>x</cite>. All
other arguments <em>must</em> be named and have default values given. These
defaults are used as a starting point for the actual minimization. For
example, a simple linear function would be defined like:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">linear_2par</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">slope</span><span class="o">=</span><span class="mf">1.</span><span class="p">,</span> <span class="n">y_intercept</span><span class="o">=</span><span class="mf">0.</span><span class="p">):</span>
<span class="gp">... </span>    <span class="k">return</span> <span class="n">slope</span> <span class="o">*</span> <span class="n">x</span> <span class="o">+</span> <span class="n">y_intercept</span>
</pre></div>
</div>
<p class="last">Be aware that choosing sensible initial values for the parameters is
often crucial for a succesful fit, particularly for functions of many
parameters.</p>
</dd>
<dt><em>external_fcn</em> <span class="classifier-delimiter">:</span> <span class="classifier">function (optional)</span></dt>
<dd><p class="first">An external <cite>FCN</cite> (function to minimize). This function must have the
following call signature:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">FCN</span><span class="p">(</span><span class="n">xdata</span><span class="p">,</span> <span class="n">ydata</span><span class="p">,</span> <span class="n">cov_mat</span><span class="p">,</span> <span class="n">fit_function</span><span class="p">,</span> <span class="n">parameter_values</span><span class="p">)</span>
</pre></div>
</div>
<p class="last">It should return a float. If not specified, the default <img class="math" src="_images/math/a61c1e51680e27d35d05bebed87d474972fc70bd.png" alt="\chi^2"/>
<cite>FCN</cite> is used. This should be sufficient for most fits.</p>
</dd>
<dt><em>fit_label</em> <span class="classifier-delimiter">:</span> <span class="classifier"><img class="math" src="_images/math/ba0b91b5dd1bb1d4e59e6943e2a422e44cd39474.png" alt="LaTeX"/>-formatted string (optional)</span></dt>
<dd>A name/label/short description of the fit function. This appears in the
legend describing the fitter curve. If omitted, this defaults to the
fit function&#8217;s <img class="math" src="_images/math/ba0b91b5dd1bb1d4e59e6943e2a422e44cd39474.png" alt="LaTeX"/> expression.</dd>
</dl>
<dl class="method">
<dt id="kafe.fit.Fit.call_external_fcn">
<tt class="descname">call_external_fcn</tt><big>(</big><em>*parameter_values</em><big>)</big><a class="headerlink" href="#kafe.fit.Fit.call_external_fcn" title="Permalink to this definition">¶</a></dt>
<dd><p>Wrapper for the external <cite>FCN</cite>. Since the actual fit process depends on
finding the right parameter values and keeping everything else constant
we can use the <cite>Dataset</cite> object to pass known, fixed information to the
external <cite>FCN</cite>, varying only the parameter values.</p>
<dl class="docutils">
<dt><strong>parameter_values</strong> <span class="classifier-delimiter">:</span> <span class="classifier">sequence of values</span></dt>
<dd>the parameter values at which <cite>FCN</cite> is to be evaluated</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="kafe.fit.Fit.call_minimizer">
<tt class="descname">call_minimizer</tt><big>(</big><em>final_fit=True</em>, <em>verbose=False</em><big>)</big><a class="headerlink" href="#kafe.fit.Fit.call_minimizer" title="Permalink to this definition">¶</a></dt>
<dd><p>Instructs the minimizer to do a minimization.</p>
</dd></dl>

<dl class="method">
<dt id="kafe.fit.Fit.constrain_parameters">
<tt class="descname">constrain_parameters</tt><big>(</big><em>parameters</em>, <em>parvals</em>, <em>parerrs</em><big>)</big><a class="headerlink" href="#kafe.fit.Fit.constrain_parameters" title="Permalink to this definition">¶</a></dt>
<dd><p>Constrain the parameter with the given name to <img class="math" src="_images/math/b3349c9547c99a477aa780571f322f9fb862a172.png" alt="c\pm\sigma"/>.</p>
<p>This is achieved by adding an appropriate <cite>penalty term</cite> to the <img class="math" src="_images/math/a61c1e51680e27d35d05bebed87d474972fc70bd.png" alt="\chi^2"/>
function, see function <tt class="docutils literal"><span class="pre">chi2</span></tt>.</p>
<blockquote>
<div><p><strong>parameters</strong> list of paramter id&#8217;s or names to constrain</p>
<p><strong>parvals</strong>    list of parameter values</p>
<p><strong>parerrs</strong>    list of errors on parameters</p>
</div></blockquote>
</dd></dl>

<dl class="attribute">
<dt id="kafe.fit.Fit.current_cov_mat">
<tt class="descname">current_cov_mat</tt><em class="property"> = None</em><a class="headerlink" href="#kafe.fit.Fit.current_cov_mat" title="Permalink to this definition">¶</a></dt>
<dd><p>the current covariance matrix used for the <cite>Fit</cite></p>
</dd></dl>

<dl class="attribute">
<dt id="kafe.fit.Fit.dataset">
<tt class="descname">dataset</tt><em class="property"> = None</em><a class="headerlink" href="#kafe.fit.Fit.dataset" title="Permalink to this definition">¶</a></dt>
<dd><p>this Fit instance&#8217;s child <cite>Dataset</cite></p>
</dd></dl>

<dl class="method">
<dt id="kafe.fit.Fit.do_fit">
<tt class="descname">do_fit</tt><big>(</big><em>quiet=False</em>, <em>verbose=False</em><big>)</big><a class="headerlink" href="#kafe.fit.Fit.do_fit" title="Permalink to this definition">¶</a></dt>
<dd><p>Runs the fit algorithm for this <cite>Fit</cite> object.</p>
<p>First, the <cite>Dataset</cite> is fitted considering only uncertainties in the
<cite>y</cite> direction. If the <cite>Dataset</cite> has no uncertainties in the <cite>y</cite>
direction, they are assumed to be equal to 1.0 for this preliminary
fit, as there is no better information available.</p>
<p>Next, the fit errors in the <cite>x</cite> direction (if they exist) are taken
into account by projecting the covariance matrix for the <cite>x</cite> errors
onto the <cite>y</cite> covariance matrix. This is done by taking the first
derivative of the fit function in each point and &#8220;projecting&#8221; the <cite>x</cite>
error onto the resulting tangent to the curve.</p>
<p>This last step is repeated until the change in the error matrix caused
by the projection becomes negligible.</p>
<dl class="docutils">
<dt><em>quiet</em> <span class="classifier-delimiter">:</span> <span class="classifier">boolean (optional)</span></dt>
<dd>Set to <tt class="docutils literal"><span class="pre">True</span></tt> if no output should be printed.</dd>
<dt><em>verbose</em> <span class="classifier-delimiter">:</span> <span class="classifier">boolean (optional)</span></dt>
<dd>Set to <tt class="docutils literal"><span class="pre">True</span></tt> if more output should be printed.</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="kafe.fit.Fit.external_fcn">
<tt class="descname">external_fcn</tt><em class="property"> = None</em><a class="headerlink" href="#kafe.fit.Fit.external_fcn" title="Permalink to this definition">¶</a></dt>
<dd><p>the (external) function to be minimized for this <cite>Fit</cite></p>
</dd></dl>

<dl class="attribute">
<dt id="kafe.fit.Fit.fit_function">
<tt class="descname">fit_function</tt><em class="property"> = None</em><a class="headerlink" href="#kafe.fit.Fit.fit_function" title="Permalink to this definition">¶</a></dt>
<dd><p>the fit function used for this <cite>Fit</cite></p>
</dd></dl>

<dl class="method">
<dt id="kafe.fit.Fit.fix_parameters">
<tt class="descname">fix_parameters</tt><big>(</big><em>*parameters_to_fix</em><big>)</big><a class="headerlink" href="#kafe.fit.Fit.fix_parameters" title="Permalink to this definition">¶</a></dt>
<dd><p>Fix the given parameters so that the minimizer works without them
when <cite>do_fit</cite> is called next. Parameters can be given by their names
or by their IDs.</p>
</dd></dl>

<dl class="method">
<dt id="kafe.fit.Fit.get_current_fit_function">
<tt class="descname">get_current_fit_function</tt><big>(</big><big>)</big><a class="headerlink" href="#kafe.fit.Fit.get_current_fit_function" title="Permalink to this definition">¶</a></dt>
<dd><p>This method returns a function object corresponding to the fit function
for the current parameter values. The returned function is a function
of a single variable.</p>
<dl class="docutils">
<dt>returns <span class="classifier-delimiter">:</span> <span class="classifier">function</span></dt>
<dd>A function of a single variable corresponding to the fit function
at the current parameter values.</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="kafe.fit.Fit.get_error_matrix">
<tt class="descname">get_error_matrix</tt><big>(</big><big>)</big><a class="headerlink" href="#kafe.fit.Fit.get_error_matrix" title="Permalink to this definition">¶</a></dt>
<dd><p>This method returns the covariance matrix of the fit parameters which
is obtained by querying the minimizer object for this <cite>Fit</cite></p>
<dl class="docutils">
<dt>returns <span class="classifier-delimiter">:</span> <span class="classifier"><cite>numpy.matrix</cite></span></dt>
<dd>The covariance matrix of the parameters.</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="kafe.fit.Fit.get_function_error">
<tt class="descname">get_function_error</tt><big>(</big><em>x</em><big>)</big><a class="headerlink" href="#kafe.fit.Fit.get_function_error" title="Permalink to this definition">¶</a></dt>
<dd><p>This method uses the parameter error matrix of the fit to calculate
a symmetric (parabolic) error on the function value itself. Note that
this method takes the entire parameter error matrix into account, so
that it also accounts for correlations.</p>
<p>The method is useful if, e.g., you want to draw a confidence band
around the function in your plot routine.</p>
<dl class="docutils">
<dt><strong>x</strong> <span class="classifier-delimiter">:</span> <span class="classifier"><cite>float</cite> or sequence of <cite>float</cite></span></dt>
<dd>the values at which the function error is to be estimated</dd>
<dt>returns <span class="classifier-delimiter">:</span> <span class="classifier"><cite>float</cite> or sequence of <cite>float</cite></span></dt>
<dd>the estimated error at the given point(s)</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="kafe.fit.Fit.get_parameter_errors">
<tt class="descname">get_parameter_errors</tt><big>(</big><em>rounding=False</em><big>)</big><a class="headerlink" href="#kafe.fit.Fit.get_parameter_errors" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the current parameter uncertainties from the minimizer.</p>
<dl class="docutils">
<dt><em>rounding</em> <span class="classifier-delimiter">:</span> <span class="classifier">boolean (optional)</span></dt>
<dd>Whether or not to round the returned values to significance.</dd>
<dt>returns <span class="classifier-delimiter">:</span> <span class="classifier">tuple</span></dt>
<dd>A tuple of the parameter uncertainties</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="kafe.fit.Fit.get_parameter_values">
<tt class="descname">get_parameter_values</tt><big>(</big><em>rounding=False</em><big>)</big><a class="headerlink" href="#kafe.fit.Fit.get_parameter_values" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the current parameter values from the minimizer.</p>
<dl class="docutils">
<dt><em>rounding</em> <span class="classifier-delimiter">:</span> <span class="classifier">boolean (optional)</span></dt>
<dd>Whether or not to round the returned values to significance.</dd>
<dt>returns <span class="classifier-delimiter">:</span> <span class="classifier">tuple</span></dt>
<dd>A tuple of the parameter values</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="kafe.fit.Fit.latex_parameter_names">
<tt class="descname">latex_parameter_names</tt><em class="property"> = None</em><a class="headerlink" href="#kafe.fit.Fit.latex_parameter_names" title="Permalink to this definition">¶</a></dt>
<dd><p><img class="math" src="_images/math/ba0b91b5dd1bb1d4e59e6943e2a422e44cd39474.png" alt="LaTeX"/> parameter names</p>
</dd></dl>

<dl class="attribute">
<dt id="kafe.fit.Fit.minimizer">
<tt class="descname">minimizer</tt><em class="property"> = None</em><a class="headerlink" href="#kafe.fit.Fit.minimizer" title="Permalink to this definition">¶</a></dt>
<dd><p>this <cite>Fit</cite>&#8216;s minimizer (<cite>Minuit</cite>)</p>
</dd></dl>

<dl class="attribute">
<dt id="kafe.fit.Fit.number_of_parameters">
<tt class="descname">number_of_parameters</tt><em class="property"> = None</em><a class="headerlink" href="#kafe.fit.Fit.number_of_parameters" title="Permalink to this definition">¶</a></dt>
<dd><p>the total number of parameters</p>
</dd></dl>

<dl class="attribute">
<dt id="kafe.fit.Fit.parameter_names">
<tt class="descname">parameter_names</tt><em class="property"> = None</em><a class="headerlink" href="#kafe.fit.Fit.parameter_names" title="Permalink to this definition">¶</a></dt>
<dd><p>the names of the parameters</p>
</dd></dl>

<dl class="method">
<dt id="kafe.fit.Fit.print_fit_details">
<tt class="descname">print_fit_details</tt><big>(</big><big>)</big><a class="headerlink" href="#kafe.fit.Fit.print_fit_details" title="Permalink to this definition">¶</a></dt>
<dd><p>prints some fit goodness details</p>
</dd></dl>

<dl class="method">
<dt id="kafe.fit.Fit.print_fit_results">
<tt class="descname">print_fit_results</tt><big>(</big><big>)</big><a class="headerlink" href="#kafe.fit.Fit.print_fit_results" title="Permalink to this definition">¶</a></dt>
<dd><p>prints fit results</p>
</dd></dl>

<dl class="method">
<dt id="kafe.fit.Fit.print_rounded_fit_parameters">
<tt class="descname">print_rounded_fit_parameters</tt><big>(</big><big>)</big><a class="headerlink" href="#kafe.fit.Fit.print_rounded_fit_parameters" title="Permalink to this definition">¶</a></dt>
<dd><p>prints the fit parameters</p>
</dd></dl>

<dl class="method">
<dt id="kafe.fit.Fit.project_x_covariance_matrix">
<tt class="descname">project_x_covariance_matrix</tt><big>(</big><big>)</big><a class="headerlink" href="#kafe.fit.Fit.project_x_covariance_matrix" title="Permalink to this definition">¶</a></dt>
<dd><p>Project elements of the <cite>x</cite> covariance matrix onto the total
matrix.</p>
<p>This is done element-wise, according to the formula:</p>
<div class="math">
<p><img src="_images/math/412341c40790dfb507bb2731e41331a074965162.png" alt="C_{\text{tot}, ij} = C_{y, ij} + C_{x, ij}
\frac{\partial f}{\partial x_i}  \frac{\partial f}{\partial x_j}"/></p>
</div></dd></dl>

<dl class="method">
<dt id="kafe.fit.Fit.release_parameters">
<tt class="descname">release_parameters</tt><big>(</big><em>*parameters_to_release</em><big>)</big><a class="headerlink" href="#kafe.fit.Fit.release_parameters" title="Permalink to this definition">¶</a></dt>
<dd><p>Release the given parameters so that the minimizer begins to work with
them when <cite>do_fit</cite> is called next. Parameters can be given by their
names or by their IDs. If no arguments are provied, then release all
parameters.</p>
</dd></dl>

<dl class="method">
<dt id="kafe.fit.Fit.set_parameters">
<tt class="descname">set_parameters</tt><big>(</big><em>*args</em>, <em>**kwargs</em><big>)</big><a class="headerlink" href="#kafe.fit.Fit.set_parameters" title="Permalink to this definition">¶</a></dt>
<dd><p>Sets the parameter values (and optionally errors) for this fit.
This is usually called just before the fit is done, to establish
the initial parameters. If a parameter error is omitted, it is
set to 1/1000th of the parameter values themselves. If the default
value of the parameter is 0, it is set, by exception, to 0.001.</p>
<p>This method accepts up to two positional arguments and several
keyword arguments.</p>
<dl class="docutils">
<dt><em>args[0]</em> <span class="classifier-delimiter">:</span> <span class="classifier">tuple/list of floats (optional)</span></dt>
<dd>The first positional argument is expected to be
a tuple/list containing the parameter values.</dd>
<dt><em>args[1]</em> <span class="classifier-delimiter">:</span> <span class="classifier">tuple/list of floats (optional)</span></dt>
<dd>The second positional argument is expected to be a
tuple/list of parameter errors, which can also be set as an
approximate estimate of the problem&#8217;s uncertainty.</dd>
<dt><em>no_warning</em> <span class="classifier-delimiter">:</span> <span class="classifier">boolean (optional)</span></dt>
<dd>Whether to issue warnings (<tt class="docutils literal"><span class="pre">False</span></tt>) or not (<tt class="docutils literal"><span class="pre">True</span></tt>) when
communicating with the minimizer fails. Defaults to <tt class="docutils literal"><span class="pre">False</span></tt>.</dd>
</dl>
<p>Valid keyword argument names are parameter names. The keyword arguments
themselves may be floats (parameter values) or 2-tuples containing the
parameter values and the parameter error in that order:</p>
<dl class="docutils">
<dt><em>&lt;parameter_name&gt;</em> <span class="classifier-delimiter">:</span> <span class="classifier">float or 2-tuple of floats (optional)</span></dt>
<dd>Set the parameter with the name &lt;&#8217;parameter_name&#8217;&gt; to the value
given. If a 2-tuple is given, the first element is understood
to be the value and the second to be the parameter error.</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="kafe.fit.Fit.xdata">
<tt class="descname">xdata</tt><em class="property"> = None</em><a class="headerlink" href="#kafe.fit.Fit.xdata" title="Permalink to this definition">¶</a></dt>
<dd><p>the <cite>x</cite> coordinates of the data points used for this <cite>Fit</cite></p>
</dd></dl>

<dl class="attribute">
<dt id="kafe.fit.Fit.ydata">
<tt class="descname">ydata</tt><em class="property"> = None</em><a class="headerlink" href="#kafe.fit.Fit.ydata" title="Permalink to this definition">¶</a></dt>
<dd><p>the <cite>y</cite> coordinates of the data points used for this <cite>Fit</cite></p>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="kafe.fit.build_fit">
<tt class="descclassname">kafe.fit.</tt><tt class="descname">build_fit</tt><big>(</big><em>dataset</em>, <em>fitfunc</em>, <em>fitlabel='untitled'</em>, <em>initial_fit_parameters=None</em>, <em>constrained_parameters=None</em><big>)</big><a class="headerlink" href="#kafe.fit.build_fit" title="Permalink to this definition">¶</a></dt>
<dd><p>This helper fuction creates a <tt class="docutils literal"><span class="pre">Fit</span></tt> from a series of keyword arguments.</p>
<p>Valid keywords are:</p>
<p><strong>dataset</strong> : a <cite>kafe</cite> <tt class="docutils literal"><span class="pre">Dataset</span></tt></p>
<dl class="docutils">
<dt><strong>fitfunc</strong> <span class="classifier-delimiter">:</span> <span class="classifier">a python function, eventually with</span></dt>
<dd><tt class="docutils literal"><span class="pre">&#64;FitFunction</span></tt>, <tt class="docutils literal"><span class="pre">&#64;LATEX</span></tt> and <tt class="docutils literal"><span class="pre">&#64;FitFunction</span></tt> decorators</dd>
</dl>
<p><strong>fitlabel</strong> : name for this fit</p>
<dl class="docutils">
<dt><strong>fitparameters</strong> <span class="classifier-delimiter">:</span> <span class="classifier">None or 2-tuple of list, tuple/<cite>np.array</cite> of floats</span></dt>
<dd>specifying initial parameter values and errors</dd>
<dt><strong>constrained_parameters</strong>: None or 3-tuple of list, tuple/np.array`</dt>
<dd>of one string and 2 floats specifiying the names, values and
uncertainties of constraints to apply to model parameters</dd>
</dl>
<p><strong>returns</strong> <cite>Fit</cite> object</p>
</dd></dl>

<dl class="function">
<dt id="kafe.fit.chi2">
<tt class="descclassname">kafe.fit.</tt><tt class="descname">chi2</tt><big>(</big><em>xdata</em>, <em>ydata</em>, <em>cov_mat</em>, <em>fit_function</em>, <em>parameter_values</em>, <em>constrained_parameters=None</em><big>)</big><a class="headerlink" href="#kafe.fit.chi2" title="Permalink to this definition">¶</a></dt>
<dd><p>The <img class="math" src="_images/math/a61c1e51680e27d35d05bebed87d474972fc70bd.png" alt="\chi^2"/> implementation. Calculates <img class="math" src="_images/math/a61c1e51680e27d35d05bebed87d474972fc70bd.png" alt="\chi^2"/> according
to the formula:</p>
<div class="math">
<p><img src="_images/math/f8c456962536a9bcf2afe8e93d06249c2e0924da.png" alt="\chi^2 = \lambda^T C^{-1} \lambda"/></p>
</div><p>Here, <img class="math" src="_images/math/ce4588fd900d02afcbd260bc07f54cce49a7dc4a.png" alt="\lambda"/> is the residual vector <img class="math" src="_images/math/b4a9f878bd30b7d5b83cca751a92a2675e72201a.png" alt="\lambda = \vec{y} -
\vec{f}(\vec{x})"/> and <img class="math" src="_images/math/c3355896da590fc491a10150a50416687626d7cc.png" alt="C"/> is the covariance matrix.</p>
<p>If a constraint <img class="math" src="_images/math/ce91fa21da4f2ba0b6673e880bcfc0fba37f0c85.png" alt="c_i\pm\sigma_i"/> is applied to  a parameter i,
a <cite>penalty term</cite> is added for each constrained parameter according to:</p>
<div class="math">
<p><img src="_images/math/6bffc8258500ff710f1ed6d7511004475de7088d.png" alt="\chi^2 += \left( \frac{v_i - c_i}{\sigma_i} \right)^2"/></p>
</div><dl class="docutils">
<dt><strong>xdata</strong> <span class="classifier-delimiter">:</span> <span class="classifier">iterable</span></dt>
<dd>The <em>x</em> measurement data</dd>
<dt><strong>ydata</strong> <span class="classifier-delimiter">:</span> <span class="classifier">iterable</span></dt>
<dd>The <em>y</em> measurement data</dd>
<dt><strong>cov_mat</strong> <span class="classifier-delimiter">:</span> <span class="classifier"><cite>numpy.matrix</cite></span></dt>
<dd>The total covariance matrix</dd>
<dt><strong>fit_function</strong> <span class="classifier-delimiter">:</span> <span class="classifier">function</span></dt>
<dd>The fit function <img class="math" src="_images/math/c96dd6ec1dc4ad7520fbdc78fcdbec9edd068d0c.png" alt="f(x)"/></dd>
</dl>
<p><strong>constrained_parameters</strong> : None or list of two iterables
with a length equal to the number of parameters. An uncertainty of
0 means that a parameter remains unconstrained.</p>
<dl class="docutils">
<dt><strong>parameter_values</strong> <span class="classifier-delimiter">:</span> <span class="classifier">list/tuple</span></dt>
<dd>The values of the parameters at which <img class="math" src="_images/math/c96dd6ec1dc4ad7520fbdc78fcdbec9edd068d0c.png" alt="f(x)"/> should be evaluated.</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="kafe.fit.round_to_significance">
<tt class="descclassname">kafe.fit.</tt><tt class="descname">round_to_significance</tt><big>(</big><em>value</em>, <em>error</em>, <em>significance=2</em><big>)</big><a class="headerlink" href="#kafe.fit.round_to_significance" title="Permalink to this definition">¶</a></dt>
<dd><p>Rounds the error to the established number of significant digits, then
rounds the value to the same order of magnitude as the error.</p>
<dl class="docutils">
<dt><strong>value</strong> <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd>value to round to significance</dd>
<dt><strong>error</strong> <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd>uncertainty of the value</dd>
<dt><em>significance</em> <span class="classifier-delimiter">:</span> <span class="classifier">int (optional)</span></dt>
<dd>number of significant digits of the error to consider</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-kafe.function_library">
<span id="function-library-module"></span><h3><a class="reference internal" href="#module-function_library" title="function_library: A submodule containing a collection of model functions. (Unix)"><tt class="xref py py-mod docutils literal"><span class="pre">function_library</span></tt></a> Module<a class="headerlink" href="#module-kafe.function_library" title="Permalink to this headline">¶</a></h3>
<span class="target" id="module-function_library"></span><p>Collection of model functions</p>
</div>
<div class="section" id="module-kafe.function_tools">
<span id="function-tools-module"></span><h3><a class="reference internal" href="#module-function_tools" title="function_tools: This submodule contains several useful tools for getting information about a function, including the number, names and default values of its parameters and its derivatives with respect to the  independent variable or the parameters. (Unix)"><tt class="xref py py-mod docutils literal"><span class="pre">function_tools</span></tt></a> Module<a class="headerlink" href="#module-kafe.function_tools" title="Permalink to this headline">¶</a></h3>
<span class="target" id="module-function_tools"></span><dl class="function">
<dt id="kafe.function_tools.ASCII">
<tt class="descclassname">kafe.function_tools.</tt><tt class="descname">ASCII</tt><big>(</big><em>**kwargs</em><big>)</big><a class="headerlink" href="#kafe.function_tools.ASCII" title="Permalink to this definition">¶</a></dt>
<dd><p>Optional decorator for fit functions. This overrides a FitFunction&#8217;s
plain-text (ASCII) attributes. The new values for these attributes must be
passed as keyword arguments to the decorator. Possible arguments:</p>
<dl class="docutils">
<dt><em>name</em> <span class="classifier-delimiter">:</span> <span class="classifier">string</span></dt>
<dd>Plain-text representation of the function name.</dd>
<dt><em>parameter_names</em> <span class="classifier-delimiter">:</span> <span class="classifier">list of strings</span></dt>
<dd>List of plain-text representations of the function&#8217;s arguments.
The length of this list must be equal to the function&#8217;s argument
number. The argument names should be in the same order as in the
function definition.</dd>
<dt><em>x_name</em> <span class="classifier-delimiter">:</span> <span class="classifier">string</span></dt>
<dd>Plain-text representation of the independent variable&#8217;s name.</dd>
<dt><em>expression</em> <span class="classifier-delimiter">:</span> <span class="classifier">string</span></dt>
<dd>Plain-text-formatted expression representing the
function&#8217;s formula.</dd>
</dl>
</dd></dl>

<dl class="class">
<dt id="kafe.function_tools.FitFunction">
<em class="property">class </em><tt class="descclassname">kafe.function_tools.</tt><tt class="descname">FitFunction</tt><big>(</big><em>f</em><big>)</big><a class="headerlink" href="#kafe.function_tools.FitFunction" title="Permalink to this definition">¶</a></dt>
<dd><p>Decorator class for fit functions. If a function definition is decorated
using this class, some information is collected about the function which
is relevant to the fitting process, such as the number of parameters, 
their names and default values. Some details pertaining to display and
representation are also set, such as <img class="math" src="_images/math/ba0b91b5dd1bb1d4e59e6943e2a422e44cd39474.png" alt="LaTeX"/> representations of
the parameter names and the function name. Other decorators can be applied
to a function object to specify things such as a <img class="math" src="_images/math/ba0b91b5dd1bb1d4e59e6943e2a422e44cd39474.png" alt="LaTeX"/> or
plain-text expression for the fit function.</p>
<dl class="method">
<dt id="kafe.function_tools.FitFunction.derive_by_parameters">
<tt class="descname">derive_by_parameters</tt><big>(</big><em>x_0</em>, <em>precision_spec</em>, <em>parameter_list</em><big>)</big><a class="headerlink" href="#kafe.function_tools.FitFunction.derive_by_parameters" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the gradient of <cite>func</cite> with respect to its parameters, i.e.
with respect to every variable of <cite>func</cite> except the first one.</p>
<dl class="docutils">
<dt><strong>precision_spec</strong> <span class="classifier-delimiter">:</span> <span class="classifier"><tt class="docutils literal"><span class="pre">float</span></tt> or iterable of <tt class="docutils literal"><span class="pre">floats</span></tt></span></dt>
<dd>An array of floats indicating the initial point spacing for
numerically evaluating the derivative. Can be a single float
value to use the same spacing for every derivation.</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="kafe.function_tools.FitFunction.derive_by_x">
<tt class="descname">derive_by_x</tt><big>(</big><em>x_0</em>, <em>precision_list</em>, <em>parameter_list</em><big>)</big><a class="headerlink" href="#kafe.function_tools.FitFunction.derive_by_x" title="Permalink to this definition">¶</a></dt>
<dd><p>If <cite>x_0</cite> is iterable, gives the array of derivatives of a function
<img class="math" src="_images/math/e182374d64cdb37c3eea1dfc3ea9b4e511d7b658.png" alt="f(x, par_1, par_2, \ldots)"/> around <img class="math" src="_images/math/b82f43071afb6bf0fdc09b4253016ef95bd810a4.png" alt="x = x_i"/> at every
<img class="math" src="_images/math/67bc6daa9d6b964201d6cef60cbeb1ac5fd26ead.png" alt="x_i"/> in <img class="math" src="_images/math/f5ec636e755349d4409f910e27d381c6da764230.png" alt="\vec{x}"/>. If <cite>x_0</cite> is not iterable, gives the
derivative of a function <img class="math" src="_images/math/e182374d64cdb37c3eea1dfc3ea9b4e511d7b658.png" alt="f(x, par_1, par_2, \ldots)"/> around
<img class="math" src="_images/math/439e14db706ca2b4e7d4fc33459dc280b0d44b9f.png" alt="x = \verb!x_0!"/>.</p>
</dd></dl>

<dl class="method">
<dt id="kafe.function_tools.FitFunction.evaluate">
<tt class="descname">evaluate</tt><big>(</big><em>x_0</em>, <em>parameter_list</em><big>)</big><a class="headerlink" href="#kafe.function_tools.FitFunction.evaluate" title="Permalink to this definition">¶</a></dt>
<dd><p>Evaluate the fit function at an x-value or at an array of 
x-values for the parameter values in <cite>prarameter_list</cite>.</p>
<blockquote>
<div><p><strong>x_0</strong> float or array of floats</p>
<p><strong>parameter_list</strong> values of function parameters</p>
<p><strong>returns</strong> function value(s)</p>
</div></blockquote>
</dd></dl>

<dl class="attribute">
<dt id="kafe.function_tools.FitFunction.expression">
<tt class="descname">expression</tt><em class="property"> = None</em><a class="headerlink" href="#kafe.function_tools.FitFunction.expression" title="Permalink to this definition">¶</a></dt>
<dd><p>a math expression (string) representing the function&#8217;s result</p>
</dd></dl>

<dl class="method">
<dt id="kafe.function_tools.FitFunction.get_function_equation">
<tt class="descname">get_function_equation</tt><big>(</big><em>equation_format='latex'</em>, <em>equation_type='full'</em>, <em>ensuremath=True</em><big>)</big><a class="headerlink" href="#kafe.function_tools.FitFunction.get_function_equation" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a string representing the function equation. Supported formats
are <img class="math" src="_images/math/ba0b91b5dd1bb1d4e59e6943e2a422e44cd39474.png" alt="LaTeX"/> and ASCII inline math. Note that <img class="math" src="_images/math/ba0b91b5dd1bb1d4e59e6943e2a422e44cd39474.png" alt="LaTeX"/>
math is wrapped by default in an <tt class="docutils literal"><span class="pre">\ensuremath{}</span></tt> expression. If this
is not desired behaviour, the flag <tt class="docutils literal"><span class="pre">ensuremath</span></tt> can be set to
<tt class="docutils literal"><span class="pre">False</span></tt>.</p>
<dl class="docutils">
<dt><em>equation_format</em> <span class="classifier-delimiter">:</span> <span class="classifier">string (optional)</span></dt>
<dd>Can be either &#8220;latex&#8221; (default) or &#8220;ascii&#8221;.</dd>
<dt><em>equation_type</em> <span class="classifier-delimiter">:</span> <span class="classifier">string (optional)</span></dt>
<dd><p class="first">Can be either &#8220;full&#8221; (default), &#8220;short&#8221; or &#8220;name&#8221;. A &#8220;name&#8221;-type
equation returns a representation of the function name:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">f</span>
</pre></div>
</div>
<p>A &#8220;short&#8221;-type equation limits itself to the function name and
variables:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">par1</span><span class="p">,</span> <span class="n">par2</span><span class="p">)</span>
</pre></div>
</div>
<p>A &#8220;full&#8221;-type equation includes the expression which the function
calculates:</p>
<div class="last highlight-python"><div class="highlight"><pre><span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">par1</span><span class="p">,</span> <span class="n">par2</span><span class="p">)</span> <span class="o">=</span> <span class="n">par1</span> <span class="o">*</span> <span class="n">x</span> <span class="o">+</span> <span class="n">par2</span>
</pre></div>
</div>
</dd>
<dt><em>ensuremath</em> <span class="classifier-delimiter">:</span> <span class="classifier">boolean (optional)</span></dt>
<dd>If a <img class="math" src="_images/math/ba0b91b5dd1bb1d4e59e6943e2a422e44cd39474.png" alt="LaTeX"/> math equation is requested, <tt class="docutils literal"><span class="pre">True</span></tt>
(default) will wrap the resulting expression in an
<tt class="docutils literal"><span class="pre">\ensuremath{}</span></tt> tag. Otherwise, no wrapping is done.</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="kafe.function_tools.FitFunction.latex_expression">
<tt class="descname">latex_expression</tt><em class="property"> = None</em><a class="headerlink" href="#kafe.function_tools.FitFunction.latex_expression" title="Permalink to this definition">¶</a></dt>
<dd><p>a <img class="math" src="_images/math/ba0b91b5dd1bb1d4e59e6943e2a422e44cd39474.png" alt="LaTeX"/> math expression, the function&#8217;s result</p>
</dd></dl>

<dl class="attribute">
<dt id="kafe.function_tools.FitFunction.latex_name">
<tt class="descname">latex_name</tt><em class="property"> = None</em><a class="headerlink" href="#kafe.function_tools.FitFunction.latex_name" title="Permalink to this definition">¶</a></dt>
<dd><p>The function&#8217;s name in <img class="math" src="_images/math/ba0b91b5dd1bb1d4e59e6943e2a422e44cd39474.png" alt="LaTeX"/></p>
</dd></dl>

<dl class="attribute">
<dt id="kafe.function_tools.FitFunction.latex_parameter_names">
<tt class="descname">latex_parameter_names</tt><em class="property"> = None</em><a class="headerlink" href="#kafe.function_tools.FitFunction.latex_parameter_names" title="Permalink to this definition">¶</a></dt>
<dd><p>A list of parameter names in <img class="math" src="_images/math/ba0b91b5dd1bb1d4e59e6943e2a422e44cd39474.png" alt="LaTeX"/></p>
</dd></dl>

<dl class="attribute">
<dt id="kafe.function_tools.FitFunction.latex_x_name">
<tt class="descname">latex_x_name</tt><em class="property"> = None</em><a class="headerlink" href="#kafe.function_tools.FitFunction.latex_x_name" title="Permalink to this definition">¶</a></dt>
<dd><p>A <img class="math" src="_images/math/ba0b91b5dd1bb1d4e59e6943e2a422e44cd39474.png" alt="LaTeX"/> symbol for the independent variable.</p>
</dd></dl>

<dl class="attribute">
<dt id="kafe.function_tools.FitFunction.name">
<tt class="descname">name</tt><em class="property"> = None</em><a class="headerlink" href="#kafe.function_tools.FitFunction.name" title="Permalink to this definition">¶</a></dt>
<dd><p>The name of the function</p>
</dd></dl>

<dl class="attribute">
<dt id="kafe.function_tools.FitFunction.number_of_parameters">
<tt class="descname">number_of_parameters</tt><em class="property"> = None</em><a class="headerlink" href="#kafe.function_tools.FitFunction.number_of_parameters" title="Permalink to this definition">¶</a></dt>
<dd><p>The number of parameters</p>
</dd></dl>

<dl class="attribute">
<dt id="kafe.function_tools.FitFunction.parameter_defaults">
<tt class="descname">parameter_defaults</tt><em class="property"> = None</em><a class="headerlink" href="#kafe.function_tools.FitFunction.parameter_defaults" title="Permalink to this definition">¶</a></dt>
<dd><p>The default values of the parameters</p>
</dd></dl>

<dl class="attribute">
<dt id="kafe.function_tools.FitFunction.parameter_names">
<tt class="descname">parameter_names</tt><em class="property"> = None</em><a class="headerlink" href="#kafe.function_tools.FitFunction.parameter_names" title="Permalink to this definition">¶</a></dt>
<dd><p>The names of the parameters</p>
</dd></dl>

<dl class="attribute">
<dt id="kafe.function_tools.FitFunction.x_name">
<tt class="descname">x_name</tt><em class="property"> = None</em><a class="headerlink" href="#kafe.function_tools.FitFunction.x_name" title="Permalink to this definition">¶</a></dt>
<dd><p>The name given to the independent variable</p>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="kafe.function_tools.LaTeX">
<tt class="descclassname">kafe.function_tools.</tt><tt class="descname">LaTeX</tt><big>(</big><em>**kwargs</em><big>)</big><a class="headerlink" href="#kafe.function_tools.LaTeX" title="Permalink to this definition">¶</a></dt>
<dd><p>Optional decorator for fit functions. This overrides a FitFunction&#8217;s
<cite>latex_</cite> attributes. The new values for the <cite>latex_</cite> attributes must be
passed as keyword arguments to the decorator. Possible arguments:</p>
<dl class="docutils">
<dt><em>name</em> <span class="classifier-delimiter">:</span> <span class="classifier">string</span></dt>
<dd><img class="math" src="_images/math/ba0b91b5dd1bb1d4e59e6943e2a422e44cd39474.png" alt="LaTeX"/> representation of the function name.</dd>
<dt><em>parameter_names</em> <span class="classifier-delimiter">:</span> <span class="classifier">list of strings</span></dt>
<dd>List of <img class="math" src="_images/math/ba0b91b5dd1bb1d4e59e6943e2a422e44cd39474.png" alt="LaTeX"/> representations of the function&#8217;s arguments.
The length of this list must be equal to the function&#8217;s argument
number. The argument names should be in the same order as in the
function definition.</dd>
<dt><em>x_name</em> <span class="classifier-delimiter">:</span> <span class="classifier">string</span></dt>
<dd><img class="math" src="_images/math/ba0b91b5dd1bb1d4e59e6943e2a422e44cd39474.png" alt="LaTeX"/> representation of the independent variable&#8217;s name.</dd>
<dt><em>expression</em> <span class="classifier-delimiter">:</span> <span class="classifier">string</span></dt>
<dd><img class="math" src="_images/math/ba0b91b5dd1bb1d4e59e6943e2a422e44cd39474.png" alt="LaTeX"/>-formatted expression representing the
function&#8217;s formula.</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="kafe.function_tools.derivative">
<tt class="descclassname">kafe.function_tools.</tt><tt class="descname">derivative</tt><big>(</big><em>func</em>, <em>derive_by_index</em>, <em>variables_tuple</em>, <em>derivative_spacing</em><big>)</big><a class="headerlink" href="#kafe.function_tools.derivative" title="Permalink to this definition">¶</a></dt>
<dd><p>Gives <img class="math" src="_images/math/52a1556c26eb02ce0f055e1ff93ec5920e47e047.png" alt="\frac{\partial f}{\partial x_k}"/> for <img class="math" src="_images/math/b405f5778f981a7540046c156adc7ad029dbfe9e.png" alt="f = f(x_0, x_1,
\ldots)"/>. <cite>func</cite> is <img class="math" src="_images/math/bb2c93730dbb48558bb3c4738c956c4e8f816437.png" alt="f"/>, <cite>variables_tuple</cite> is <img class="math" src="_images/math/72fde2168a71f169b30845777f2a63af92c8d428.png" alt="\{x_i\}"/> and
<cite>derive_by_index</cite> is <img class="math" src="_images/math/8c325612684d41304b9751c175df7bcc0f61f64f.png" alt="k"/>.</p>
</dd></dl>

<dl class="function">
<dt id="kafe.function_tools.outer_product">
<tt class="descclassname">kafe.function_tools.</tt><tt class="descname">outer_product</tt><big>(</big><em>input_array</em><big>)</big><a class="headerlink" href="#kafe.function_tools.outer_product" title="Permalink to this definition">¶</a></dt>
<dd><p>Takes a <cite>NumPy</cite> array and returns the outer (dyadic, Kronecker) product
with itself. If <cite>input_array</cite> is a vector <img class="math" src="_images/math/5f61118f2ae912f86e683687c005145b5eb54aec.png" alt="\mathbf{x}"/>, this returns
<img class="math" src="_images/math/54430e3fa2c99d82deb1e87b43e164ee22f996a7.png" alt="\mathbf{x}\mathbf{x}^T"/>.</p>
</dd></dl>

</div>
<div class="section" id="module-kafe.minuit">
<span id="minuit-module"></span><h3><a class="reference internal" href="#module-minuit" title="minuit: A submodule providing the `Minuit` object, which communicates with CERN *ROOT*'s function minimizer *Minuit*. (Unix)"><tt class="xref py py-mod docutils literal"><span class="pre">minuit</span></tt></a> Module<a class="headerlink" href="#module-kafe.minuit" title="Permalink to this headline">¶</a></h3>
<span class="target" id="module-minuit"></span><dl class="data">
<dt id="kafe.minuit.D_MATRIX_ERROR">
<tt class="descclassname">kafe.minuit.</tt><tt class="descname">D_MATRIX_ERROR</tt><em class="property"> = {0: 'Error matrix not calculated', 1: 'Error matrix approximate!', 2: 'Error matrix forced positive definite!', 3: 'Error matrix accurate'}</em><a class="headerlink" href="#kafe.minuit.D_MATRIX_ERROR" title="Permalink to this definition">¶</a></dt>
<dd><p>Error matrix status codes</p>
</dd></dl>

<dl class="class">
<dt id="kafe.minuit.Minuit">
<em class="property">class </em><tt class="descclassname">kafe.minuit.</tt><tt class="descname">Minuit</tt><big>(</big><em>number_of_parameters</em>, <em>function_to_minimize</em>, <em>parameter_names</em>, <em>start_parameters</em>, <em>parameter_errors</em>, <em>quiet=True</em>, <em>verbose=False</em><big>)</big><a class="headerlink" href="#kafe.minuit.Minuit" title="Permalink to this definition">¶</a></dt>
<dd><p>A class for communicating with ROOT&#8217;s function minimizer tool Minuit.</p>
<dl class="method">
<dt id="kafe.minuit.Minuit.FCN_wrapper">
<tt class="descname">FCN_wrapper</tt><big>(</big><em>number_of_parameters</em>, <em>derivatives</em>, <em>f</em>, <em>parameters</em>, <em>internal_flag</em><big>)</big><a class="headerlink" href="#kafe.minuit.Minuit.FCN_wrapper" title="Permalink to this definition">¶</a></dt>
<dd><p>This is actually a function called in <em>ROOT</em> and acting as a C wrapper
for our <cite>FCN</cite>, which is implemented in Python.</p>
<p>This function is called by <cite>Minuit</cite> several times during a fit. It
doesn&#8217;t return anything but modifies one of its arguments (<em>f</em>).
This is <em>ugly</em>, but it&#8217;s how <em>ROOT</em>&#8216;s <tt class="docutils literal"><span class="pre">TMinuit</span></tt> works. Its argument
structure is fixed and determined by <cite>Minuit</cite>:</p>
<dl class="docutils">
<dt><strong>number_of_parameters</strong> <span class="classifier-delimiter">:</span> <span class="classifier">int</span></dt>
<dd>The number of parameters of the current fit</dd>
<dt><strong>derivatives</strong> <span class="classifier-delimiter">:</span> <span class="classifier">C array</span></dt>
<dd>If the user chooses to calculate the first derivative of the
function inside the <cite>FCN</cite>, this value should be written here. This
interface to <cite>Minuit</cite> ignores this derivative, however, so
calculating this inside the <cite>FCN</cite> has no effect (yet).</dd>
<dt><strong>f</strong> <span class="classifier-delimiter">:</span> <span class="classifier">C array</span></dt>
<dd>The desired function value is in f[0] after execution.</dd>
<dt><strong>parameters</strong> <span class="classifier-delimiter">:</span> <span class="classifier">C array</span></dt>
<dd>A C array of parameters. Is cast to a Python list</dd>
<dt><strong>internal_flag</strong> <span class="classifier-delimiter">:</span> <span class="classifier">int</span></dt>
<dd>A flag allowing for different behaviour of the function.
Can be any integer from 1 (initial run) to 4(normal run). See
<cite>Minuit</cite>&#8216;s specification.</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="kafe.minuit.Minuit.fix_parameter">
<tt class="descname">fix_parameter</tt><big>(</big><em>parameter_number</em><big>)</big><a class="headerlink" href="#kafe.minuit.Minuit.fix_parameter" title="Permalink to this definition">¶</a></dt>
<dd><p>Fix parameter number &lt;<cite>parameter_number</cite>&gt;.</p>
<dl class="docutils">
<dt><strong>parameter_number</strong> <span class="classifier-delimiter">:</span> <span class="classifier">int</span></dt>
<dd>Number of the parameter to fix.</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="kafe.minuit.Minuit.function_to_minimize">
<tt class="descname">function_to_minimize</tt><em class="property"> = None</em><a class="headerlink" href="#kafe.minuit.Minuit.function_to_minimize" title="Permalink to this definition">¶</a></dt>
<dd><p>the actual <cite>FCN</cite> called in <tt class="docutils literal"><span class="pre">FCN_wrapper</span></tt></p>
</dd></dl>

<dl class="method">
<dt id="kafe.minuit.Minuit.get_chi2_probability">
<tt class="descname">get_chi2_probability</tt><big>(</big><em>n_deg_of_freedom</em><big>)</big><a class="headerlink" href="#kafe.minuit.Minuit.get_chi2_probability" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the probability that an observed <img class="math" src="_images/math/a61c1e51680e27d35d05bebed87d474972fc70bd.png" alt="\chi^2"/> exceeds
the calculated value of <img class="math" src="_images/math/a61c1e51680e27d35d05bebed87d474972fc70bd.png" alt="\chi^2"/> for this fit by chance,
even for a correct model. In other words, returns the probability that
a worse fit of the model to the data exists. If this is a small value
(typically &lt;5%), this means the fit is pretty bad. For values below
this threshold, the model very probably does not fit the data.</p>
<dl class="docutils">
<dt>n_def_of_freedom <span class="classifier-delimiter">:</span> <span class="classifier">int</span></dt>
<dd>The number of degrees of freedom. This is typically
<img class="math" src="_images/math/41de4f868f5d207f4f2caf1ea15fff94fc36f372.png" alt="n_   ext{datapoints} - n_    ext{parameters}"/>.</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="kafe.minuit.Minuit.get_contour">
<tt class="descname">get_contour</tt><big>(</big><em>parameter1</em>, <em>parameter2</em>, <em>n_points=20</em><big>)</big><a class="headerlink" href="#kafe.minuit.Minuit.get_contour" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a list of points (2-tuples) representing a sampling of
the <img class="math" src="_images/math/070fe743455ad95e644411607dc18d8e72f1d23f.png" alt="1\sigma"/> contour of the TMinuit fit. The <tt class="docutils literal"><span class="pre">FCN</span></tt> has to be
minimized before calling this.</p>
<dl class="docutils">
<dt><strong>parameter1</strong> <span class="classifier-delimiter">:</span> <span class="classifier">int</span></dt>
<dd>ID of the parameter to be displayed on the <cite>x</cite>-axis.</dd>
<dt><strong>parameter2</strong> <span class="classifier-delimiter">:</span> <span class="classifier">int</span></dt>
<dd>ID of the parameter to be displayed on the <cite>y</cite>-axis.</dd>
<dt><em>n_points</em> <span class="classifier-delimiter">:</span> <span class="classifier">int (optional)</span></dt>
<dd>number of points used to draw the contour. Default is 20.</dd>
<dt><em>returns</em> <span class="classifier-delimiter">:</span> <span class="classifier">2-tuple of tuples</span></dt>
<dd>a 2-tuple (x, y) containing <tt class="docutils literal"><span class="pre">n_points+1</span></tt> points sampled
along the contour. The first point is repeated at the end
of the list to generate a closed contour.</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="kafe.minuit.Minuit.get_error_matrix">
<tt class="descname">get_error_matrix</tt><big>(</big><big>)</big><a class="headerlink" href="#kafe.minuit.Minuit.get_error_matrix" title="Permalink to this definition">¶</a></dt>
<dd><p>Retrieves the parameter error matrix from TMinuit.</p>
<p>return : <cite>numpy.matrix</cite></p>
</dd></dl>

<dl class="method">
<dt id="kafe.minuit.Minuit.get_fit_info">
<tt class="descname">get_fit_info</tt><big>(</big><em>info</em><big>)</big><a class="headerlink" href="#kafe.minuit.Minuit.get_fit_info" title="Permalink to this definition">¶</a></dt>
<dd><p>Retrieves other info from <cite>Minuit</cite>.</p>
<dl class="docutils">
<dt><strong>info</strong> <span class="classifier-delimiter">:</span> <span class="classifier">string</span></dt>
<dd><p class="first">Information about the fit to retrieve.
This can be any of the following:</p>
<blockquote class="last">
<div><ul class="simple">
<li><tt class="docutils literal"><span class="pre">'fcn'</span></tt>: <cite>FCN</cite> value at minimum,</li>
<li><tt class="docutils literal"><span class="pre">'edm'</span></tt>: estimated distance to minimum</li>
<li><tt class="docutils literal"><span class="pre">'err_def'</span></tt>: <cite>Minuit</cite> error matrix status code</li>
<li><tt class="docutils literal"><span class="pre">'status_code'</span></tt>: <cite>Minuit</cite> general status code</li>
</ul>
</div></blockquote>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="kafe.minuit.Minuit.get_parameter_errors">
<tt class="descname">get_parameter_errors</tt><big>(</big><big>)</big><a class="headerlink" href="#kafe.minuit.Minuit.get_parameter_errors" title="Permalink to this definition">¶</a></dt>
<dd><p>Retrieves the parameter errors from TMinuit.</p>
<dl class="docutils">
<dt>return <span class="classifier-delimiter">:</span> <span class="classifier">tuple</span></dt>
<dd>Current <cite>Minuit</cite> parameter errors</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="kafe.minuit.Minuit.get_parameter_info">
<tt class="descname">get_parameter_info</tt><big>(</big><big>)</big><a class="headerlink" href="#kafe.minuit.Minuit.get_parameter_info" title="Permalink to this definition">¶</a></dt>
<dd><p>Retrieves parameter information from TMinuit.</p>
<dl class="docutils">
<dt>return <span class="classifier-delimiter">:</span> <span class="classifier">list of tuples</span></dt>
<dd><tt class="docutils literal"><span class="pre">(parameter_name,</span> <span class="pre">parameter_val,</span> <span class="pre">parameter_error)</span></tt></dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="kafe.minuit.Minuit.get_parameter_name">
<tt class="descname">get_parameter_name</tt><big>(</big><em>parameter_nr</em><big>)</big><a class="headerlink" href="#kafe.minuit.Minuit.get_parameter_name" title="Permalink to this definition">¶</a></dt>
<dd><p>Gets the name of parameter number <tt class="docutils literal"><span class="pre">parameter_nr</span></tt></p>
<dl class="docutils">
<dt><strong>parameter_nr</strong> <span class="classifier-delimiter">:</span> <span class="classifier">int</span></dt>
<dd>Number of the parameter whose name to get.</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="kafe.minuit.Minuit.get_parameter_values">
<tt class="descname">get_parameter_values</tt><big>(</big><big>)</big><a class="headerlink" href="#kafe.minuit.Minuit.get_parameter_values" title="Permalink to this definition">¶</a></dt>
<dd><p>Retrieves the parameter values from TMinuit.</p>
<dl class="docutils">
<dt>return <span class="classifier-delimiter">:</span> <span class="classifier">tuple</span></dt>
<dd>Current <cite>Minuit</cite> parameter values</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="kafe.minuit.Minuit.max_iterations">
<tt class="descname">max_iterations</tt><em class="property"> = None</em><a class="headerlink" href="#kafe.minuit.Minuit.max_iterations" title="Permalink to this definition">¶</a></dt>
<dd><p>maximum number of iterations until <tt class="docutils literal"><span class="pre">TMinuit</span></tt> gives up</p>
</dd></dl>

<dl class="method">
<dt id="kafe.minuit.Minuit.minimize">
<tt class="descname">minimize</tt><big>(</big><em>final_fit=True</em>, <em>log_print_level=2</em><big>)</big><a class="headerlink" href="#kafe.minuit.Minuit.minimize" title="Permalink to this definition">¶</a></dt>
<dd><p>Do the minimization. This calls <cite>Minuit</cite>&#8216;s algorithms <tt class="docutils literal"><span class="pre">MIGRAD</span></tt>
for minimization and, if <cite>final_fit</cite> is <cite>True</cite>, also <tt class="docutils literal"><span class="pre">HESSE</span></tt>
for computing/checking the parameter error matrix.</p>
</dd></dl>

<dl class="attribute">
<dt id="kafe.minuit.Minuit.number_of_parameters">
<tt class="descname">number_of_parameters</tt><em class="property"> = None</em><a class="headerlink" href="#kafe.minuit.Minuit.number_of_parameters" title="Permalink to this definition">¶</a></dt>
<dd><p>number of parameters to minimize for</p>
</dd></dl>

<dl class="method">
<dt id="kafe.minuit.Minuit.release_parameter">
<tt class="descname">release_parameter</tt><big>(</big><em>parameter_number</em><big>)</big><a class="headerlink" href="#kafe.minuit.Minuit.release_parameter" title="Permalink to this definition">¶</a></dt>
<dd><p>Release parameter number &lt;<cite>parameter_number</cite>&gt;.</p>
<dl class="docutils">
<dt><strong>parameter_number</strong> <span class="classifier-delimiter">:</span> <span class="classifier">int</span></dt>
<dd>Number of the parameter to release.</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="kafe.minuit.Minuit.reset">
<tt class="descname">reset</tt><big>(</big><big>)</big><a class="headerlink" href="#kafe.minuit.Minuit.reset" title="Permalink to this definition">¶</a></dt>
<dd><p>Execute TMinuit&#8217;s <cite>mnrset</cite> method.</p>
</dd></dl>

<dl class="method">
<dt id="kafe.minuit.Minuit.set_err">
<tt class="descname">set_err</tt><big>(</big><em>up_value=1.0</em><big>)</big><a class="headerlink" href="#kafe.minuit.Minuit.set_err" title="Permalink to this definition">¶</a></dt>
<dd><p>Sets the <tt class="docutils literal"><span class="pre">UP</span></tt> value for Minuit.</p>
<dl class="docutils">
<dt><em>up_value</em> <span class="classifier-delimiter">:</span> <span class="classifier">float (optional, default: 1.0)</span></dt>
<dd>This is the value by which <cite>FCN</cite> is expected to change.</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="kafe.minuit.Minuit.set_parameter_errors">
<tt class="descname">set_parameter_errors</tt><big>(</big><em>parameter_errors=None</em><big>)</big><a class="headerlink" href="#kafe.minuit.Minuit.set_parameter_errors" title="Permalink to this definition">¶</a></dt>
<dd><p>Sets the fit parameter errors. If parameter_values=`None`, sets the
error to 10% of the parameter value.</p>
</dd></dl>

<dl class="method">
<dt id="kafe.minuit.Minuit.set_parameter_names">
<tt class="descname">set_parameter_names</tt><big>(</big><em>parameter_names</em><big>)</big><a class="headerlink" href="#kafe.minuit.Minuit.set_parameter_names" title="Permalink to this definition">¶</a></dt>
<dd><p>Sets the fit parameters. If parameter_values=`None`, tries to infer
defaults from the function_to_minimize.</p>
</dd></dl>

<dl class="method">
<dt id="kafe.minuit.Minuit.set_parameter_values">
<tt class="descname">set_parameter_values</tt><big>(</big><em>parameter_values</em><big>)</big><a class="headerlink" href="#kafe.minuit.Minuit.set_parameter_values" title="Permalink to this definition">¶</a></dt>
<dd><p>Sets the fit parameters. If parameter_values=`None`, tries to infer
defaults from the function_to_minimize.</p>
</dd></dl>

<dl class="method">
<dt id="kafe.minuit.Minuit.set_print_level">
<tt class="descname">set_print_level</tt><big>(</big><em>print_level=1</em><big>)</big><a class="headerlink" href="#kafe.minuit.Minuit.set_print_level" title="Permalink to this definition">¶</a></dt>
<dd><p>Sets the print level for Minuit.</p>
<dl class="docutils">
<dt><em>print_level</em> <span class="classifier-delimiter">:</span> <span class="classifier">int (optional, default: 1 (frugal output))</span></dt>
<dd>Tells <tt class="docutils literal"><span class="pre">TMinuit</span></tt> how much output to generate. The higher this
value, the more output it generates.</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="kafe.minuit.Minuit.set_strategy">
<tt class="descname">set_strategy</tt><big>(</big><em>strategy_id=1</em><big>)</big><a class="headerlink" href="#kafe.minuit.Minuit.set_strategy" title="Permalink to this definition">¶</a></dt>
<dd><p>Sets the strategy Minuit.</p>
<dl class="docutils">
<dt><em>strategy_id</em> <span class="classifier-delimiter">:</span> <span class="classifier">int (optional, default: 1 (optimized))</span></dt>
<dd>Tells <tt class="docutils literal"><span class="pre">TMinuit</span></tt> to use a certain strategy. Refer to <tt class="docutils literal"><span class="pre">TMinuit</span></tt>&#8216;s
documentation for available strategies.</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="kafe.minuit.Minuit.tolerance">
<tt class="descname">tolerance</tt><em class="property"> = None</em><a class="headerlink" href="#kafe.minuit.Minuit.tolerance" title="Permalink to this definition">¶</a></dt>
<dd><p><tt class="docutils literal"><span class="pre">TMinuit</span></tt> tolerance</p>
</dd></dl>

<dl class="method">
<dt id="kafe.minuit.Minuit.update_parameter_data">
<tt class="descname">update_parameter_data</tt><big>(</big><em>show_warnings=False</em><big>)</big><a class="headerlink" href="#kafe.minuit.Minuit.update_parameter_data" title="Permalink to this definition">¶</a></dt>
<dd><p>(Re-)Sets the parameter names, values and step size on the
C++ side of Minuit.</p>
</dd></dl>

</dd></dl>

<dl class="data">
<dt id="kafe.minuit.P_DETAIL_LEVEL">
<tt class="descclassname">kafe.minuit.</tt><tt class="descname">P_DETAIL_LEVEL</tt><em class="property"> = 1</em><a class="headerlink" href="#kafe.minuit.P_DETAIL_LEVEL" title="Permalink to this definition">¶</a></dt>
<dd><p>default level of detail for TMinuit&#8217;s output
(typical range: -1 to 3, default: 1)</p>
</dd></dl>

</div>
<div class="section" id="module-kafe.config">
<span id="config-module"></span><h3><a class="reference internal" href="#module-config" title="config: A submodule for working with config files. (Unix)"><tt class="xref py py-mod docutils literal"><span class="pre">config</span></tt></a> Module<a class="headerlink" href="#module-kafe.config" title="Permalink to this headline">¶</a></h3>
<span class="target" id="module-config"></span></div>
<div class="section" id="module-kafe.plot">
<span id="plot-module"></span><h3><a class="reference internal" href="#module-plot" title="plot: A submodule for plotting `Dataset`s with ``matplotlib``. (Unix)"><tt class="xref py py-mod docutils literal"><span class="pre">plot</span></tt></a> Module<a class="headerlink" href="#module-kafe.plot" title="Permalink to this headline">¶</a></h3>
<span class="target" id="module-plot"></span><dl class="class">
<dt id="kafe.plot.Plot">
<em class="property">class </em><tt class="descclassname">kafe.plot.</tt><tt class="descname">Plot</tt><big>(</big><em>*fits</em>, <em>**kwargs</em><big>)</big><a class="headerlink" href="#kafe.plot.Plot" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <tt class="xref py py-class docutils literal"><span class="pre">object</span></tt></p>
<p>The constuctor accepts a series of <cite>Fit</cite> objects as positional
arguments. Some keyword arguments can be provided to override
the defaults.</p>
<dl class="attribute">
<dt id="kafe.plot.Plot.axis_labels">
<tt class="descname">axis_labels</tt><em class="property"> = None</em><a class="headerlink" href="#kafe.plot.Plot.axis_labels" title="Permalink to this definition">¶</a></dt>
<dd><p>axis labels</p>
</dd></dl>

<dl class="method">
<dt id="kafe.plot.Plot.compute_plot_range">
<tt class="descname">compute_plot_range</tt><big>(</big><em>include_error_bars=True</em><big>)</big><a class="headerlink" href="#kafe.plot.Plot.compute_plot_range" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the span of all child datasets and sets the plot range to that</p>
</dd></dl>

<dl class="method">
<dt id="kafe.plot.Plot.draw_fit_parameters_box">
<tt class="descname">draw_fit_parameters_box</tt><big>(</big><em>plot_spec=0</em><big>)</big><a class="headerlink" href="#kafe.plot.Plot.draw_fit_parameters_box" title="Permalink to this definition">¶</a></dt>
<dd><p>Draw the parameter box to the canvas</p>
<dl class="docutils">
<dt><em>plot_spec</em> <span class="classifier-delimiter">:</span> <span class="classifier">int, list of ints, string or None (optional, default: 0)</span></dt>
<dd>Specify the plot id of the plot for which to draw the parameters.
Passing 0 will only draw the parameter box for the first plot, and
so on. Passing a list of ints will only draw the parameters for
plot ids inside the list. Passing <tt class="docutils literal"><span class="pre">'all'</span></tt> will print parameters
for all plots. Passing <tt class="docutils literal"><span class="pre">None</span></tt> will return immediately doing
nothing.</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="kafe.plot.Plot.draw_legend">
<tt class="descname">draw_legend</tt><big>(</big><big>)</big><a class="headerlink" href="#kafe.plot.Plot.draw_legend" title="Permalink to this definition">¶</a></dt>
<dd><p>Draw the plot legend to the canvas</p>
</dd></dl>

<dl class="method">
<dt id="kafe.plot.Plot.extend_span">
<tt class="descname">extend_span</tt><big>(</big><em>axis</em>, <em>new_span</em><big>)</big><a class="headerlink" href="#kafe.plot.Plot.extend_span" title="Permalink to this definition">¶</a></dt>
<dd><p>Expand the span of the current plot.</p>
<p>This method extends the current plot span to include <cite>new_span</cite></p>
</dd></dl>

<dl class="attribute">
<dt id="kafe.plot.Plot.fits">
<tt class="descname">fits</tt><em class="property"> = None</em><a class="headerlink" href="#kafe.plot.Plot.fits" title="Permalink to this definition">¶</a></dt>
<dd><p>list of <a href="#id1"><span class="problematic" id="id2">`</span></a>Fit`s to plot</p>
</dd></dl>

<dl class="method">
<dt id="kafe.plot.Plot.init_plots">
<tt class="descname">init_plots</tt><big>(</big><big>)</big><a class="headerlink" href="#kafe.plot.Plot.init_plots" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize the plots for each fit.</p>
</dd></dl>

<dl class="method">
<dt id="kafe.plot.Plot.on_draw">
<tt class="descname">on_draw</tt><big>(</big><em>event</em><big>)</big><a class="headerlink" href="#kafe.plot.Plot.on_draw" title="Permalink to this definition">¶</a></dt>
<dd><p>Function to call when a draw event occurs.</p>
</dd></dl>

<dl class="method">
<dt id="kafe.plot.Plot.plot">
<tt class="descname">plot</tt><big>(</big><em>p_id</em>, <em>show_data=True</em>, <em>show_function=True</em><big>)</big><a class="headerlink" href="#kafe.plot.Plot.plot" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot the <cite>Fit</cite> object with the number <cite>p_id</cite> to its figure.</p>
</dd></dl>

<dl class="method">
<dt id="kafe.plot.Plot.plot_all">
<tt class="descname">plot_all</tt><big>(</big><em>show_info_for='all'</em>, <em>show_data_for='all'</em>, <em>show_function_for='all'</em><big>)</big><a class="headerlink" href="#kafe.plot.Plot.plot_all" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot every <cite>Fit</cite> object to its figure.</p>
</dd></dl>

<dl class="attribute">
<dt id="kafe.plot.Plot.plot_range">
<tt class="descname">plot_range</tt><em class="property"> = None</em><a class="headerlink" href="#kafe.plot.Plot.plot_range" title="Permalink to this definition">¶</a></dt>
<dd><p>plot range</p>
</dd></dl>

<dl class="attribute">
<dt id="kafe.plot.Plot.plot_style">
<tt class="descname">plot_style</tt><em class="property"> = None</em><a class="headerlink" href="#kafe.plot.Plot.plot_style" title="Permalink to this definition">¶</a></dt>
<dd><p>plot style</p>
</dd></dl>

<dl class="method">
<dt id="kafe.plot.Plot.save">
<tt class="descname">save</tt><big>(</big><em>output_file</em><big>)</big><a class="headerlink" href="#kafe.plot.Plot.save" title="Permalink to this definition">¶</a></dt>
<dd><p>Save the <cite>Plot</cite> to a file.</p>
</dd></dl>

<dl class="method">
<dt id="kafe.plot.Plot.show">
<tt class="descname">show</tt><big>(</big><big>)</big><a class="headerlink" href="#kafe.plot.Plot.show" title="Permalink to this definition">¶</a></dt>
<dd><p>Show the <cite>Plot</cite> in a matplotlib interactive window.</p>
</dd></dl>

<dl class="attribute">
<dt id="kafe.plot.Plot.show_legend">
<tt class="descname">show_legend</tt><em class="property"> = None</em><a class="headerlink" href="#kafe.plot.Plot.show_legend" title="Permalink to this definition">¶</a></dt>
<dd><p>whether to show the plot legend (<tt class="docutils literal"><span class="pre">True</span></tt>) or not (<tt class="docutils literal"><span class="pre">False</span></tt>)</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="kafe.plot.PlotStyle">
<em class="property">class </em><tt class="descclassname">kafe.plot.</tt><tt class="descname">PlotStyle</tt><a class="headerlink" href="#kafe.plot.PlotStyle" title="Permalink to this definition">¶</a></dt>
<dd><p>Class for specifying a style for a specific plot. This object stores a
progression of marker and line types and colors, as well as preferences
relating to point size and label size. These can be overriden by
overwriting the instance variables directly. A series of <cite>get_...</cite> methods
are provided which go through these lists cyclically.</p>
<dl class="method">
<dt id="kafe.plot.PlotStyle.get_line">
<tt class="descname">get_line</tt><big>(</big><em>idm</em><big>)</big><a class="headerlink" href="#kafe.plot.PlotStyle.get_line" title="Permalink to this definition">¶</a></dt>
<dd><p>Get a specific line type. This runs cyclically through the defined
defaults.</p>
</dd></dl>

<dl class="method">
<dt id="kafe.plot.PlotStyle.get_linecolor">
<tt class="descname">get_linecolor</tt><big>(</big><em>idm</em><big>)</big><a class="headerlink" href="#kafe.plot.PlotStyle.get_linecolor" title="Permalink to this definition">¶</a></dt>
<dd><p>Get a specific line color. This runs cyclically through the defined
defaults.</p>
</dd></dl>

<dl class="method">
<dt id="kafe.plot.PlotStyle.get_marker">
<tt class="descname">get_marker</tt><big>(</big><em>idm</em><big>)</big><a class="headerlink" href="#kafe.plot.PlotStyle.get_marker" title="Permalink to this definition">¶</a></dt>
<dd><p>Get a specific marker type. This runs cyclically through the defined
defaults.</p>
</dd></dl>

<dl class="method">
<dt id="kafe.plot.PlotStyle.get_markercolor">
<tt class="descname">get_markercolor</tt><big>(</big><em>idm</em><big>)</big><a class="headerlink" href="#kafe.plot.PlotStyle.get_markercolor" title="Permalink to this definition">¶</a></dt>
<dd><p>Get a specific marker color. This runs cyclically through the
defined defaults.</p>
</dd></dl>

<dl class="method">
<dt id="kafe.plot.PlotStyle.get_pointsize">
<tt class="descname">get_pointsize</tt><big>(</big><em>idm</em><big>)</big><a class="headerlink" href="#kafe.plot.PlotStyle.get_pointsize" title="Permalink to this definition">¶</a></dt>
<dd><p>Get a specific point size. This runs cyclically through the defined
defaults.</p>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="kafe.plot.label_to_latex">
<tt class="descclassname">kafe.plot.</tt><tt class="descname">label_to_latex</tt><big>(</big><em>label</em><big>)</big><a class="headerlink" href="#kafe.plot.label_to_latex" title="Permalink to this definition">¶</a></dt>
<dd><p>Generates a simple LaTeX-formatted label from a plain-text label.
This treats isolated characters and words beginning with a backslash
as mathematical expressions and surround them with $ signs accordingly.</p>
<dl class="docutils">
<dt><strong>label</strong> <span class="classifier-delimiter">:</span> <span class="classifier">string</span></dt>
<dd>Plain-text string to convert to LaTeX.</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="kafe.plot.pad_span">
<tt class="descclassname">kafe.plot.</tt><tt class="descname">pad_span</tt><big>(</big><em>span</em>, <em>pad_coeff=1</em>, <em>additional_pad=None</em><big>)</big><a class="headerlink" href="#kafe.plot.pad_span" title="Permalink to this definition">¶</a></dt>
<dd><p>Enlarges the interval <cite>span</cite> (list of two floats) symmetrically around
its center to length <cite>pad_coeff</cite>. Optionally, an <cite>additional_pad</cite> argument
can be specified. The returned span is then additionally enlarged by that
amount.</p>
<p><cite>additional_pad</cite> can also be a list of two floats which specifies an
asymmetric amount by which to enlarge the span. Note that in this case,
positive entries in <cite>additional_pad</cite> will enlarge the span (move the
interval end away from the interval center) and negative amounts will
shorten it (move the interval end towards the interval center).</p>
</dd></dl>

</div>
<div class="section" id="module-kafe.latex_tools">
<span id="latex-tools-module"></span><h3><a class="reference internal" href="#module-latex_tools" title="latex_tools: This submodule contains several useful tools for handling :math:`LaTeX` expressions. (Unix)"><tt class="xref py py-mod docutils literal"><span class="pre">latex_tools</span></tt></a> Module<a class="headerlink" href="#module-kafe.latex_tools" title="Permalink to this headline">¶</a></h3>
<span class="target" id="module-latex_tools"></span><dl class="function">
<dt id="kafe.latex_tools.ascii_to_latex_math">
<tt class="descclassname">kafe.latex_tools.</tt><tt class="descname">ascii_to_latex_math</tt><big>(</big><em>str_ascii</em>, <em>monospace=True</em>, <em>ensuremath=True</em><big>)</big><a class="headerlink" href="#kafe.latex_tools.ascii_to_latex_math" title="Permalink to this definition">¶</a></dt>
<dd><p>Escapes certain characters in an ASCII input string so that the result
can be included in math mode without error.</p>
<dl class="docutils">
<dt><strong>str_ascii</strong> <span class="classifier-delimiter">:</span> <span class="classifier">string</span></dt>
<dd>A plain-text string containing characters to be escaped for
<img class="math" src="_images/math/ba0b91b5dd1bb1d4e59e6943e2a422e44cd39474.png" alt="LaTeX"/> math mode.</dd>
<dt><em>monospace</em> <span class="classifier-delimiter">:</span> <span class="classifier">boolean (optional)</span></dt>
<dd>Whether to render the whole expression as monospace. Defaults to
<tt class="docutils literal"><span class="pre">True</span></tt>.</dd>
<dt><em>ensuremath</em> <span class="classifier-delimiter">:</span> <span class="classifier">boolean (optional)</span></dt>
<dd>If this is <tt class="docutils literal"><span class="pre">True</span></tt>, the resulting formula is wrapped in
an <tt class="docutils literal"><span class="pre">\ensuremath{}</span></tt> tag. Defaults to <tt class="docutils literal"><span class="pre">True</span></tt>.</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-kafe.numeric_tools">
<span id="numeric-tools-module"></span><h3><a class="reference internal" href="#module-numeric_tools" title="numeric_tools: A submodule containing several numeric algorithms used by the  fit package, such as methods for converting beween covariance and correlation matrices or extracting the statistical errors from a covariance matrix. (Unix)"><tt class="xref py py-mod docutils literal"><span class="pre">numeric_tools</span></tt></a> Module<a class="headerlink" href="#module-kafe.numeric_tools" title="Permalink to this headline">¶</a></h3>
<span class="target" id="module-numeric_tools"></span><dl class="function">
<dt id="kafe.numeric_tools.MinuitCov_to_cor">
<tt class="descclassname">kafe.numeric_tools.</tt><tt class="descname">MinuitCov_to_cor</tt><big>(</big><em>cov_mat</em><big>)</big><a class="headerlink" href="#kafe.numeric_tools.MinuitCov_to_cor" title="Permalink to this definition">¶</a></dt>
<dd><p>Converts a covariance matrix as returned by Minuit to the 
corresponding correlation matrix; note that the Minuit
covariance matrix may contain lines/rows with zeroes if
parameters are fixed</p>
<dl class="docutils">
<dt><strong>cov_mat</strong> <span class="classifier-delimiter">:</span> <span class="classifier"><cite>numpy.matrix</cite></span></dt>
<dd>The Minuit covariance matrix to convert.</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="kafe.numeric_tools.cor_to_cov">
<tt class="descclassname">kafe.numeric_tools.</tt><tt class="descname">cor_to_cov</tt><big>(</big><em>cor_mat</em>, <em>error_list</em><big>)</big><a class="headerlink" href="#kafe.numeric_tools.cor_to_cov" title="Permalink to this definition">¶</a></dt>
<dd><p>Converts a correlation matrix to a covariance matrix according to the
formula</p>
<div class="math">
<p><img src="_images/math/330ded407903c12a574265e54c0c5ae8744db84f.png" alt="\text{Cov}_{ij} = \text{Cor}_{ij}\, \sigma_i \, \sigma_j"/></p>
</div><dl class="docutils">
<dt><strong>cor_mat</strong> <span class="classifier-delimiter">:</span> <span class="classifier"><cite>numpy.matrix</cite></span></dt>
<dd>The correlation matrix to convert.</dd>
<dt><strong>error_list</strong> <span class="classifier-delimiter">:</span> <span class="classifier">sequence of floats</span></dt>
<dd>A sequence of statistical errors. Must be of the same length
as the diagonal of <cite>cor_mat</cite>.</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="kafe.numeric_tools.cov_to_cor">
<tt class="descclassname">kafe.numeric_tools.</tt><tt class="descname">cov_to_cor</tt><big>(</big><em>cov_mat</em><big>)</big><a class="headerlink" href="#kafe.numeric_tools.cov_to_cor" title="Permalink to this definition">¶</a></dt>
<dd><p>Converts a covariance matrix to a correlation matrix according to the
formula</p>
<div class="math">
<p><img src="_images/math/b639793a012cef820a0d1c68f47b1a3bb1f6c36e.png" alt="\text{Cor}_{ij} = \frac{\text{Cov}_{ij}}
    {\sqrt{ \text{Cov}_{ii}\,\text{Cov}_{jj}}}"/></p>
</div><dl class="docutils">
<dt><strong>cov_mat</strong> <span class="classifier-delimiter">:</span> <span class="classifier"><cite>numpy.matrix</cite></span></dt>
<dd>The covariance matrix to convert.</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="kafe.numeric_tools.extract_statistical_errors">
<tt class="descclassname">kafe.numeric_tools.</tt><tt class="descname">extract_statistical_errors</tt><big>(</big><em>cov_mat</em><big>)</big><a class="headerlink" href="#kafe.numeric_tools.extract_statistical_errors" title="Permalink to this definition">¶</a></dt>
<dd><p>Extracts the statistical errors from a covariance matrix. This means
it returns the (elementwise) square root of the diagonal entries</p>
<dl class="docutils">
<dt><strong>cov_mat</strong></dt>
<dd>The covariance matrix to extract errors from. Type: <cite>numpy.matrix</cite></dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="kafe.numeric_tools.make_symmetric_lower">
<tt class="descclassname">kafe.numeric_tools.</tt><tt class="descname">make_symmetric_lower</tt><big>(</big><em>mat</em><big>)</big><a class="headerlink" href="#kafe.numeric_tools.make_symmetric_lower" title="Permalink to this definition">¶</a></dt>
<dd><p>Copies the matrix entries below the main diagonal to the upper triangle
half of the matrix. Leaves the diagonal unchanged. Returns a <cite>NumPy</cite> matrix
object.</p>
<dl class="docutils">
<dt><strong>mat</strong> <span class="classifier-delimiter">:</span> <span class="classifier"><cite>numpy.matrix</cite></span></dt>
<dd>A lower diagonal matrix.</dd>
<dt>returns <span class="classifier-delimiter">:</span> <span class="classifier"><cite>numpy.matrix</cite></span></dt>
<dd>The lower triangle matrix.</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="kafe.numeric_tools.zero_pad_lower_triangle">
<tt class="descclassname">kafe.numeric_tools.</tt><tt class="descname">zero_pad_lower_triangle</tt><big>(</big><em>triangle_list</em><big>)</big><a class="headerlink" href="#kafe.numeric_tools.zero_pad_lower_triangle" title="Permalink to this definition">¶</a></dt>
<dd><p>Converts a list of lists into a lower triangle matrix. The list members
should be lists of increasing length from 1 to N, N being the dimension of
the resulting lower triangle matrix. Returns a <cite>NumPy</cite> matrix object.</p>
<p>For example:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">zero_pad_lower_triangle</span><span class="p">([</span> <span class="p">[</span><span class="mf">1.0</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.2</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.01</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">,</span> <span class="mf">3.0</span><span class="p">]</span> <span class="p">])</span>
<span class="go">matrix([[ 1.  ,  0.  ,  0.  ],</span>
<span class="go">        [ 0.2 ,  1.  ,  0.  ],</span>
<span class="go">        [ 0.01,  0.4 ,  3.  ]])</span>
</pre></div>
</div>
<dl class="docutils">
<dt><strong>triangle_list</strong> <span class="classifier-delimiter">:</span> <span class="classifier">list</span></dt>
<dd>A list containing lists of increasing length.</dd>
<dt>returns <span class="classifier-delimiter">:</span> <span class="classifier"><cite>numpy.matrix</cite></span></dt>
<dd>The lower triangle matrix.</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-kafe.stream">
<span id="stream-module"></span><h3><a class="reference internal" href="#module-stream" title="stream: A submodule containing an object for simultaneous output to file and to ``sys.stdout``. (Unix)"><tt class="xref py py-mod docutils literal"><span class="pre">stream</span></tt></a> Module<a class="headerlink" href="#module-kafe.stream" title="Permalink to this headline">¶</a></h3>
<span class="target" id="module-stream"></span><dl class="class">
<dt id="kafe.stream.StreamDup">
<em class="property">class </em><tt class="descclassname">kafe.stream.</tt><tt class="descname">StreamDup</tt><big>(</big><em>out_file</em>, <em>suppress_stdout=False</em><big>)</big><a class="headerlink" href="#kafe.stream.StreamDup" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <tt class="xref py py-class docutils literal"><span class="pre">object</span></tt></p>
<p>Object for simultaneous logging to stdout and files.
This object provides a file/like object for the outout to be written to.
Writing to this object will write to stdout (usually the console) and to
a file.</p>
<dl class="docutils">
<dt><strong>out_file</strong> <span class="classifier-delimiter">:</span> <span class="classifier">file path or file-like object or list of file paths ...</span></dt>
<dd>File(s) to which to log the output, along with stdout. If a file exists
on disk, it will be appended to.</dd>
<dt><em>suppress_stdout</em> <span class="classifier-delimiter">:</span> <span class="classifier">boolean</span></dt>
<dd>Whether to log to stdout simultaneously (<tt class="docutils literal"><span class="pre">False</span></tt>) or suppress output
to stdout (<tt class="docutils literal"><span class="pre">True</span></tt>). Default to <tt class="docutils literal"><span class="pre">False</span></tt>.</dd>
</dl>
<dl class="method">
<dt id="kafe.stream.StreamDup.fileno">
<tt class="descname">fileno</tt><big>(</big><big>)</big><a class="headerlink" href="#kafe.stream.StreamDup.fileno" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the file handler id of the main (first) output file.</p>
</dd></dl>

<dl class="method">
<dt id="kafe.stream.StreamDup.flush">
<tt class="descname">flush</tt><big>(</big><big>)</big><a class="headerlink" href="#kafe.stream.StreamDup.flush" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="kafe.stream.StreamDup.write">
<tt class="descname">write</tt><big>(</big><em>message</em><big>)</big><a class="headerlink" href="#kafe.stream.StreamDup.write" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="kafe.stream.StreamDup.write_timestamp">
<tt class="descname">write_timestamp</tt><big>(</big><em>prefix</em><big>)</big><a class="headerlink" href="#kafe.stream.StreamDup.write_timestamp" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="kafe.stream.StreamDup.write_to_file">
<tt class="descname">write_to_file</tt><big>(</big><em>message</em><big>)</big><a class="headerlink" href="#kafe.stream.StreamDup.write_to_file" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="kafe.stream.StreamDup.write_to_stdout">
<tt class="descname">write_to_stdout</tt><big>(</big><em>message</em>, <em>check_if_suppressed=False</em><big>)</big><a class="headerlink" href="#kafe.stream.StreamDup.write_to_stdout" title="Permalink to this definition">¶</a></dt>
<dd><p>Explicitly write to stdout. This method will not check by default
whether <tt class="docutils literal"><span class="pre">suppress_stdout</span></tt> is set for this <cite>StreamDup</cite>. If
<tt class="docutils literal"><span class="pre">check_if_suppressed</span></tt> is explicitly set to <tt class="docutils literal"><span class="pre">True</span></tt>, then this
check occurs.</p>
</dd></dl>

</dd></dl>

</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
  <h3><a href="#">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Welcome to KaFE (Karlsruhe Fit Environment)</a><ul>
<li><a class="reference internal" href="#kafe-overview"><tt class="docutils literal"><span class="pre">kafe</span></tt> Overview</a><ul>
<li><a class="reference internal" href="#code-structure">Code Structure</a></li>
<li><a class="reference internal" href="#example">Example</a></li>
<li><a class="reference internal" href="#installation">Installation</a><ul>
<li><a class="reference internal" href="#dependencies">Dependencies</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#fit-examples-utilities-tips-and-tricks">Fit examples, utilities, tips and tricks</a><ul>
<li><a class="reference internal" href="#example-1-model-comparison">Example 1 - model comparison</a></li>
<li><a class="reference internal" href="#example-2-two-fits-and-models">Example 2 - two fits and models</a></li>
<li><a class="reference internal" href="#example-3-non-linear-fit-with-non-parabolic-errors">Example 3 - non-linear fit with non-parabolic errors</a></li>
<li><a class="reference internal" href="#example-4-average-of-correlated-measurements">Example 4 - average of correlated measurements</a></li>
<li><a class="reference internal" href="#example-5-non-linear-multi-parameter-fit-damped-oscillation">Example 5 - non-linear multi-parameter fit (damped oscillation)</a></li>
<li><a class="reference internal" href="#example-6-linear-multi-parameter-fit">Example 6 - linear multi-parameter fit</a></li>
<li><a class="reference internal" href="#example-7-another-non-linear-multi-parameter-fit-double-slit-spectrum">Example 7 - another non-linear multi-parameter fit (double-slit spectrum)</a></li>
<li><a class="reference internal" href="#example-8-fit-of-a-breit-wigner-resonance-to-data-with-correlated-errors">Example 8 - fit of a Breit-Wigner Resonance to data with correlated errors</a></li>
<li><a class="reference internal" href="#example-9-fit-of-a-function-to-histogram-data">Example 9 - fit of a function to histogram data</a></li>
<li><a class="reference internal" href="#example-10-plotting-with-kafe-properties-of-a-gauss-curve">Example 10 - Plotting with <tt class="docutils literal"><span class="pre">kafe</span></tt>: properties of a Gauss curve</a></li>
</ul>
</li>
<li><a class="reference internal" href="#kafe-documentation-module-descriptions"><tt class="docutils literal"><span class="pre">kafe</span></tt> Documentation &#8211; module descriptions</a><ul>
<li><a class="reference internal" href="#module-kafe.__init__"><tt class="docutils literal"><span class="pre">__init__</span></tt> Module</a></li>
<li><a class="reference internal" href="#module-kafe._version_info"><tt class="docutils literal"><span class="pre">_version_info</span></tt> Module</a></li>
<li><a class="reference internal" href="#module-kafe.dataset"><tt class="docutils literal"><span class="pre">dataset</span></tt> Module</a></li>
<li><a class="reference internal" href="#module-kafe.file_tools"><tt class="docutils literal"><span class="pre">file_tools</span></tt> Module</a></li>
<li><a class="reference internal" href="#module-kafe.fit"><tt class="docutils literal"><span class="pre">fit</span></tt> Module</a></li>
<li><a class="reference internal" href="#module-kafe.function_library"><tt class="docutils literal"><span class="pre">function_library</span></tt> Module</a></li>
<li><a class="reference internal" href="#module-kafe.function_tools"><tt class="docutils literal"><span class="pre">function_tools</span></tt> Module</a></li>
<li><a class="reference internal" href="#module-kafe.minuit"><tt class="docutils literal"><span class="pre">minuit</span></tt> Module</a></li>
<li><a class="reference internal" href="#module-kafe.config"><tt class="docutils literal"><span class="pre">config</span></tt> Module</a></li>
<li><a class="reference internal" href="#module-kafe.plot"><tt class="docutils literal"><span class="pre">plot</span></tt> Module</a></li>
<li><a class="reference internal" href="#module-kafe.latex_tools"><tt class="docutils literal"><span class="pre">latex_tools</span></tt> Module</a></li>
<li><a class="reference internal" href="#module-kafe.numeric_tools"><tt class="docutils literal"><span class="pre">numeric_tools</span></tt> Module</a></li>
<li><a class="reference internal" href="#module-kafe.stream"><tt class="docutils literal"><span class="pre">stream</span></tt> Module</a></li>
</ul>
</li>
</ul>
</li>
</ul>


    
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
    <div id="impressum" style="text-align: justify;">
        <h3>Project Info and Contact</h3>
        <p style="font-size: 90%">
        This project originated at the <a href="http://www.ekp.kit.edu/english/index.php">Institute of Experimental Nuclear Physics</a> (IENP) at the <a href="http://www.kit.edu/english/index.php">Karlsruhe Insitute of Technology</a> (KIT). The software was developed as part of a Bachelor's Thesis in Physics.
        </p>
        <p style="font-size: 90%">
        The author may be contacted at:
        </p>
        <p style="font-size: 90%;">
            <div style="padding: 0 10% 7% 10%;"><b>Daniel Săvoiu</b></div>
            <div style="padding: 0 10%; text-align: right !important;">
                <i>daniel</i> (dot) <i>savoiu</i><br />(at)<br /><i>student</i> (dot) <i>kit</i> (dot) <i>edu</i>
            </div>
        </p>
    </div>

        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li><a href="#">kafe 0.5.3 documentation</a> &raquo;</li> 
      </ul>
    </div>
    
    <div class="footer">
        &copy; Copyright 2014, D. Savoiu, G. Quast.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.1.3.
    </div>
    <!-- <div class="footer">
        © Copyright 2013, Daniel Savoiu.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.1.3.
    </div>-->

  </body>
</html>